杰森·比弗: 下午好
欢迎来到Cocoa Touch讲座
我是杰森·比弗
是高级工程经理在iOS小组工作
iOS 9的最新内容有很多
不过 我首先希望来回顾一下在过去几年所做的改进
自从iOS 6起 我们开始为怎样构建iOS应用等
较大改进奠定基础我们开始在所推出的每个主要版本中
都体现了这样的改进
在iOS 6中 我们增加了自动布局
以便于轻松构建动态和多功能界面
以便对适用尺寸和屏幕方向
以及本地化等方面的改进
做出反应
在 iOS 7中 我们推出了动态类型
这可以帮助在用户可选的
文字大小应用中实现漂亮的印刷样式
与自动布局一道
界面可以与用户所选文本大小的改变自动适应
通过采用动态类型系统
可以在文本渲染应用中免费
为文本的可读性实现改进
在iOS 8 我们做出的改进可能算得上是最大
我们引入了适应性概念
这是指应用应该
在运行环境下适应改变
这一概念的基础就是尺寸类别
尺寸类别会根据
空间是否会受到具体的尺寸束缚导致
应用的用户界面发生结构改变
在这里所显示的设置应用中在iPad和iPhone
运行的代码完全相同
尺寸类别的不同导致用户界面的结构变化
尺寸类别iKit视图控制器许多部件的适应性
视图控制器的呈现搜索结果
上拉菜单等等所有这些都
与尺寸分类和必须配合使用的可用空间相适应
我们去年引入
适应性概念的时候我们为何会往这方面发展还不是很清晰
在应用中我们通常是全屏
在应用运行的时候一般不需要改变用户界面结构
随着多任务处理的引入
做出上述改进的原因就很清晰了
你无需针对具体硬件
构建两种不同的体验
针对用户运行的app你可以提供
根据尺寸打造的体验连续性
应用这些基础性基础不仅app
可以用于我们所推出的所用硬件
也可以支持这些多任务处理的新功能
以及我们已有合作的已采纳所有这些改变的开发人员
在某种情况下真是只需要几分钟时间就可以让他们的app
与我们的app无缝对接
需要特殊处理的是Picturein Picture功能
如果应用支持背景媒体播放可以在iOS 9中
使用新的API启动播放器
支持 Picture inPicture 功能
要记住 Picture inPicture 功能
和所有多任务处理一样应用
需要作为“良民”确保
不会干扰整体用户体验
本周 还有几场多任务处理的讲座
《iPad多任务处理入门》
《基于媒体的App多任务处理要点》
以及《为多任务处理优化App》
我们来继续介绍iOS 9的最新内容
首先是自动布局
我们先来讲讲最新的UI布局指南分类
以免你在自动布局束缚中用到了
额外的视图 现在可以使用布局指南
以避免视图层次搞乱
我们介绍的是默认的两个布局指南
布局边界指南和可读内容指南
可以在UIView使用这些属性
在定义视图内容方面
允许更多的表达性
这些会替代我们在iOS 8中所介绍的布局边界
在编写新代码时 都应使用布局指南在重新访问旧编码时
也应该将边界替换为布局指南
我准备花些时间介绍一下第二种情况
可读内容指南
当文本主体很大时
文本行长度与文本的可读性
和易读性都有很大关系
如果文本行太宽就像这样
就很难看到文本行起始位置阅读时
也就很难接上下一行
相反 如果文本行太窄
目光太过频繁地来回转移则会打断阅读节奏
文本行的理想长度取决于许多因素
包括字体 大小 行距
不过通过使用可读内容指南
可以确保无论用户文本大小
或应用渲染文本的可用空间
如何文本的可读性都不会有问题
我们来谈谈怎样使用布局指南
减少应用中的视图数量
比如说有个视图是要展示若干星球
我们希望以父视图为中心来展示
或是沿着x轴排开
在使用自动布局束缚之前
我们要先在视图层次中引入一系列
额外视图来实现这一点
现在先来定义布局指南
这定义的是视图安排的空间
比例我们也生成了另一组束缚
是以这些视图为中心
然后只需改变活动状态的束缚就可以实现漂亮的动画是这个样子
本例中 我们同时改变了所有的束缚
但是如果我们是在不同的时间
使用框架动画改变束缚
就会实现诸多非常有趣的效果
在iOS 9我们还将StackView引入iOS
以便于将子视图作为堆栈管理
可以实现垂直或水平排布
StackView在覆盖下使用自动布局
不过可以管理所有的束缚
可以调整间隔对齐
可以在可用空间允许均等
或按比例调整视图分配方法
StackViews还可以嵌套
可以将StackView作为另一个StackView的元素
以便生成非常丰富的布局
这些布局将自动调整
内容显示方式并根据可用空间
进行调整像这样
我们还引入了快捷栏
连上硬件键盘后在屏幕底边
或软件键盘上有显示
快捷栏包括字体控制 如黑体 斜体
下划线 剪切 复制和粘贴
还可以根据应用自定义
符合UI文本输入协议的任何内容
可以返回至使用该方法的辅助输入项
UI文本辅助输入项是iOS 9中的新分类
有着两个属性用于确定
引导和追踪栏-按钮组
这样就可以轻松在这里加入自己的元素
现在正如在State of the Union专题会所见
我们不再必须在单一的故事板上
为应用准备整个界面
可以将故事板彼此相连
我们还提供了解开引线的方法
我们现在可以在操作系统实现完全的从右至左支持
如果曾做过从右至左的语言本地化
并在iOS 9上连接了app
这一切也都将在app上自动实现
所有的UI Kit控件都将自动反转
注意导航也发生了反转
所有的动画也都反转
列表视图单元格布局甚至滑块和开关
也都发生反转
集合视图也会自动反转布局
流向改为从右至左
这里我们看到起始标记的滑动要求向右滑动
未读标记要求是向左滑动
视图控制器和视图上有两个属性
名为语义内容属性
可以确定内容如何排布
默认状态下 所有内容都会自动反转
不过可以按照应用中
所需通过自定义覆盖这些属性
还有一种方法
可以为具体的内容属性获取布局方向
语义内容属性有着5个值之一
第一个未明确这是默认状态
除非有理由改变UI Kit做的事情
这个值不用管它
如果有一组控件代表播放
快进和倒退等播放控件
可以使用播放获取布局方向
如果有一组控件代表或导致
UI中出现部分方向改变
例如 文本对齐控件文本编辑器中的左中右
可以使用获取布局方向
最后 还有两个额外的值
可以执行从左至右
或从右至左的布局
对于图像而言 UI Kit不清楚
图像是否应该在任何情况下都默认反转
比如照片这类用户内容
就不应反转而在应用中的控件部分
则应该进行反转
因此在UI图像的从左到右有属性或方法
可以让你告诉我们是否想反转图像
另外还有一个属性可以询问图像是否已经反转
鼓励大家都到国际界面的
最新UI Kit支持看看了解一下
怎么让app支持从右至左的语言
关于用户友好性现在可以使用
更多的语音 比如亚历克斯那样以及AV
语音合成中的高质量语音
我鼓励大家在关于 iOSAccessibility 方面
了解更多怎样让app实现用户友好性的内容
大家可以看到过我们在iOS 9中
引入一系列最新文本编辑手势
这些手势可以在屏幕底部的键盘上操作
或也可以在文本区操作
它们可以实现间接移动插入点
可以轻松实现选择词语句子或段落
只需多次点击即可
还可以轻松扩展现有的选择
连同我们介绍的快捷栏
你可以轻松访问 复制和粘贴而无需移动到文本
文本互动操控可以相当轻松便捷
现在在应用中什么都不用做
来运用这些文本编辑手势
不过如果在自己应用中的文本视图中
自定义了这些手势
应该确认不要与
最新的系统文本手势发生冲突
在iOS 7中 我们增加了
发现键盘硬件键盘命令的应用支持
App可以有自己的命令
比如生成新文档的命令
这对已经了解这些命令的用户
很是方便但是无法发现
这些命令是什么
在 iOS 9中 我们引入了最新键盘命令探索功能
HUD 如果持续按下硬件键盘上的命令键并且保持片刻
HUD将会显现告知此刻
可用的命令组是什么
注意 这取决于上下文
根据当时应用的状态不同
你会获得不同的命令组
因此 并不是看到整个命令组部分启动 部分关闭
而是只能看到目前可以应用的部分
在应用中运用 只需要为为每个主要命令
设置可探索功能标题
UI Kit可以自动找出
哪些命令在当时可以使用
我们可以聊一聊触屏事件
在屏幕上跟踪在手指和屏幕上
产生的笔触之间会有一些固有延迟
需要花些时间扫描硬件
完成所有中间处理和绘图
再将结果完全显示出来
这就是所谓触屏显示延迟
大部分用户在大多数情况
不会注意到这个延迟
当用户移动手指足够快时延迟才会明显
尽管iOS已经具备业界领先的触屏显示延迟
在iOS 9中我们将延迟水平又做了大幅改进
在屏幕上跟踪跟踪触控时
UI Kit会随着每次屏幕刷新
通知应用这样应用就可以更新状态
在部分更新款的硬件中
触屏更新的频率要超过显示器
因此在上一次显示器刷新后现在有新方法
可以访问任何中间触屏
对于绘图应用而言这可以更流畅更准确地绘图
作为改善触屏显示延迟的第一步
我们现在还可以实现触控预测
这会用到高级算法考虑触控速度
加速度以及曲率
来预测触控的走向
这就可以明显减少绘图时的延迟因为可以预测出触控
将发生的位置而不是后知后觉
我们其实还不止于此
除了提供触控预测
我们在整个软件堆栈都做了调整
以便进一步降低延迟我说过60毫秒以上
已经是业界领先水平
我们降到了不足30毫秒
我们还引入了UI Kit动态的一系列改变
首先是我们支持非矩形碰撞边界
除了矩形我们现在还支持椭圆形
和基于路径的碰撞
这样就会更为接近真实的碰撞相互作用
我们还支持大量的现场行为
我们现在有线性和放射性引力就像这样
弹力 阻力和速度或是噪音和湍流场
就像这样 以及电场和磁场等
我们还支持 定义自己的场效的能力
最后 我们添加
一些新增额外附件类型
在简单附上两个对象之前
如果想以某种方式束缚它们的运动
必须要设置若干外部束缚
有了这些新增附件类型
可以极大简化构建UI动态模型的过程
我们也添加了模糊半径动画的能力
为实现漂亮的效果就像这样
聚光灯效果的进出
我们还iOS 9中引入了一系列EPI改进
以优化在Swift中的应用
这是利用Swift的更好表达能力
并改善编译时间类型检查功能
在可空性方面 可以明确属性行为
以及返回值能否为零值
我们已经介绍了整个API定义了
零论证或返回零值
是否担保不为零值
我们还有轻量级泛型
这是轻量级形式的类型参数化
可以实现Cocoa和CocoaTouch API的更好表达
例如 UI视图的子视图方式
可以返回UI视图数组而不仅仅是ID数组
在《Swift最新内容》讲座中有更多相关内容
iOS 9新增了通知能力可以实现针对用户的文本输入
或是来自客户的文本输入速度可以等同于回复文本消息
UI用户通知动作分类具备新的行为属性
如果设置文本输入行为
通知会有文本字段允许快速回复
还有一个额外的动作参数字典
可允许自定义Send按钮的名称
我们还要介绍最新的SF Safari视图控制器
这可以实现用原生语言app显示网络内容
并用所有主要Safari UI元素所包围
用户对此已经非常熟悉
甚至还可以支持高级功能
比如Reader和自动填表
在《Safari视图控制器介绍》讲座中 会有更多内容
在iOS 9中 我们引入了一系列最新扩展点
可实现在系统中扩展其他应用
对于VPN 我们有三个新扩展点
有包隧道提供者可以帮助你
构建自己的VPN隧道协议客户端
还有app-代理提供者可以帮助你执行
自己的自定义透明网络代理协议客户端
还有过滤器控制提供方和过滤器数据提供方
可允许实现动态装置上内容过滤
对于Safari有两个新扩展点
Shared Links可以让应用明确可以在共享链接
用户种子上显现的内容
内容拦截扩展可允许定义
内容或页面资源的子集
并防止其显现
对于Spotlight还有一个扩展可以允许系统
对应用数据进行索引而且还可以在背景完成
这样就无需启动应用来重新对
app内容进行索引
在《App搜索介绍》讲座中有更多相关内容
最后 音频单元或核心音频插件可以作为乐器 音效
或音频发生器来使用
直至现在 iOS用户还在仅限于
Apple提供的内置音频单元
在iOS 9中 我们增加了新扩展点
可以将自己的音频单元连入iOS
大家在《音频单元扩展》讲座中可以了解更多内容
很多人都问到我我也很高兴地宣布
我们已经发布全新Swift和Objective-C API
用于联系人互动
谢谢
大家在《iOS 10的iOS联系人框架介绍》中
可以了解更多内容
对于Wallet和Passkit在银行和商家应用中
现在可以从零开始提供卡片
如果有特殊授权
还可以静默Apple Pay如果出现了
会影响应用的情况
因此 比如在应用在某种条件下
需要显示条码而且还连有NFC终端
通常会使得Apple Pay显现
可以静默这个功能这样才能扫描条码
在核心位置app连接到iOS 9
或是晚些时候
背景位置跟踪会有些改变
在CL Location Manager上还有新的API
要求一次位置更新
如果不需要持续更新位置
这是更为有效方式
来获得用户的当前位置
对于MapKit 有若干新功能具备地图视图
第一是访问3d Flyover View
现在可以显示流量以及量表和刻度尺
已生成自己的自定义调出
在HealthKit中 可以直接实时访问 Watch OS 2
传感器数据还有若干新数据类型
跟踪用户水分的摄入量
跟踪其在阳光下暴露的时间
以及生殖健康
新款API可实现更好的HealthKit
数据设备跟踪更好地支持删除数据
以及跟踪锻炼的新款练习会话API
几个月前 我们公布了ResearchKit
可以用于开发人员和研究人员
创建医药研究app
ResearchKit现在包括iPad支持...
PureToneAudiometry
的新活动任务可用于确定
听力阈值水平
以及简单反应时任务
以便衡量用户对事件的反应时间
还有一种图像捕捉步骤可供使用
正如大家昨天所见我们对HomeKit做了部分调整
我们现在可以支持详细变更通知
灯亮起时
就可以获得具体的委托信息
明确特点和改动的配件
因此现在可以让具体的灯亮起
而不是泛泛地房间里有改动通知
HomeKit有4个预定义动作组 
早上醒来出门到家
上床睡觉你可以完成这些标准动作
关灯 锁门这类事情
确保车库门关好
所有这类问题都无需用户另行配置
在iOS 8可以生成定时触发器
实现执行计划场景
在iOS 9可以生成更为复杂的触发器
例如 要知道 当门锁打开时
动作传感器检测到动作
这是在日出后30分钟发生的事情
当然 Watch上还有HomeKit 可以用手表
直接控制家中的设备
有Wi-fi功能的附件可以远程连接
即便没有Apple TV也没关系
还可以与它们通过iCloud
直接沟通
有蓝牙功能的配件
可以自动连上Wi-Fi
即便超出了配件的蓝牙有效范围
也依然可以控制
最后我们在家中的若干新项中
加入标准定义
对于CloudKit而言我们更新了
公共数据库的限制和定价
但是更令人兴奋的是我们可以实现...
CloudKit WebServices
来整合网络应用
本周还有两个讲座是关于CloudKit 
《CloudKit最新内容》和《CloudKit诀窍和技巧》
至此为止 UI文档
和动作控制器会将发送给其他app的
每个文档都进行备份
现在 只要打开到位只要是在iCloud中储存 
app可以要求直接打开文档
可以在info.plist中
添加秘钥
声明适合执行新的代理方式
来直接打开文件即可
我们将在《构建基于文档的app》讲座中详细讨论这个问题
现在 许多应用包括的资源在用户首次
开启应用时并不需要
将app可能会用到的每个资源都包括在内  会令app
捆绑包太过庞大影响安装速度
甚至会导致超出OTA限制
这会影响销售
为解决这个问题我们来介绍按需资源
应用会上传单一的文件包恰巧是满足当天
所需 但是当应用有需求时
内容可以动态下载
这些资产都是运用基于输入信息
以及用户行为的启发式逻辑处于智能化缓存状态
在Xcode中 资产都是使用简单标签分组
我们先来讲讲...
NS BundleResourceRequest 的新分类
这可以实现用给定的标签要求所有资源
一旦这些资源得以下载你可以使用熟悉的API去访问
　比如UI图像命名图像等
还有办法在Xcode中进行检测
模拟并未获得资源而对服务器提出要求
Xcode可以像服务器一般工作
向应用发送相应资源
现在 我们介绍另一种新技术
来解决应用大小的问题就是app分割
现在 应用常带有与用户安装的硬件
不相关的资产和可执行内容
这一分割技术可以提供用户设备
所需的资源和可执行内容部分
使用应用分割技术处理App Store
可以自动生成并为运行
iOS 9的设备提供应用的定制变量
这其中只包括设备相关的资源和可执行内容部分
在服务器运用这种技术
不相关的内容甚至都不会下载
这会节省安装时间
并有希望将app处于OTA限制以下
我们还要介绍最新的NS数据资产分类
和设备上的这可以轻松获取根据内存
图像处理能力定制的内容
现在来看Game Center 我们加入了嘉宾玩家功能  
在Game Center的多玩家模式中 实现了新的配置
我们还统一了Game Center服务器环境
以便于开发和测试的流线化
最后 我们来介绍ReplayKit
这可以提供分享游戏体验的新方法
可以实现app轻松录制视频和音频
并与其他用户分享
在iOS 9中 SpriteKit支持Metal
适用于相应的系统支持
对于不支持Metal的系统它是开放式GL
这些都是自动完成无需人工干预
还有一个全新的动作编辑器
当然它与按需资源紧密整合
在《SpriteKit最新内容》讲座中有更多详情
对于SceneKit在Xcode中有全新的场景编辑器
可以支持粒子 物理 
动作等等 
SceneKit还有相当多的新功能
场景转换 音频节点 模型i/o 
环境光遮蔽 光照图以及许多其它功能
SpriteKit和SceneKit是构建游戏
图形界面的强大框架
对于游戏它的强大之处不仅在于图像能力
游戏有实体和组件部分
还有代理在游戏中都有着目标和行为
需要发现路径算法允许代理在游戏附近导航
还需要AI允许代理决定之后
要采取怎样的行动
参与游戏所需的所有
这些元素现在都可在GameplayKit中找到
在《GameplayKit介绍》讲座中还可以了解更多详情
最后当然 我们要谈谈WatchOS 2
除了直接访问现有的框架
还有新框架如Watch连结性
将app与电话和WatchKit连结 来搭建Watch表盘组件
在《WatchOS 2 WatchKit介绍》中
可以了解更多详情
本周所有讲座的综述在《探讨WatchOS 2》
中有介绍
若要了解更多信息当然有文件资料
有在线论坛开发人员技术支持
谢谢希望大家这周过得愉快