定製
大家好歡迎參加709會議
我是維普爾·普拉卡什
還有我的同事戴夫·薩利姆和詹森·道格拉斯
我們將和大家一起深入看看iOS 9的新搜索API
正如你在Keynote中所見
應用的內容中的深鏈接 
現在可以整合到Spotlight 搜索結果之中
這着實讓人興奮
因爲iOS用戶大多數時間都在app內 
這裏也是內容的展示場所 
而且也是人們現在數字生活的居住地
我們非常想通過搜索將所有這些內容整合到一起
在你的app內創建廣告式尺寸統一的索引頁面
從而在Spotlight顯示出來這不是我們要的做的事
這種指向網絡的索引方法行得通 因爲尺寸統一
但是對於app搜索而言 這種方法卻不對
我們要做的是提供一種體驗 開發者可以精確選擇搜索的內容 
結果呈現方式以及用戶點擊結果後會跳轉的位置
我認爲通過搜索API已經做到這點了
方法簡單且輕便
搜索API的目標是
讓你的app內的內容在搜索時候更爲深入人心
而且搜索結果會同時出現在Spotlight和Safari中
在iOS8系統上我們也通過類似的方法
提供Spotlight搜索建議
當用戶在Safari地址欄輸入一條請求後 
你會從網絡上看到結果
比如Maps Wikipedia和App Store
用戶可以點擊搜索結果 然後直接跳轉到搜索內容
在iOS 9中用戶可以直接跳轉到你的app內容
這也是我們提供的提高曝光率和分銷的另一種方法
App內部的公共深鏈接現在可以在搜索結果中顯示 
這樣用戶就沒有必要安裝你的應用了
這真是超級棒啊
這樣你的app就能通過一種全新的曝光方式
讓潛在的數百萬iOS用戶看到
讓我們看看這是如何工作的請看一下例子
我們邀請了Airbnb人員看這些API 
而且他們能夠在幾個小時內進行整合
他們所做的是他們找到用戶的保留信息
以及在平臺產生的通訊
然後在搜索API之中加以索引
現在當我在Napa查找我的保留信息的時候 
我在Spotlight上輸入 然後保留信息就是第一個搜索結果
這裏還有日期
非常酷
這裏有日期 客人數量 描述而且當我點擊後
我可以跳轉到app內容進行更豐富的體驗
在這裏你可以看到另一個結果是第二條結果 
這是保留信息是伺服器發出的信息
如你所見我可以閱讀這條信息 這非常有用 
而且右邊還有一個調用字符 
當他們索引的時候
數據會被編入到伺服器電話號碼 
然後Spotlight會檢索到 進行調用
正如預期的一樣
它會進行調用
這樣通過完美功能整合 從而實現搜索API
讓我看看另一個例子
這裏是LinkedIn一款專業的社交App
在這個例子中 
我的第一級網絡 
我在LinkedIn上的所有通訊都被添加到搜索索引中
同樣的可按照內嵌式聯繫方式和內嵌式信息獲取到這些信息 
現在搜索API不僅僅侷限於內容搜索了
一種非常有用的情況是
在App內容的搜索位置設置導航點和導航功能
看一個例子看看Health是如何做到的
它對所有的對話中的深鏈接進行索引
如果我想要看看我已經走了幾步
我在Spotlight中輸入步數
獲得深鏈接 點擊 然後直接跳轉到步數畫面
我認爲這很酷
用戶最常使用Spotlight的是進行app查找和安裝
在iOS 9系統中我們相信在app內部
進行直接的深導航以後 將會非常受歡迎
在所有的情況下直接從你的設備索引中搜索結果
這些深鏈接會放在設備索引中而且不會跨設備索引
那麼如果用戶還沒安裝你的app呢？ 
我們在Apple雲服務器上保留了大量的深鏈接索引
我們可以從這些索引之中進行無縫查找
我們想出了一個共享這些索引的絕佳方法
開發者可以標註公共內容爲公共 
而且一旦有足夠的用戶檢索到 
那麼深鏈接會提交到雲索引
這樣你的app所有用戶都可以檢索到
而且如果深鏈接有相關的網頁鏈接那麼iOS所有用戶都可以訪問
現在
對app進行檢索和爬取
在某種意義上已經毫無意義但是對網頁而言則不是
如果你的應用將內容複製到網站上 
我們可以打開網絡對網站進行索引 找到深鏈接
然後放到雲索引中 這樣就能無縫進行搜索
無縫設備搜索和雲搜索的邏輯
對於app搜索而言非常重要
在app中有很多內容是私密的 
而且有些是公共的內容內容只能之二者中的一者
使用這種方法是創建一個無縫搜索接口
這樣用戶可以知道搜索結果是來自設備索引還是雲索引
請看看這個例子
我搜索一個音樂節“northern lights”
我從EventBrite應用雲索引中找到一個結果 
我沒有必要安裝該app因爲這個結果有一個網頁鏈接
我點擊鏈接
這樣我可以在Safari中打開鏈接
你注意到了作爲EventBride用戶 
這個巧妙的app標語會鼓勵我下載app 
然後進行更豐富地內容體驗 
這正是我現在做的
想象一下如果這是你的app 
以這種交際性的方式將你的內容呈現給iOS用戶
而用戶找的正是你的應用提供的內容那不是很棒嗎？ 
這裏我有一個例子我搜索裸關節扭傷
我不想要在我的設備上安裝醫療類的app
我通過app搜索找到多個基於app的結果 
而且是用戶之前已經查找過的感興趣的
我可以點擊
安裝app
然後再app內繼續查找
那麼工作原理是什麼呢？ 
App搜索有三個API
各自獨立卻又相關
這些API可適用於不同用戶情況下的進行App搜索
首先是NSUserActivity
這是發佈到iOS 8系統上Handoff APi的擴展
當我們查看信息存取模式 
然後搜索時呈現給用戶的是之前他們看到的
而且現在需要的NSUserActivity
讓搜索這種信息和檢索更爲簡單
這相當於是瀏覽器保留了你的瀏覽記錄 
然後用戶活動保留了app歷史格式 從而使之變爲可被檢索到
第二個API是CoreSpotlight
這是一款非常好用的工具
用於對app的內容進行綜合檢索
所有iOS 9的內置式app包括Mail Notes Calendar 
都是使用CoreSpotlight
這讓你可以對設備索引進行底層訪問 
相當於一款數據庫API你可以添加和移除項目
而且這也是用戶在你的APP內部
進行私密內容檢索的最好方法
第三個API是web markup
這指的是APP複製內容到一個網站上
你可以使用深鏈接註釋信息標記網站內容
我們會到網頁上抓取內容 
然後放到雲索引
這樣就能夠通過iOS 9搜索無縫呈現給用戶
這裏是大會剩下的安排表
我們會深入看看每一個API
說明其工作原理
然後我們會看看在App內採用這些API的最好的方法
我們接下來會談談NSUserActivity和CoreSpotlight 
我想邀請戴夫·薩利姆
大家好我是戴夫·薩利姆
是App搜索的一名開發者
我們剛纔瞭解了一些
關於如何讓你的app變得可被搜索和曝光的新特性
現在我們會談談這些API 以及如何善用這些功能
首先我們先看看NSUserActivity
先來點背景資料
在iOS 8系統引入NSUserActivity 是爲了支持Handoff功能 
Handoff功能是非常棒的功能
可以讓你遠程啓動以及查看另一臺設備上的應用
NSUserActivity使用輕量化設計
用於捕捉之後可以被恢復的應用狀態
現在在iOS 9中
我們添加了NSUserActivity新功能 
這樣能夠從iOS搜索和Safari中進行索引和搜索
你需要具備關聯元數據和活動的能力
這樣才能描述活動
而且這些信息可以用於檢索和提供豐富的搜索結果
當用戶查看你的搜索結果的時候 
你的app會啓動然後將搜索結果傳遞給活動
你可以繼續恢復app狀態 讓用戶回到內容頁面
讓我們看看一個例子 
看看NSUserActivity是如何被添加到索引中的
這裏我們有一個食譜app當用戶在app內瀏覽食譜的時候
我們創建一個NSUserActivity
用於捕捉器狀態
和提供所需的信息 然後返回到食譜中
然後我們使用來自食譜的資料 
比如標題 描述甚至是縮略圖描述該活動
然後我們通知系統該活動表示的是用戶的當前狀態 
然後該活動會被添加到設備內置索引中
這樣當一名用戶使用app的時候
我們使用相同的方式創建活動 描述活動 
然後通知系統這些活動表示用戶當前狀態 
這些活動會被添加到設備內置索引
讓我們看看用於支持App搜索的NSUserActivity的新舊屬性
首先現在我們有使用指派活動權限的屬性
其中之一是關於Handoff的屬性默認情況下Handoff是激活的 
如果你選擇不啓動Handoff 你可以在這裏設置爲False
還有一個用於搜索的屬性 可以允許活動進行設備內置索引
還有一個用於公共索引屬性 稍後我們會談談
接下來要如何描述你的活動呢？ 
首先是要給活動設定一個標題
這個標題可用於索引和顯示搜索結果
你還可以提供活動描述關鍵字 這些關鍵字也可以被索引
爲了更全面地描述你的活動
你可以使用在CoreSpotlight中引入的新類別
稱之爲CSSearchableItem.attributeSet  
使用這個類別可以讓你使用設置屬性快速進行活動描述
你可以在NSUserActivity中的contentAttributes屬性中進行設置
如果你想要設置在特定日期之前不顯示你的活動
你可以設置一個到期日
另外如果你的活動內容可以保存到網上或者你支持Safari的通用鏈接 
設置網頁URL屬性 
然後系統會在Safari或者app內啓動你的活動
現在讓我看看如何創建活動
這裏我們可以舉一個關於NSUserActivity的例子 
而且我們在這裏會設置一個活動類型
這是你設置的唯一字符串 同樣也是你告訴系統的字符串 
讓系統明白你的app可以處理什麼活動
我們推薦你對這些字符串類型
設置反向DNS類註釋這樣確保其唯一性
接下來我們的活動需要一個標題
再一次標題可用於索引 而且可作爲搜索結果的顯示標題
接下來我們要在useriInfo屬性上設置一個詞典
其中應包括重新創建狀態所需的信息
接下來我們要設置eligibleForSearch爲True 
啓動活動設備內置索引 
該活動代表用戶的當前狀態 
然後我們通過活動becomeCurrent屬性通知系統 
然後該活動會被添加到設備內置索引中
在用戶看來這過程看起來是怎麼樣的呢？ 
現在用戶可以返回到你的app索引得到的搜索結果
在這裏我們可以明白標題屬性是如何映射到搜索結果的標題的
而且如果你使用contentAttributes輸入更多的信息
我們就可以得到更豐富的結果
所以當用戶點擊其中一個搜索結果時會發生什麼呢？ 
會調用應用內的一個UI應用指派方法 
和Handoff調用的是同一個
這裏我們看到的是continueUserActivity restorationHandler
然後我們傳遞搜索結果活動 
我們可以查看其活動類型然後可以使用用戶信息繼續恢復狀態
所以現在用戶可以點擊活動的結果 
然後你可以將結果恢復到適當的狀態
App搜索內的NSUserActivity
是讓用戶返回到之前瀏覽內容的好工具 
我們想要更進一步
所以在我們設計這項功能的時候
我們查看了App Store內很多app
我們注意到很多app內容其他用戶也會看到
所以我們在想
如果我們可以讓活動代表公共內容
然後讓這些內容可讓所有用戶搜索到 
而不僅僅是那些之前瀏覽過的用戶這樣的話不是更棒嗎？ 
這正是我們通過NSUserActivity和公共索引做到的
那麼工作原理是什麼呢？ 
當用戶在你的app內導航到公共內容的時候
你會創建NSUserActivities用於捕捉狀態
然後你可以指派內容爲公共內容
當用戶查看這些活動的搜索結果的時候
該活動會和我們的雲索引進行共享
然後讓app的所有用戶都可以進行搜索
而不僅僅是那些之前瀏覽過的用戶才能搜索
如果你的活動保存到網站上 
那麼你可以設置webpageURL屬性
這樣可以極大增加被iOS的Safari搜索到的機會
所以讓我們看看要如何指派一項活動爲公共活動
我們可以啓動之前看到的那個活動 
然後我們可以額外設置一項屬性
這裏我們設置eligibleForPublicIndexing爲True
然後我們指派該活動爲公共
雖然我們已經設置該屬性爲True 
但這不是說該活動的內容會被立即分享到我們的雲索索引中
對於被共享的一項活動
首先需要在搜索結果中出現而且要和用戶產生互動
我們可以使用零知識證明方法跟蹤這些互動 
這個方法可以確保活動內容的私密性 
直到滿足互動閥值
所以更詳細地說
當用戶和被指派爲公共的活動搜索結果進行互動的時候
會發送活動的一個單項Hash到我們的雲索引中
當雲索引多次調用同一hash之後
活動的內容纔會和我們的雲索引進行共享
我們在設計該方式的時候還考慮到其他的方面
首先是用戶隱私 
第二是防止其他用戶的數據意外和雲索引產生共享
另外對於這裏的大部分人而言NSUserActivity eligibleForSearch
和eligibleForPublicIndexing屬性是默認爲false的 
對這裏每個人來說
只有對活動中代表內容 和特性的屬性指派爲公共後
才能讓app的其他用戶看到
現在讓我們來看看採用NSUserActivity獲得的額外好處
首先是Handoff功能
採用API你可以爲Handoff添加支持
如果你選擇 你可以允許用戶在一臺設備上開啓一項活動
而在另外一臺設備裏繼續活動
另外兩點是關於Siri的新特性
正如主題中展示的向左滑主頁代表用戶的Siri建議
除了建議聯繫人和建議應用以及和附近地點
應用中的活動也可以被建議
這裏我們看到一條對即將到來的日曆事件的建議
和一條對恢復播客的建議
下一個是Siri智能提醒
現在用戶可以讓Siri提醒他們應用裏的具體內容
以及記錄在提醒事項裏各種活動的時間
這是一種很容易讓用戶回到他們想要被提醒的內容的方式
應用搜索的內NSUserActivity
讓用戶可以更加容易地返回到他們之前所訪問的內容
並且讓應用裏的公共內容更容易被找到
接下來讓我們談談下一個可搜索應用內容的API
那就是CoreSpotlight
CoreSpotlight是iOS 9裏的一個全新框架
它提供一個數據庫式的API
你可以添加 更新 刪除項目
你使用CoreSpotlight在iOS中進行索引的項目
而且可用於內置應用包括Messages Mail Calendar Notes
你明白用CoreSpotlight可以索引的內容
讓我們來看看這個API
首先我們從CSSearchableItem開始
這表示的是我們想要索引的個別項目
接下來我們關聯一個CSSearchableItemAttributeSet
這是一種通過設置屬性描述項目的簡單方法
然後我們將CSSearchItem傳遞給CSSearchableIndex
這樣項目就被添加到設備內置的索引上
我們來看看如何創建一個項目
首先我們從創建CSSearchableItemAttributeSet開始
這裏我們有一個關於圖像的
接下來我們在屬性設置裏設置一些屬性
用於我們要索引的項目
這裏我們設置一個標題和一個描述
這裏我們將看到標題和描述是如何映射到搜索結果的
接下來我們創建CSSearchableItem
並且我們提供一個獨唯一的標識符
應用可以將該標識符用於參考我們想要索引的實際數據
我們可以提供一個域標識符
這是一種將項目分組到一起的方法
在這個例子中我們要爲索引一張照片
我們想要將相同標識符的所有照片分到一起並用一個相冊表示
並且我們提供一個屬性設置用於描述剛剛創建的項目
接下來我們在CSSearchableIndex進行項目索引
稱爲indexSearchableItems
傳遞給索引的項目
這對用戶來說看起來像什麼呢？
用戶們現在進入iOS搜索
然後在應用裏返回搜索結果
這些搜索結果已使用CoreSpotlight索引
這就是屬性設置上的屬性映射到搜索結果的方式
當用戶點擊搜索結果的時候將發生什麼呢
應用裏的一個UI應用指派方法將被調用
與Handoff調用的方法一致
這裏我們再次看到ContinuousUserActivity RestorationHandler
這次你知道CoreSpotlight項目啓動了你的應用
因爲活動類型被設置爲CSSearchableItemAction
並且當我們初始化可搜索項目時
所用的唯一標識符在用戶信息裏的
CSSearchableItemActivityIdentifier可以使用
因此用戶可以點擊搜索結果
你可以將正確的上下文返回給用戶
現在我們來談談索引維護
索引支持更新項目
隨着時間的推移
項目標題 描述可能改變用戶可能更新代表項目的某些領域
你可以通過調用用於索引項目的方法進行更新
使用唯一的標識符創建一個
你想要更新的CSSearchableItem關聯到一個更新的
CSSearchableItemAttributeSet
並且爲項目索引調用CSSearchableItems
另外一種常用的維護例行程序是刪除項目
刪除任何不再與上下文相關的項目是一個好做法
我們支持多種刪除項目的方式
首先你可以通過標識符來刪除
你可以傳遞標識符數列
從而刪除帶有標識符的可搜索項目
這些項目將從你的上下文中被刪除
你可以通過域標識符來刪除
你可以看見早前我們創建項目的時候
可以用域標識符將項目分組到一起
當調用deleteSearchableItems的時候
你可以傳遞標識符將分組的項目刪除
最後
你可以通過調用
deleteAllSearchableItems WithCompletion處理器將所有的項目從上下文中刪除
現在我們來看一個演示如何輕鬆地將CoreSpotlight添加到應用
我們的演示應用是一個圖片查看器
我將向你們展示如何輕鬆地通過標題索引項目
並且我們將看看搜索和修復的用戶體驗
這裏我們有Xcode和IPhone模擬器
首先我們啓動應用
以便對它是什麼樣子有一個概念
這裏我們有一些照片
每張照片下方都有一個標題
這裏有一些漂亮的日落
好的 讓我們看看如何輕鬆地
用照片的標題爲這些照片編索引
進入Spotlight
我們有一個方法爲項目編索引
並且當數據模型初始化的時候
我們將在數據存儲中列舉所有的照片
並且使用CoreSpotlight添加每張照片
我們將創建屬性設置
然後開始描述照片
這裏我們爲照片創建一個CSSearchableItemAttributeSet
然後我們把數據模型裏的標題設置到屬性設置裏的標題屬性
同樣也包括基於標題的描述
下一步我們將創建項目本身
這裏我們傳遞一個唯一的標識符
它代表我們可以用於參考數據存儲中的圖片
然後我們調用indexSearchableItems
將項目傳遞到CSSearchableIndex
現在讓我們建立並運行這個應用
現在我們回到應用
當我們初始化應用的時候它調用索引項目
並且列舉照片集裏所有照片並將每張照片添加到設備內置索引
現在我們可以進入到iOS搜索
並且我記得我在那裏看到一些漂亮的日落
我們可以從應用的結果裏
看到這些以日落爲標題的日落照片
點擊其中的一個結果
它允許我們將應用存儲到適合該項目的上下文中
這就是如何輕鬆地使用CoreSpotlight來爲項目編索引
CoreSpotlight裏的一些額外功能支持批處理
你可以選擇爲大量的項目編索引
並且在批處理中分別索引
索引支持保存批處理進程狀態並進行檢索
這樣你就可以繼續上次的操作
它同樣支持指派和拓展
這樣索引就可以與前景 背景通訊或者在尚未運行的狀態下進行通訊
它支持數據保護類
這樣你就可以爲你的索引信息選擇合適的安全策略
CoreSpotlight可以很輕鬆地採用數據庫式的API
這樣你可以用於從你的應用中索引任何功能或上下文
現在我將現場交給詹森·道格拉斯
讓他來談談第三種APIweb markup
大家好
我叫詹森·道格拉斯
我來自Siri團隊
我們將談談web markup
已經有兩種不可思議超棒的的方法使你的應用內容
在NSUserActivity和CoreSpotlight可搜索到
而第三套APIs就是web markup
用於應用內容的檢索對於網站而言同樣適用
標記這種聯繫的關鍵在於移動深鏈接
一個深鏈接像是一個URL而不是一個關聯內容的網頁
即關聯到應用內部的具體內容
早前你看過這個示意圖
當時我們爲從設備中獲取的公共項目設置設備內置索引和雲索引
爲了抓取網站內容
現在Apple有一個網頁抓取器叫做AppleBot
AppleBot會查找網頁然後多次抓取應用網頁
對於許多這樣的內容你無需做什麼
如果你的網站支持移動深鏈接
那麼我們可以繼續找到這些內容
並讓它們可被iOS搜索和Safari上搜索到
當這些內容從網站上撤出
就像你看到的 我們將直接在搜索和Safari上顯露出來
當用戶點擊其中一個結果它們直接深鏈接到你的應用中的內容
用戶就可以看到來自搜索結果的內容
你可以發現有一個連接到你應用的鏈接
這是免費的
你不用在應用內特別做什麼才能使用到這鏈接
用戶只需點擊左上角的鏈接他們就會被帶回到搜索
這使得它無縫往返
使用web markup只需四個簡單步驟就可讓你的應用內容被搜索到
第一步
確保Apple可以發現你的網站並索引你的網站
第二步確保你的網站包含移動深鏈接標記
下一步確保你的應用可以處理打開這些深鏈接
最後雖是可選項目但我們強烈推薦
就是爲結構數據添加標記
我們等下會談談這是什麼
這樣可以讓你的搜索結果看起來豐富從而吸引用戶
因此第一步讓你的網站容易被Apple發現
我們將抓取網頁同時找尋網站有深鏈接確保我們可以找到應用網站
最簡單的方法是當你提交網站給iTunes Connect時
用它作爲你的支持或營銷URL
當你提交應用的時候會有兩個文本框
這很容易
我們使用它作爲找尋移動深鏈接的開始點
下一件事情就是確保你的網站已經有深鏈接標記
最普遍的做法你之前可能已經看過
某種被叫做Smart App Banners的東西
它們已經存在一段時間
這是一個簡單的&lt;meta&gt;標籤用於指定應用
並且說明深鏈接URL是什麼樣
當用戶訪問Safari應用網站時他們會看到一個橫幅廣告
如果用戶還沒有安裝該應用
廣告允許用戶直接進入應用商店進行安裝
如果已經安裝你可以直接點擊視圖按鈕
直接在你的應用裏查看內容
如果你想了解更多關於Smart App Banners
請查看Safari網站內容指南裏面有更多信息
在iOS 9裏有一個新特性叫做Universal Links
它是一種比Smart App Banners更好的方法
自定義URL方案有一些優勢之前你可能已經用於深連接了
第一個優勢是唯一性
許多應用支持自定義
他們可能對相同自定義URL方案產生衝突
但使用通用鏈接的話就不會有衝突
因爲我們使用應用網站作爲唯一的識別方法
這也很安全
因爲可以說一個應用屬於某個特定網站而這是我們設置好的
將簽字證書上載到網站
然後當用戶安裝應用時
我們可以檢查證書並確保這二者是關聯在一起的
這樣做也非常靈活
因此不論是在網站內還是通過應用進行控制 用戶可以控制行爲
從而用戶可以額輕而易舉地切換行爲並選擇他們最想要的默認值
這意味着可以在不使用JavaScript的情況下詢問用戶要什麼
另一個不使用Javascript的優勢是
這是深連接的一種比較複雜的類型我們要花很多時間來理解
使用通用鏈接可以確保我們能正確地解析深連接
最後一個優勢是普遍性
一個通用鏈接是一個單獨的URL可用於網站內容以及應用內容
你不需要有兩個不同的URL一個用於網站 另一個用於深鏈接內容
如果使用通用鏈接
我們仍需通過web markup來瞭解深鏈接
所以你想要使用Smart App Banners
或者其他支持方案
這同樣確保瞭如果用戶沒有安裝應用他們仍可以發現應用並安裝
因爲通用鏈接的一個特點是一旦你安裝應用通用鏈接就會被啓用
想要了解更多的話我強烈建議你查看無縫連接到你的應用
明天會開始的部分
下一步是說我們支持深鏈接
它的替代方案之一是Twitter卡
Twitter卡也使用meta標籤和Facebook應用鏈接
除了支持智能應用橫幅外
我們同樣支持這些
並且我們將添加到其它以後可能出現的流行標準
最後確保你的應用可以打開深連接
過去你可能對此很熟悉你可能已經在你的應用裏這麼做了
你已經確保實現了openURL
這裏有一個簡單的使用openURL的例子
在我們的例子中
我們有一個URL
它可以查看配置文件 而且有一個配置文件ID
我們用NSURL組件進行URL解析
然後將配置文件ID從查詢參數傳到視圖控制器
這是一個例子說明如何簡單在你的應用指中支持深鏈接
現在我想談談之前我提及的結構化數據
結構化數據是基於移動深鏈接之外的一些東西
它讓我們理解並解析搜索結果信息
解析自由格式的網頁文本是一件困難的任務
結構化數據能提供極大幫助
而且還可以確保搜索結果更爲顯眼
而不僅僅在結果中出現圖片 評級和其它關鍵事項的文本
這同樣還可以幫助你提高排名
因爲我們知道結果豐富可以吸引用戶
比起其它結果我們更能凸顯該結果
所以添加這種結構化數據類型標準之一是開放式圖表
使用開放式圖表可以從結果中指定一張圖片 一段音頻甚至一段影像文件
你只需簡單地將標記放置於網頁之中
然後我們將把它與在同個頁面的深鏈接關聯
另一種很普遍的結構化數據形式是schema.org
我們會馬上添加支持
一個普通的schema.org是AggregateRatings
主要用於排名和評論
這個例子中我們會展示
使用schema.org微數據添加AggregateRanging標記
而且我們還支持RDFA
因爲JSON-LD基於網站的執行方式
我們在以後會提供支持並進行解析和設置兼容
現在讓我們來詳細分析一個例子看看實際上是如何運行的
這裏有一個airbnb結果
第一件事也是最明顯的事
我們使用標準HTML&lt;標題&gt;標籤進行解析
然後我們進一步來解析標題
這裏顯示的每晚價格
我們可以做到這一點
是因爲我們已經把報價模式添加到網頁並且把它關聯到酒店
我們可以解析價格以及計價貨幣並直接顯示在結果中
我們也可以通過schema.org的AggregateRanging展示評論數量
並且用星進行排名
最後使用開放式圖表的圖像標籤展示圖片
現在談談我們在schema.org上支持的一些模式
第一個是AggregateRatings
另外是報價價格
或者如果你有一個用戶消費型網站你提供銷售的商品
正如我們看到的酒店預定
價格範圍 如果沒有固定價格的話還有許多與價格相關的因素
比如喜好 風景 評論等
同樣interactionCount將會被schema.org裏的新模式取代
這個我們也同樣支持
如果你正考慮從interactionCount轉移到Actions
對於像公司等這樣的商業組織
你可以將地址與電話號碼等聯繫信息關聯起來
稍後我們將看看這樣做如何使你的搜索結果更加豐富
Recipes這是一目瞭然的SearchActions
如果你的網站有一個搜索登錄頁面
使用特別方式進行標記
這樣我們也能處理搜索結果只是方式稍微不同而已
我們知道這是一個搜索登陸頁面
最後是ImageObjects
這僅僅是針對圖像的
現在我想談談Actions
Actions是一種運用結構化數據使得你的結果可執行的方法
在支持啓動的時候有一系列的操作
第一步是撥打電話號碼獲取地址
並播放音頻或視頻文件
這些例子的第一步是撥打電話號碼
正如我們之前在組織模式裏看到的你可以添加電話作爲一項屬性
當我們看到這個電話號碼後可以解析它並直接在結果中放置一個撥號按鈕
現在你的結果已經可以執行撥號了
另一種是使用AudioObject模式
使用AudioObject你可以指定一個URL到音頻文件
且用戶可以在結果中播放文件無須深鏈接到應用中再從裏面進行播放
最後獲取方向
提供一個郵政地址使我們可以允許用戶直接導航
而不需要深鏈接到應用
這樣做的好處是使得結果更有可能與用戶互動
如果一個用戶看到結果清單並且可以直接執行想要的操作
他們更有可能會點擊你的結果
所以我們在這裏展示了許多不同的模式 標記
我們將在今年晚些時候添加測試工具用於測試網站上的標記
這些將在今年晚些時候出現在開發者網站上
我們將有對深鏈接標記和搜索結構化數據標記的測試工具
最後當你添加移動深鏈接
或結構化數據到網站
我只想要鼓勵大家多用一些資源進行資源檢查這些資源提供許多信息
並且我們希望能夠助你一臂之力
謝謝
現在我將把這裏交還給維普爾
這是三個簡單 強大 靈活的方式讓iOS 9裏的應用可被搜索到
你應該使用哪一個
這取決於你想要創建的內容性質的功能以及想要的搜索體驗類型
CoreSpotlight用於設備上的私人數據索引
你可以使用CoreSpotlight來徹底索引應用裏的數據
如果你正建立或者說你有一個社交網絡應用
你想要索引所有用戶發出和接收的信息
CoreSpotlight是最適合的工具
web markup適用於映射應用內容到網頁上的情況
如果你這麼做了你當然要使用這個標記
因爲它爲你的應用和內容提供更多被用戶發現的機會
而這些用戶還沒有安裝你的應用
NSUserActivity可用於應用內公共
或私人內容以及索引導航點
現在有另一種風格的NSUserActivity
那就是戴夫談及到的公共索引
這玩意兒真的非常強大
如果你的應用有百萬甚至是上億項目
你可以使用公共索引從根本上移動這些項目
並在蘋果雲索引裏索引
這些API各自千秋
但是又能配合使用
在相同的應用 相同的內容裏你可以採用多個API
唯一要記住的事情是
在多個地方被索引的項目你需要賦予其相同的ID
從而關聯這些項目
如果你使用所有這三個API
最常用的ID是URL 
你可以設置CSSearchableItemsUniqueIdentifier到URL
然後NSUserActivity關聯到該唯一標識符
然後網頁URL關聯到URL
如果你同時使用NSUserActivity和CoreSpotlight
這是一種很普遍的組合模式你只是需要確保它們有相同的ID
這有助於搜尋複製結果也有助於項目排名
讓我們來談談排名
搜索的真正魅力在於基於用戶輸入的一些信息
提供最相關的結果
到這裏我們已經做了許多
相關性和排名是一種複雜的功能指的是配對查詢和項目
這裏說的絕大多數對於開發者和用戶是完全透明的
然而
這裏的一個重要的排名因素是與內容和結果的互動
你可以做的是幫助確保搜索抓取所有這些互動
我們有三種互動類型
一是URL廣泛度
這是通過web markup索引的可應用內容
它是基於你添加到模式當中的質量指標
比如排名 喜好 評論以及網頁鏈接圖表中URL的位置
URL基於廣泛度提高排名並且這是自動發生的
第二種互動
是應用內內容被查看的頻率
抓取該頻率的唯一方法是通過NSUserActivity
這就是爲什麼我們一直鼓勵你採用NSUserActivity
第三種也是最重要的
互動形式是搜索結果參與度
當搜索結果展示給用戶的時候
不管他們是否點擊結果
或者他們是否對結果中的描述感到滿意
我們稱爲無聲參與並通過解析環節抓取
從而獲得優化關聯性的快速清單
首先
繼續你現在在做的事情開發出優秀的應用和內容
搜索系統本來就是設計用於發現最好內容的
你可以幫助我們確保所有的互動
都可以通過NSUserActivity抓取到
在可執行的地方使用公共索引NSUserActivity
因爲根據用戶數據我們現在可以抓取內容的參與度
採用模式標記的方法標記處互動計數和質量指示
最後遵守用戶界面指南我稍後將談到它
突顯優秀內容另一方面是去除不相關的內容
我們在這方面也已經做了許多工作
如果惡意或不好的應用濫發索引郵件
我們將對結果進行降級或完全壓制這些搜索結果
最重要的方法是參與度顯示比
即搜索中展示的結果數量和參與的次數的比值
低參與度將會被壓制
而高參與度將有助於提升結果在搜索中的排名
獲取高參與度的最好方式是
遵守用戶指南中的一些建議
你在iOS 9中可以注意到的一件事情是
即使是來自內置應用的搜索結果內容也很詳實且豐富
這是因爲我們發現更豐富的結果意味着更高的參與度
這裏有幾件事情提供一個縮略圖
提供一個精心構建的易被閱讀的描述以及排名和操作
縮略圖裏的圖像效果非常強大
當用戶他們點擊結果後他們會感受到所看到的
提供一個好的縮略圖
提供用戶找尋的關鍵信息
例如如果用戶正找尋一個訂艙號一個在描述中提及的參考號
這樣搜索任務可以在搜索中完成
另一個強大的功能是支持關鍵字
在所有的API裏你可以提供一串關鍵字
然後進行搜索
種類關鍵字是非常非常實用的
當用戶找尋一種具體的“票”時
它們可能鍵入票的類型而不是票的名稱
當他們找尋蛋白質的時候他們可能鍵入食譜
這讓用戶感受到一個神奇的智能體驗
其它實用的關鍵字類型是同義詞和縮寫詞
用戶想關鍵字越少越好
所以他們可能輸入sf giants
而非San Francisco Giants
你可以通過關鍵字提供相關回調
同樣重要的是
啓動行爲這指的是用戶點擊結果所發生的事
你想把用戶直接帶到搜索內容裏面
而且沒有插入式廣告 沒有彈出廣告
沒有屏幕廣告 而且加載頁面很快
測量和估計從點擊到內容展示的時間是很重要的
並將該使用作爲排名的一個因素
這裏有兩個例子
一個是對的一個是錯的
讓我爲你展示如何做
我確定沒有人的應用會這麼做
用戶會很沮喪而且你想要找到完全避免的方法
我們來談談接下來怎麼做
當然了你可以對你的應用內容進行全面索引
這是我們發現的在搜索上下文方面非常實用的一些事情
你可以通過NSUserActivity抓取任何用戶過去查看的內容
或用戶創建的內容 或評級過的內容或在應用內創建的清單
人們想要返回到任何他們過去做的事情
導航點和功能是非常非常實用的工具
用戶可能想要查找
應用裏的新信息 新內容
你可能想要在搜索中查找這些
你可以進行創新式的
或者主動地進行項目索引
而這些正是用戶想要查看的
假設我買了一張音樂節的票但我可能對區域內另一場音樂節感興趣
你可以使用你的應用解析得到有趣的內容並將其放入索引
API非常靈活
而且允許你創建非常新奇的搜索體驗
這方面有無窮的可能性
總結一下讓我們看看我們在這個部分談及的內容
我們介紹了用於索引深鏈接
和應用搜索的快速設備內置和雲架構
我們向你展示三個API以及你可以採用的深鏈接方法
我們向你展示了好的內容豐富的搜索結果
以及內容到結果的快速互動方式
是如何改善搜索體驗的
API可以抓取你的內容
並展示給世界各地的iOS用戶
我們還有更多的信息
如果你想要了解詳細信息你可以前往搜索文檔首頁
我們的論壇上有更多關於互動的內容
我建議你前往詹森介紹的無縫連接環節
我們有兩個實驗
一個將在我完成講說的時候馬上開始大家可以加入我們
另一個是在星期五舉行
我們希望在星期五的時候看到
大家在WWCD整合搜索API的成果
這就是應用搜索的全部內容