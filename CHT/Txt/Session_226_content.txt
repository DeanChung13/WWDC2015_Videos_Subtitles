高級 NSOperations開發WWDC app
早上好我叫菲利普·豪斯勒
我在框架組從事Foundation相關工作
今天我們要講的是NSOperation
和NSOperation隊列
這是兩種極其強大的類
可將你的應用
從直線性運行任務
轉變成爲以目標爲導向
和功能異步概念的混合模式
現在 我很肯定大家都已經看過這個應用
WWDC應用廣泛使用
NSOperation和NSOperation隊列
使我們能夠
一直通過從互聯網下載內容與數據庫甚至是
出現提醒或展示視頻的概念同步
來完成各種不同的任務
大衛·德龍將帶我們深入瞭解
NSOperation和NSOperation隊列
以及如何使用它們執行實現WWDC應用
大衛
菲利普
我叫大衛·德龍我是Apple的框架專員
同時我也是WWDC應用的首席工程師
大家對WWDC應用應該都很瞭解了吧
今天 我們會講到WWDC應用
和NSOperation
三個主要方面
首先 我們回顧一下NSOperation的主要概念
如何理解它的API
以及充分利用它的強大的狀態機的優勢
然後 我們將看看除了基礎知識外
WWDC應用還面臨的挑戰
以及我們如何解決這些挑戰
最後 我們會講講
部分已經提供給你們的樣品代碼
首先 我們來看看一些核心概念
不管任何時候一旦你用了NSOperation
你也總是會用到NSOperation隊列
關於NSOperation隊列
可以說其實就是一個高級調度隊列
相信通過使用多線程優化技術
你們對調度隊列都很熟悉了
現在 我們還提供基於NSOperation隊列的包裝器
然我們可以獲得一些功能
比如說
NSOperation隊列可以很容易取消
還未執行的操作
雖然你可以通過調度塊來取消
這是很機智的做法
但是NSOperation隊列可以讓操作更簡單
另一個
你可從NSOperation隊列獲得的是
一個屬性 叫做最大並行操作計數
爲更好的理解它
我們先來看一個小動畫
若將NSOperation隊列的
最大並行操作計數設爲1
基本上
就可以將NSOperation隊列
做成一個串行操作隊列
在隊列中加載多個操作
最大並行操作計數爲1時
隊列將一個一個完成操作
並按照順序執行
在前一個操作未完成前
下個操作是無法開始的
這是一個串行隊列
可是 通過默認
這個屬性的數值是默認數值
意思是說和系統允許的一樣多
也就是說操作隊列可以同時執行多重操作
正如系統資源所允許的那樣
在這個案例中
操作隊列可能一次執行兩個操作
可以改變像這個操作隊列的行爲的能力
可以說是非常強大的
在操作隊列創建時
我們並不需要做決定
這就是NSOperation隊列
現在來看NSOperation
既然隊列是調度隊列之外的高級包裝器
我們也可以將NSOperation
理解成是調度塊之外的高級包裝器
現在 一般來說
NSOperation運行時間
比塊的運行時間稍微多了些
塊的執行通常只需幾納秒
甚至是毫秒
換句話說NSOperation花費更長的時間
從數毫秒甚至到數分鐘
隨後我們會講到這點
NSOperation另一個很棒的地方是
因爲它是一個類可以被劃分成子類
你也可以自定義它的執行邏輯
爲將NSOperation劃分爲子類
我們來看下它的生命週期
當你創建NSOperation時
它總是從一個被稱爲
待定狀態的狀態中開始
所以 當它被初始化
並被放到操作隊列時這就是操作
現在 在某一時刻
操作已準備好可以開始執行
它進入就緒狀態
準備就緒後
操作隊列將完成隊列排列
並開始執行
正如我所說的這執行可能用掉數毫秒
或數分鐘 甚至更長時間
執行結束後
操作進入完成狀態它的完成狀態
非常的簡單
操作可以做的另一件事是
可以在任何時候
進入取消狀態
我們來看看取消
NSOperation中的取消被定義爲
一種簡單的布爾屬性被取消
理解這個屬性的關鍵點是
它只改變
屬性的狀態
當你取消操作時所出現的只是
布爾數值快速翻動
當你在劃分NSOperation子類時
取消NSOperation意味着什麼
取決於你的意圖是什麼
比如說
你的操作正在執行網絡任務
取消操作意味着
取消網絡通信
又或許
你的操作在執行一些數據處理
取消操作
可能就是放棄處理
所以當你劃分NSOperation子類時
務必觀察數值變化
並在需要作出反應時做出正確的反應
關於取消 你還需要知道
它對競態條件很敏感
這是什麼意思呢
試想一下有個在後臺執行的操作
或許在你的UI中
有個取消按鈕
可以取消這個操作
若用戶輕敲取消按鈕
它需要一點時間
將取消信息從主隊列
傳遞到後臺的操作中
若在那段傳遞時間裏
你的操作完成執行
那麼你的操作將無法被取消
因爲一個操作
無法從完成狀態回到取消狀態
所以知道這點很重要
你試圖取消操作
但事實上 有些情況無法取消
然而 如果你不需要取消操作
那就很簡單了
你所需做的 只是調用取消方法
這就是取消
現在來看看另一個有趣的狀態
叫做就緒
NSOperation的準備就緒就像取消一樣
被定義成一種簡單的布爾屬性即準備就緒
這個屬性的意思是
操作已準備好可以執行了
我們來看看
它如何與操作隊列中的操作相互作用
再一次我們有了串行操作隊列
載入多個操作
所有操作都處在最初的藍色待定狀態
儘管 比如 在這個案例中
第四個操作也在隊列裏
但是進入就緒狀態的第一個操作
纔是即將被執行的第一個操作
所以一旦操作準備就緒它就開始執行
隨後 當其他操作準備就緒
它們將推進隊列 並被執行
在這個案例中因爲這是一個串行隊列
一次只能執行一個
若兩個操作同時準備就緒
擁有較高優先權的操作獲得較早執行順序
隨後纔是優先權較低的那個
當其他操作也準備就緒了
它們也將贏得隊列並被執行
以上簡要介紹了準備就緒
那我們可以用它來做什麼呢
我們可以用它來創建相關性
相關性是用來表達
操作的嚴格排序的一種方法
我們要先執行這個然後執行那個
相關性靈活的地方在於
它提供了
準備就緒操作的基礎定義
通過默認設置
當操作的相關性完成執行時
操作也準備就緒
該行爲是自動的
相關性另一個靈活的地方在於
它們不受操作隊列的限制
這是什麼意思呢
若你的應用中有兩個操作隊列
第一個隊列中的操作
可以取決於第二個隊列中的操作
隨後我們會說說
它如何讓一些真正強大的模態成爲可能
現在 在你的操作中創建相關性
很簡單
我所需做的是使用增加相關性方法
在這個案例中
操作B將取決於操作A的成功執行
操作B將等到操作A執行完畢後纔開始執行
這是確定的
關於相關性 我們會碰到一些問題
比如操作停頓
如果我們有操作A
和取決於操作A執行的操作B
這沒有問題
然而 要是我無意中讓A也取決於B
那麼這兩個操作將無法執行
因爲它們彼此都在等待對方完成
既然都在等 那也就是沒有開始了
所以 當你在你的應用中
創建相關性時 不要這麼做
現在WWDC應用到處都在用相關性
一個很簡單的例子當你在你的app上
點擊增加到收藏夾按鈕時會發生什麼
這個很可能你們都做過
當你點擊按鈕
我們先首先創建一個操作
叫做登錄操作
這個操作可確保你
使用開發者的名字和密碼登錄到app上
接下來我們將創建另一個操作
叫做用戶信息操作
這個操作確保你的用戶名和密碼
比如說 就是開發者的用戶名和密碼
而不是iTunes用戶名和密碼
這樣你的Apple ID就是開發者AppleID了
現在 WWDC應用的收藏夾
保存在CloudKit中
我就需要另一個操作
確保我們可以獲得你的iCloud賬號
這是後臺進行的
因爲我並未請求允許
查看你在app上的第一個和最後一個名字
我們需要確保你有一個iCloud賬號
最後
我們創建保存收藏夾操作
這取決於
成功完成關於你是一名開發者的驗證
和成功完成
你擁有iCloud賬號的驗證
這只是一個簡單的例子
我們來看看複雜點的事例
當WWDC應用啓動
我們需要一堆的設置
首先我們需要下載一個小的配置文件
這個文件將提供一些信息
比如
應用的最新支持版本是什麼
有什麼特性 等等
所以 文件下載後
我們需要檢查版本
確保所運行的版本就是WWDC應用最新版本
app版本檢查完畢後
就可以開始下載一些有用的信息
比如新聞標籤裏的新聞
發佈會時間表
時間表下載後
就可以開始導入存放在iCloud中的收藏夾了
以及導入提交的反饋信息
在App中可以看到 另外
我們還可以下載視頻文件
所有這些均需要時間表事先準備就緒
最後
我們可以保存NSManaged對象環境
在這裏 我們保存了所有的信息
我們來看看
相關性和操作生命週期
如何影響這些操作的執行
我們要將它們
全部移到設定爲待定操作狀態
現在
下載app設置的第一個操作沒有相關性
因此它立刻準備就緒 可以執行
我們的操作隊列即將完成
開始執行 隨後它將完成執行
現在 當它完成時
版本檢查操作
也立馬準備就緒
推進隊列 然後開始執行
當它完成時
第三個操作也同時準備就緒可以開始執行
它們即將開始執行
當他們完成執行時
越來越多的操作也準備好可以執行了
它們將推進隊列 並開始執行
需要明白和注意的一件重要事情是
在所有其他操作全部執行完畢之前
保存環境的操作是
沒辦法準備就緒 等待執行的
通過使用相關性可以確保
操作按照正確的順序進行不會出現失控的情況
所以現在 這個準備就緒
可以執行 完成了
這樣App的啓動就可以持續進行
以上就是關於相關性的內容
總的來說NSOperation是一種極好的方法
可以用來提取代碼中的邏輯
通過在操作中放入邏輯
簡化邏輯變化
因爲我們處理的是單獨的工作
很多就像我們處理塊一樣
作爲例子
今年的WWDC應用中
收藏夾和反饋的保存位置
從後端移到CloudKit
此刻 請大家想想
將你的應用從自定義從你正在使用的任何服務上
轉移到CloudKit上需要做些什麼
獲得網絡通信的代碼的所有地方
服務器供應商複雜事情的所有相關性
如果你突然對這些變得很恐慌
這就是應該使用操作了
在WWDC應用中
我們所有的網絡通信都在操作之後進行
這意味着後臺將從
使用自定義服務變爲使用CloudKit
我們要做的就是重新編寫這四個小的類別
這隻需要花費我們不到一天的時間
然後還需要另外幾天來測試我們的改動
這個過程簡單但是瑣碎
現在 這所有的一切 也許會令你疑惑
那多線程優化技術呢
多線程優化技術絕對會佔有一席之地
事實上當你下載一組示例代碼做準備時
仔細查看 你會發現
我們在示例代碼中使用了多線程優化技術
當無法完全使用NSOperation時
比如 任何時候 當你需要
從一個隊列到另一個隊列調用一個方法
你都不需要將其打包進一個操作中去
你需要更快更簡便的方法
如果你使用信號量
或調度組來做實現
這些都很適合使用多線程優化技術
所以 那些就是基礎技術
現在看看更高級的技術
現在 我們意識到其中一件事在WWDC應用中
我們實現了UI交互
但仍需其參與在操作鏈中
比如 身份驗證
我們之前談論了保存收藏夾
我們需要確保你已經登錄了
但如果你沒有呢
那麼我們意識到我們可以設置UI元素
UI功能存在於我們的操作之中
比如 在WWDC應用中
向上滑動的身份驗證對話框
其實是NSOperation
無論何時 當你通過WWDC觀看視頻
我們都將其壓縮爲“觀看視頻”操作
所以 我們所要做的就是
用適宜的視頻資源創立一個操作
並將其放置在我們的操作隊列之中
而後一切就都將井然有序了
更甚者當你看見WWDC應用的報警
這也我們將UI放置到
NSOperation內部的一個良好應用
當我們處理不同模態UI時
我們發現了潛在原則
所以 當一個UI逐步接管了整個應用的資源
這時候可以進行打包
一起打包進NSOperation之中
重申一下
當你第一次使用WWDC應用時
你會看見一個對話框
詢問我們是否能夠收集一些
你使用應用時的簡單數據
對話框出現時
這個UI警報管理者
事實上開始在NSOperation內部運行
或者是登陸頁面
如果你嘗試添加一些東西到收藏夾
或對某個板塊留言反饋
這都是NSOperation
接下來我們會遇見的是
有時我們想執行簡單的區塊邏輯操作
但我們還想參與
內部的機械操作
所以我們轉向區塊操作
NS區塊操作
以及我們創建的其他自定義操作
這就是一個NSOperation在執行區塊
也許你會問
那麼 如果NSOperation是區塊的一個抽象概念
爲什麼我又會回過頭來
在NSOperation內部使用區塊呢
那是因爲通過
在NSOperation內部設置區塊
你可以獲得
許多NSOperation的好功能
比如相關性
讓我們看看我們能用它來做些什麼
看看在WWDC應用中當你點擊反饋按鈕時會發生什麼
好的 離開反饋按鈕
想執行一個segue
想呈現一個視圖管理器
好讓你給出五顆星表示非常滿意四顆星表示滿意
我們會執行這個segue
所以我們將這個segue設置在區塊裏面
然後將這個區塊
放置進區塊操作
現在我們允許你離開反饋如果你已經註冊完這個應用
所以我們需要驗證用你的開發者賬號已經登錄
就像我們添加收藏夾時做的那樣
爲了驗證你擁有一個開發者賬號
我們需要確定你已經成功登錄
所以通過執行區塊操作內部的segue
我們能保證
在你登錄之後
不會再呈現登錄頁面
這是非常強大的功能
我們在描述一個非常複雜的行爲
一系列的事情
都是依靠使用操作和相關性
在我們編寫WWDC應用過程中
我們注意到在某些情況
我們在重複大量的同樣操作
比如 我們已經看到
註冊和用戶信息操作過幾次了
那麼我們就想如果能
創造一種自動操作方法
不是很好嗎
所以我們提出一種方法
形成其相關的操作
換言之 我們想表達
就是我們不想執行那些總是
需要執行的事
所以 讓我們在此看看
收藏夾和Cloudkit
或下載一個通行證
亦或看看
WWDC應用中需要登錄的情況
所以 當你點擊“添加收藏夾”按鈕時
我們做的就是常見一個單一操作
來添加收藏夾
這將打包某些信息
如這個會議的標誌
以及你是否想添加到收藏夾或進行移除
一個布爾標識符
現在 這個“收藏”操作
需要獲得允許才能執行
所以它自動的形成了兩個相關性
一個用來確認你是開發者
另一個保證我們獲得iCloud賬號
現在 這個操作保證了
你作爲開發者能確保登錄賬號
所以形成了相關性
從而確保你登錄成功
這樣我們能夠
簡單保存應用密碼
我們只需要創立一個單一操作
然後它會自動形成相關性
可能稍後 如果我們想要移除代碼
那麼需要登錄才能添加收藏夾
我們只需移除一小段
執行收藏操作的代碼
那麼該相關性就被移除了
這樣就移除了整個應用中的相關性
我們並不需要檢查
每一個“添加收藏”位置
並改寫它們的代碼
現在 我們還想要確認
其他條件也得到滿足
我們需要能夠將準備狀態進行擴展
在允許執行操作的情況下
進行擴展
我們可以舉出一些示例
比如我們只想在確實連接到網絡的情況下才執行操作
比如 如果你嘗試
在手機處於飛行模式的情況下添加收藏夾
當然 我們不會使用執行CloudKit操作
我們還想要確保
在抵達某個位置後執行一個操作
那麼 我們需要有能夠表達該意圖的方式
又或者 我們只想在實際登錄到app後
才執行特定的操作
因此 通過擴展這個概念
讓操作已經準備就緒
我們可以更有效地執行操作
因此希望大家不會遇到這樣的錯誤
如果遇到了 說明操作出錯了
因爲操作還未準備就緒執行
這種情況下
由於無法連接到網絡
因此 擴展該準備狀態
非常有用
另外 我們還有一些操作
我們可以同時執行
因此 我們想如果需要不斷
創建相同的操作序列的話那就很麻煩了
是否可以開發一個操作
然後在其之下
創建相同的操作序列？
一個普通例子是
下載文件然後
另存到本地空間
我知道大家
對這個非常熟悉了
那麼 讓我們看看我們可以如何合併操作
從而簡化流程
假設我們有一個一般類的數據操作
然後它和其他東西
互相關聯
現在我們想植入一個想法
好的 我們想要它做兩件事
首先要包括另一個NSOperation
然後這個操作要執行下載任務
這是個簡單獨立的工作
然後它會創建第二個操作
用於下載另存
然後和下載操作相互關聯
這樣另存操作總會在下載之後執行
現在 通過將這兩個操作打包
成一個更大的操作
我們可以輕鬆修改
我們數據的來源
數據的格式
甚至是處理錯誤的方式
而我們只需在一個地方
修改即可
在輸入操作中修改因爲這裏是app唯一可識別的位置
現在 你沒有一定要提前清楚
你需要執行的操作是什麼
在WWDC應用中
在編譯時間 我們無法知道
保存到CloudKit上的收藏夾有多少內容
這樣我們需要一種方式
讓我們可以進行動態操作編輯
因此 我們開發了封裝器稱之爲抓取收藏夾操作
而且由於我們正在包裝器下使用CloudKit
我們需要執行CK請求操作
因爲CloudKit是基於NSOperation開發的
這樣 我們先要執行第一個請求操作
也許WWDC上有你收藏的一個會議
因此該操作會指向那裏
並獲取更多的收藏內容
因此 我們現在要繼續執行請求操作
直到我們接收到反饋
說明我們已經全部獲得了
因此 通過使用組合模式
我們仍可以通過一個“抓取收藏夾”
操作來表達我們的操作鏈
但是在其之下
實際上是按次序執行多個操作
現在 在代碼中的情況看起來是這樣的
我們的操作有一種執行方法
而且這是所有操作的起點
因此第一次
抓取收藏夾操作開始執行後
這裏會進行初始請求
我們要爲你查找收藏的會議記錄
這樣我們會發出請求操作
然後提交給這個方法稱之爲執行請求操作
這是執行請求操作
請求操作完成後
我們需要先檢查
看看是否有錯誤
如果有 我們要中止流程先處理錯誤
如果沒有錯誤 但是存在指針
這是CloudKit通過指針告訴我們
還有其他有待抓取
那麼 我們要使用該指針在序列後
創建下一個CK請求操作
然後進行半遞歸式調用執行請求操作
這是我們執行多個請求操作的方法
另外 如果沒有指針或者錯誤出現
那麼是CloudKit指示我們已經抓取完畢
這樣我們可以開始導入
已經下載好的記錄了
在開發過程中
有幾次我們遇到視圖故障
我們認爲是視圖故障
現在 也許大家都有在使用app過程中
警告跳出的經歷
在你準備點擊關閉的時候
另一個警告又跳出來
這時你想 哦 好吧這是發生了什麼呢？
也許又在你要點擊關閉的時候
又有一個跳出來
因此畫面總是反反覆覆
你甚至不確定現在看到的是第一個警告
還是第幾個警告
我們是如此想要避免這種令人厭煩的情況
另一個我們想要的是
我們想要確保
你只會一次觀看一個視頻
這個問題WWDC應用現在還無法明白
如何正確處理
因此我們想要確保無論你做什麼
我們都不會允許你這麼做
另一個我們想確認的是
我們不會一次試圖
加載多個基本數據庫
因此 我們想出一個方法用於描述互斥性
這種方法是在一個時候只執行一種特定的操作
現在 也許你在想 哇這個想法真複雜
具體我們如何辦到呢
實際上很簡單
現在我們回到那個警告的例子
假設我們創建一個操作用於顯示警告
並警告用戶
然後我們將其放到操作序列中
也許需要等待一下讓其他操作先完成
也許操作已經完成了一半我們不確定
但之後發生了些事
而且我們決定再創建另一個警告操作
好的 我們要做的就是
讓第二個警告操作
與第一個相關聯
這正是跨隊列相關性強大之所在
因爲不論警告操作
在哪個隊列中執行
只要第二個操作與第一個相關
那麼第二個操作只有在第一個操作結束後纔可以執行
而且 由於某些奇怪原因
我們決定創建更多的警告操作
更多的警告操作 只要我們設定
下個操作與之前的相關即可
就像一張時間關聯表一樣
我們可以確保操作
將彼此產生互斥性
真是功能強大啊
通過使用相關性
我們可以確保應用的行爲正確
我們可以確保用戶
不會同時收到多個警告
我們可以確保用戶
不會一次試圖觀看多個視頻
我們可以確保用戶
不會同時加載兩份數據
因此 以上是我們遇到的一些挑戰
並嘗試在編寫WWDC用的時候解決
還有更多
但我們認爲這些真的很酷
而且我們會想到更爲簡單的方法
去解決我們遇到的問題
那麼 我們現在談談樣本代碼
在WWDC網站上的樣本代碼部分
你可以找到一段樣本代碼
叫做高級 NSOperations
這是一個簡單的app
用於顯示最近的地震
但是這個app是
完全基於NSOperations的
而且該app的操作
是我們之前
從WWDC的app中提取出來
然後放進去的
這個app中的這些代碼
實際上已經有好幾年的歷史了
非常穩定
現在 初級類別就是樣本代碼
這是NSOperations的基礎子類別
在樣本代碼中
我們在才操作中加入了兩個關鍵特性
首先
是條件
之後我們會談談這點
第二個概念我們稱之爲“觀測器”
現在在樣本代碼中
我們已經有許多不同種類的操作代碼
我們有羣操作
方便進行更多的內部操作
另外 在樣本代碼中我們還有操作子類別
允許你獲取NSURLSession任務
並在NSOperation中進行處理
這樣你可以讓不同任務之間進行關聯
或者進行條件設定 或者設置觀測器
這裏有一個示範操作用於請求你當前的位置
有時候這非常有用
我們要做的就是稍微等待一下
這裏甚至還有一種操作
可以向用戶顯示
帶按鈕和塊處理程序的警告
因此 NSOperation的樣本代碼中
有非常多的子類
現在 操作有了條件的概念
一個條件指的是一個協議
我們定義的協議
這樣 對於操作而言
可以表示它是如何生成相關性的
如何定義互斥性以及如何擴展預備狀態概念
這樣 我們在樣本代碼中
提供了一些條件
其中之一是互斥性通用條件
這種條件表示一個操作
與相同類屬的其他操作
是互相排斥的
這裏我們還有可達性條件
這樣通過一行代碼
你可以方便地通過操作表達
只有在網速很好的情況下才執行
另外 我們還有非常多的許可類條件
比如
只有在使用特定的Cloudkitcontainer的情況下
才執行操作
或者當我們使用日曆
或者使用照片庫或者使用通訊錄
或者其他你設定條件的情況下才執行操作
這就是條件操作
最後是操作觀測器
操作觀測器也是一種協議
通過這種方法
在操作過程中
操作會注意重要事件的值
比如開始執行 終止執行
以及如果該操作決定
生成稍後被執行的另一個操作
從而生成一個警告操作
另外我們有許多觀測器示例
比如超時
通過在操作中簡單加入超時觀測器
這樣觀測器會進行觀測確保
操作在你設定的時間範圍內
執行完畢
並且 如果超時
那麼觀測器將自動取消操作
我認爲一項利器的是背景觀測器
當你將背景觀測器設定到一個操作中後
觀測器會觀測UI應用的狀態
如果應用進入背景
那麼觀測器將
自動啓動背景任務
然後在操作完成後
自動終止任務
這樣 如果你正處理某些重要操作
比如也許你正上傳數據到服務器
而你不想被終端或者暫停
一個方法是你可以
添加背景觀測器到操作中
這樣可以確保你在背景有足夠多的時間
這樣你可以完成該上傳操作
另一種方法很酷
是網絡活動指示器觀測器
你可以將這個觀測器添加到操作中
當其啓動後
觀測器將在狀態欄中
對互動指示器進行數值遞增操作
然後當操作停止後
進行數值遞減操作
這樣你可以同時進行多個網絡操作
並且添加其中一個網絡指示器
或者觀測器後
觀測器會自動
顯示和隱藏網絡活動指示器
從此 管理這種複雜的事情
都可以完全交給操作了
而所有這一切都可以自動進行實在是酷
另外在樣本代碼中
我們還提供了其他的觀測器
比如能夠添加任意代碼塊到這三個事件中
然後讓其自動重新執行
以上就是樣本代碼的情況
乍看之下 代碼很像一個簡單的應用
但是仔細一看 裏面很精妙
我真的推薦大家下載看看
那麼 總之
使用操作可以對應用進行邏輯抽象處理
通過在操作中加入你的邏輯而且之後很容易進行修改
比如我們如何將WWDC應用跳轉到使用CloudKit
這只是一個簡單的改變
使用相關性可以表達應用之間的關係
這樣可以很容易確保特定行爲之間的關係
比如A行爲之後必須是B行爲
另外
操作讓你可以描述複雜的行爲
比如互斥性或者整合
這對於操作來說很簡單
而且NSOperation能夠允許你花費非常少的心思
就能執行非常強大的功能
因此 我們未大家提供了相關的會議
接下來的會議是
“建立響應以及GCD的高效應用”
我們期待大家也參與GCD
這是一項非常好的實用技術
因此 我鼓勵大家出席會議或者觀看視頻
看看如何在你的應用中使用GCD
另外 如果你想要了解更多
關於我們的框架是如何使用NSOperation的
你可以查看今年的CloudKit提示和技巧大會
或者去年的“高級CloudKit”大會
另外 我們在WWDC網站上提供了樣本代碼供大家使用
建議大家去看看
我還想鼓勵大家閱讀開發者庫中的“線程編輯指導”部分
這裏有很多有用的信息
方便大家使用NSOperation
如果你需要任何技術支持
我們建議大家可以在開發者論壇上發帖
請教或者聯繫開發者技術支持部
非常謝謝希望大家繼續享受接下來的部分