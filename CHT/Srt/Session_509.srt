00:00:21.421 --> 00:00:23.957 
無縫連接APP

00:00:34.401 --> 00:00:36.603 
大家好
我是康拉德·舒爾茲

00:00:36.670 --> 00:00:39.106 
是Safari和WebKit 
團隊的工程師

00:00:39.306 --> 00:00:43.177 
這是第509號講座
《無縫連接APP》

00:00:44.745 --> 00:00:48.382 
如果參加WWDC 
你幾乎肯定會app

00:00:48.982 --> 00:00:51.785 
甚至會有
app的網站

00:00:52.119 --> 00:00:55.055 
大家舉手示意一下
在座的有哪些

00:00:55.122 --> 00:00:58.859 
有網站 可供用戶
訪問與app中相同的

00:00:58.926 --> 00:01:00.994 
部分內容或功能

00:01:02.062 --> 00:01:04.197 
非常棒 這次講座是爲你準備的

00:01:06.767 --> 00:01:11.972 
我們要談談
怎樣讓app和

00:01:12.372 --> 00:01:14.341 
網站之間的壁壘
不復存在

00:01:14.675 --> 00:01:17.344 
並在二者之間
建立緊密的聯繫性

00:01:18.011 --> 00:01:20.414 
關於我們想談的內容
舉例而言

00:01:20.848 --> 00:01:23.851 
我希望開始
先演示一個app

00:01:23.917 --> 00:01:27.054 
你可能已經在iPhone
或iPad上安裝了它

00:01:28.488 --> 00:01:29.489 
這就是WWDC app

00:01:33.060 --> 00:01:36.129 
我收到同事喬納森
發來的一條消息

00:01:36.597 --> 00:01:38.465 
讓我查看
主題

00:01:39.066 --> 00:01:40.400 
聽上去
這是個不錯的想法

00:01:41.201 --> 00:01:44.872 
我把WWDC app
安裝在這個iPad上

00:01:45.506 --> 00:01:47.674 
看到是個網頁鏈接

00:01:47.741 --> 00:01:50.010 
那麼可能還是在
Safari打開

00:01:50.077 --> 00:01:51.411 
我們繼續 輕點一下

00:01:52.346 --> 00:01:56.817 
哦 相當酷 
直接進入WWDC app

00:01:57.451 --> 00:01:58.852 
也許你錯過了
我們再來一遍

00:01:58.919 --> 00:02:01.421 
我來繼續 輕點回
左上方的信息

00:02:02.489 --> 00:02:06.493 
看到就是普通的
HTTPS鏈接 前往

00:02:06.560 --> 00:02:08.461 
Developer.
Apple.com

00:02:09.162 --> 00:02:11.198 
輕點 一下就好！

00:02:11.431 --> 00:02:14.168 
直接到了app
直接就是主題

00:02:14.401 --> 00:02:16.036 
不要再通過Safari來一遭

00:02:16.537 --> 00:02:17.471 
非常棒！

00:02:25.445 --> 00:02:28.315 
我們要談談
三種很酷的技術

00:02:28.549 --> 00:02:30.217 
可以幫助
消除app和

00:02:30.284 --> 00:02:31.785 
網站之間的
壁壘

00:02:33.020 --> 00:02:36.089 
首先 剛纔大家看到
演示當中的神奇表現

00:02:36.356 --> 00:02:39.193 
輕擊普通鏈接時 
WWDC app在

00:02:39.359 --> 00:02:43.597 
正確的地點打開

00:02:43.964 --> 00:02:47.935 
接下來 我們來談談
Smart App Banner

00:02:48.202 --> 00:02:50.537 
它可以幫助
用戶在訪問

00:02:50.671 --> 00:02:51.805 
網站時 發現app

00:02:53.607 --> 00:02:57.311 
最後 分享網絡憑證
允許app訪問

00:02:57.477 --> 00:03:01.315 
Safari保存的密碼
因此使得

00:03:01.381 --> 00:03:03.650 
用戶登錄app
非常快捷

00:03:04.318 --> 00:03:06.220 
首先 我想有請
我的同事喬納森

00:03:06.286 --> 00:03:09.690 
上臺來和大家聊聊
怎樣連接app

00:03:17.264 --> 00:03:18.165 
<br/> 
謝謝 康拉德

00:03:18.732 --> 00:03:20.701 
大家好 我是
喬納森·格林斯潘

00:03:20.767 --> 00:03:23.637 
是Apple的核心
服務軟件工程師

00:03:24.371 --> 00:03:26.974 
我希望先和大家
聊聊app

00:03:27.040 --> 00:03:29.009 
在宇宙中的
位置

00:03:29.543 --> 00:03:36.250 
剛纔康拉德問 有多少人
既有app也有網站時

00:03:36.316 --> 00:03:38.352 
我看到很多人
都舉起了手

00:03:38.652 --> 00:03:39.820 
這並不奇怪

00:03:40.354 --> 00:03:45.192 
許多現代的app不僅是
讓用戶下載

00:03:45.993 --> 00:03:51.431 
它們還有着
強大的網站呈現

00:03:51.532 --> 00:03:55.135 
網站內容常常
可以反映出app內容

00:03:55.202 --> 00:03:57.871 
在座的很多都有
強大功能的出色網站

00:03:57.938 --> 00:04:01.642 
我們希望用戶可以
使用到這些功能

00:04:01.708 --> 00:04:03.410 
甚至都無需
安裝app

00:04:04.444 --> 00:04:06.313 
我們也希望各種app
都可以彼此配合

00:04:06.980 --> 00:04:11.051 
app彷彿是
生態系統的組成部分

00:04:11.752 --> 00:04:14.922 
在app或網站中
需要訪問其他app

00:04:14.988 --> 00:04:16.255 
或網站所提供的內容

00:04:16.523 --> 00:04:18.192 
需要某種程度的
交流互通

00:04:19.026 --> 00:04:22.829 
例如 如果有美食家app
你可能想把它連到

00:04:22.896 --> 00:04:24.731 
菜譜搜索網站Yumly
這裏app

00:04:24.798 --> 00:04:28.969 
或服務中

00:04:29.636 --> 00:04:33.140 
怎樣讓app連接到
Yumly 怎樣快速

00:04:33.207 --> 00:04:36.743 
準確地提供Yumly的
內容呢？

00:04:37.411 --> 00:04:42.850 
在iOS上 我們通常
用URL在app之間發送

00:04:42.916 --> 00:04:43.817 
數據信息

00:04:44.818 --> 00:04:49.790 
我們先來看
今天我們會怎麼做

00:04:49.990 --> 00:04:53.360 
許多 iOS app執行所謂
自定義URL方案

00:04:54.294 --> 00:04:56.063 
這些是非常有效的工具

00:04:56.129 --> 00:04:58.131 
因爲它們可以讓
app彼此交流

00:04:58.298 --> 00:05:00.501 
但其中也有陷阱

00:05:01.401 --> 00:05:04.104 
首先 它們不會
總能映射到正確的app

00:05:05.105 --> 00:05:06.974 
因爲沒有哪個app
真正擁有它們

00:05:08.308 --> 00:05:10.277 
兩個app可能會
請求同一個URL方案

00:05:10.811 --> 00:05:12.379 
用戶並沒有
真正的好方法

00:05:12.446 --> 00:05:14.615 
表示他們指的是哪個app

00:05:16.183 --> 00:05:19.586 
第二 如果app
沒有安裝 則會回退

00:05:20.220 --> 00:05:24.558 
URL無法打開
app需要自定義代碼

00:05:24.625 --> 00:05:26.326 
才能處理這種
相當常見的情形

00:05:27.060 --> 00:05:30.297 
最後 它們會使得
保護用戶隱私

00:05:30.364 --> 00:05:31.331 
很是困難

00:05:31.999 --> 00:05:34.968 
App需要查明
app是否在設備上安裝

00:05:35.035 --> 00:05:37.504 
才能使用
自定義URL方案

00:05:37.804 --> 00:05:41.074 
這意味着 它們可以
探嗅出用戶是否

00:05:41.141 --> 00:05:44.444 
安裝了約會app或銀行app
或者是政治相關的app

00:05:44.811 --> 00:05:46.480 
這屬於個人信息

00:05:46.547 --> 00:05:48.282 
用戶不願意
對外分享

00:05:48.815 --> 00:05:51.685 
應該有更好的辦法
但是這所謂更好的辦法

00:05:51.752 --> 00:05:52.920 
應該是什麼樣子呢？

00:05:53.921 --> 00:05:57.558 
顯然 它應該和
使用URL方案

00:05:57.624 --> 00:05:59.893 
一樣簡單
我們現在還會

00:05:59.960 --> 00:06:01.695 
介紹一種URL

00:06:02.396 --> 00:06:04.965 
它必須具有 
可證實的所有權

00:06:05.399 --> 00:06:07.367 
URL應該在
正確的app中打開

00:06:08.502 --> 00:06:11.004 
在app和URL之間
應該存在強大的

00:06:11.071 --> 00:06:13.140 
雙向聯繫

00:06:13.707 --> 00:06:17.845 
如果app並未安裝 
它必須有能力

00:06:17.911 --> 00:06:19.379 
優雅地回退 

00:06:19.780 --> 00:06:22.616 
當用戶輕點URL時
它還應該可以工作

00:06:22.683 --> 00:06:25.886 
Safari和網頁瀏覽器
一般而言是顯示

00:06:25.953 --> 00:06:28.388 
富內容的不錯方法
而且在各種平臺上

00:06:28.455 --> 00:06:30.891 
都有顯示
因此我們將確保

00:06:30.958 --> 00:06:33.227 
這些鏈接可以
在網頁瀏覽器中打開

00:06:37.297 --> 00:06:41.101 
它絕對必須保護
用戶的隱私

00:06:42.002 --> 00:06:45.038 
當我在自己的設備上
運行app時 它無權

00:06:45.105 --> 00:06:47.074 
知道 我已經
安裝了你的app

00:06:47.674 --> 00:06:49.843 
當然 鏈接...
不好意思 當然

00:06:49.910 --> 00:06:52.813 
你輕擊的鏈接
是在你和

00:06:52.880 --> 00:06:54.348 
設備之間的事情

00:06:54.414 --> 00:06:56.884 
沒有必要牽扯
第三方進來

00:06:57.651 --> 00:07:01.221 
正如康拉德給大家看的
網頁URL可以滿足

00:07:01.388 --> 00:07:02.990 
上述所有標準 是理想的解決方案

00:07:03.724 --> 00:07:05.893 
你知道
它們何時打開

00:07:05.959 --> 00:07:09.129 
它們在哪裏幾乎都可行
當輕擊它時 沒有第三方

00:07:09.196 --> 00:07:10.564 
會牽扯其中

00:07:11.265 --> 00:07:15.869 
現在我們確定
將網頁URL作爲

00:07:16.136 --> 00:07:17.938 
我們的解決方案
我們再把它細分

00:07:18.372 --> 00:07:21.074 
我知道大家都見過
URL 但是如果來看

00:07:21.141 --> 00:07:23.777 
URL的組件
我們會對這些

00:07:23.944 --> 00:07:25.579 
鏈接怎樣發揮作用
有更好的理解

00:07:25.913 --> 00:07:29.883 
這裏是個非常
正常的網頁URL

00:07:30.250 --> 00:07:31.518 
如果你感到好奇

00:07:31.585 --> 00:07:34.021 
這是去年的WWDC
主題演講視頻的鏈接

00:07:34.855 --> 00:07:37.658 
這並非是我們
爲此目的或

00:07:37.724 --> 00:07:39.259 
僅爲此app
而新生成的URL

00:07:39.593 --> 00:07:41.595 
它是現成的
今天就可以在

00:07:41.662 --> 00:07:45.599 
Apple開發人員連接
網站上看到

00:07:45.866 --> 00:07:49.536 
如果在Safari打開
我希望看到的是

00:07:49.603 --> 00:07:53.540 
你所希望的內容
視頻和相關信息

00:07:53.607 --> 00:07:57.244 
如果... 我也希望
如果是在Mac或其他

00:07:57.311 --> 00:08:00.347 
平臺 我也看到的是
完全一樣的內容 是通用的 

00:08:01.081 --> 00:08:04.418 
多虧這個通用鏈接
這個鏈接將在

00:08:04.484 --> 00:08:07.788 
WWDC app中打開
無需牽扯到網頁瀏覽器

00:08:07.855 --> 00:08:09.756 
爲了這可以發揮作用

00:08:09.823 --> 00:08:11.592 
iOS需要找到
幾項內容

00:08:12.759 --> 00:08:14.494 
首先 我們要看
這個方案

00:08:14.828 --> 00:08:18.432 
我們支持HTTPS
和HTTP URL

00:08:18.866 --> 00:08:21.835 
接下來是域名
或主機名

00:08:22.469 --> 00:08:25.072 
通過使用SSL證書 
簽署存儲在安全

00:08:25.572 --> 00:08:28.976 
網絡服務器的文件 
域名與app

00:08:29.042 --> 00:08:30.177 
安全關聯

00:08:30.244 --> 00:08:34.615 
稍後 這方面
還有更多詳情

00:08:34.681 --> 00:08:37.183 
我們分析過
方案和域名後

00:08:37.251 --> 00:08:38.251 
我們再來看路徑

00:08:39.419 --> 00:08:41.455 
路徑可以是
完全匹配

00:08:41.755 --> 00:08:43.423 
或者是和前綴匹配

00:08:43.924 --> 00:08:47.895 
在兩種情況下
都要規定匹配 不好意思

00:08:47.961 --> 00:08:51.131 
你需要規定匹配
而且要控制情形

00:08:51.765 --> 00:08:56.637 
如果你網站的內容
無法在app上

00:08:56.703 --> 00:08:58.505 
顯示時 這會
非常有用

00:09:01.808 --> 00:09:04.611 
如果URL並不匹配
可以在Safari打開

00:09:04.678 --> 00:09:06.079 
和其他任何鏈接一樣

00:09:08.282 --> 00:09:12.319 
如果我們匹配URL 則需要
不好意思 如果匹配URL

00:09:12.386 --> 00:09:15.088 
併發送給你 
你可以使用NS URL組件

00:09:15.155 --> 00:09:17.024 
來做細分 
並獲得URL上的

00:09:17.090 --> 00:09:18.592 
有用信息

00:09:19.359 --> 00:09:22.062 
我特別喜歡使用NS URL
Query Item

00:09:22.329 --> 00:09:25.365 
因爲這可以讓
訪問查詢組件

00:09:25.432 --> 00:09:26.834 
變得非常簡單

00:09:29.503 --> 00:09:33.674 
通用鏈接是指
讓app而不是Safari

00:09:33.740 --> 00:09:37.911 
來處理網站上的鏈接
目的是爲了打開app

00:09:38.078 --> 00:09:41.315 
當用戶輕點網站鏈接時
iOS需要了解

00:09:41.481 --> 00:09:43.016 
app應該
打開該鏈接

00:09:43.984 --> 00:09:46.887 
app必須請求
它可以從網站處理鏈接

00:09:47.354 --> 00:09:50.557 
iOS隨後可以聯繫 
網站 證實網站

00:09:50.624 --> 00:09:53.193 
瞭解app
願意被它

00:09:53.260 --> 00:09:54.628 
來代表

00:09:56.396 --> 00:09:57.531 
我們將服務器準備好

00:09:58.131 --> 00:09:59.633 
全程包括
四個步驟

00:10:01.502 --> 00:10:04.071 
第一步是
生成特殊文件

00:10:04.137 --> 00:10:06.240 
Apple-app-site-
association文件

00:10:06.306 --> 00:10:08.375 
iOS可以從網站
服務器下載

00:10:08.942 --> 00:10:11.879 
文件包括特殊
結構的JSON數據

00:10:14.314 --> 00:10:16.183 
如果去年你從Web
用過Handoff

00:10:16.250 --> 00:10:19.052 
或Shared Web
Credentials這會非常相似

00:10:20.087 --> 00:10:22.422 
頂層密鑰是
applinks 這是網站

00:10:22.489 --> 00:10:25.993 
證書的兄弟類
或活動延續

00:10:26.059 --> 00:10:28.896 
若你有
二者之一的話

00:10:28.962 --> 00:10:31.565 
app祕鑰非常重要
應該和作爲值的

00:10:31.632 --> 00:10:33.567 
空數組
一同顯示

00:10:35.736 --> 00:10:37.871 
在新的詳細祕鑰下
你會看到字典

00:10:38.572 --> 00:10:41.475 
字典祕鑰是
應用的識別符

00:10:41.742 --> 00:10:43.877 
其中包括
團隊ID 這可以從

00:10:43.944 --> 00:10:46.246 
開發人員門戶網站獲得
後面跟着句號

00:10:46.580 --> 00:10:48.282 
後面還有
束識別符

00:10:48.849 --> 00:10:51.451 
如果有不止一個
app 可以用不同的

00:10:51.518 --> 00:10:52.686 
祕鑰 規定每個app

00:10:55.322 --> 00:10:56.990 
路徑數組告知
我們 網站的哪部分

00:10:57.057 --> 00:10:59.193 
可以通過
app支持

00:10:59.893 --> 00:11:02.396 
如果app中可以支持
整個網站

00:11:02.663 --> 00:11:04.831 
你只需要
包括一個星號

00:11:04.898 --> 00:11:06.033 
就像這裏這樣

00:11:06.099 --> 00:11:08.669 
但是在第一天

00:11:08.735 --> 00:11:11.672 
很可能app
不會支持網站的任何一個網頁

00:11:12.406 --> 00:11:14.508 
我們已經讓你
有能力規定

00:11:14.575 --> 00:11:16.043 
它可以處理哪些網頁

00:11:17.110 --> 00:11:19.813 
如你所見 我已經
爲數組增加了兩個路徑

00:11:20.180 --> 00:11:21.515 
第一個是完全匹配

00:11:21.982 --> 00:11:24.451 
如果用戶輕點連接
可以直接前往路徑

00:11:24.651 --> 00:11:26.053 
會在app中打開

00:11:27.354 --> 00:11:29.790 
如果網站的全部內容
都得到app的支持

00:11:29.857 --> 00:11:34.194 
可以使用路徑前綴
例如本數組的第二輸入

00:11:34.261 --> 00:11:36.263 
來規定

00:11:36.330 --> 00:11:37.931 
該部分將在
app打開

00:11:38.332 --> 00:11:40.534 
注意結尾的星號
它告知我們

00:11:40.601 --> 00:11:41.869 
這是路徑前綴

00:11:42.736 --> 00:11:45.272 
需要注意
這些路徑要分大小寫

00:11:45.572 --> 00:11:47.975 
其他URL組件
如查詢或

00:11:48.041 --> 00:11:51.044 
片段
則不支持

00:11:53.247 --> 00:11:55.849 
第二步是
從認可的證書籤發機構

00:11:55.949 --> 00:11:57.751 
那裏獲得
SSL證書

00:11:58.318 --> 00:12:01.021 
這不是爲了App Store
簽署app所用的

00:12:01.188 --> 00:12:05.058 
那個證書
不是Apple生成的

00:12:05.292 --> 00:12:07.828 
我們建議你使用
HTTPS服務器上用的

00:12:07.895 --> 00:12:10.631 
相同證書
但不做要求

00:12:11.331 --> 00:12:13.600 
如果有不止一個域名
需要在app體現

00:12:13.667 --> 00:12:16.036 
我們建議
考慮獲得

00:12:16.103 --> 00:12:17.171 
通配符證書

00:12:17.804 --> 00:12:19.907 
若要了解證書生成的
更多詳情

00:12:20.107 --> 00:12:21.975 
請聯繫
證書籤發機構

00:12:24.511 --> 00:12:28.182 
第三步是簽署JSON文件
這是你剛通過SSL證書

00:12:28.248 --> 00:12:29.216 
而生成的

00:12:31.251 --> 00:12:32.419 
爲此 
你需要在

00:12:32.486 --> 00:12:36.223 
開發Mac的終端
使用openssl smime

00:12:36.290 --> 00:12:38.058 
命令

00:12:38.692 --> 00:12:40.127 
這兩個文件名
都很重要

00:12:40.561 --> 00:12:43.096 
第一個是你剛生成的
文件名稱

00:12:43.530 --> 00:12:46.366 
是在開發Mac上
未簽署的JSON文件

00:12:46.700 --> 00:12:49.369 
第二個必須和你在這裏
所見到的完全匹配

00:12:49.670 --> 00:12:52.940 
apple-app-
site-association

00:12:55.175 --> 00:12:56.310 
這些是你的私人祕鑰

00:12:56.777 --> 00:12:58.946 
是在證書生成期間
生成的

00:12:59.680 --> 00:13:02.916 
以及證書籤發機構
所提供的證書

00:13:03.083 --> 00:13:05.786 
同樣 這不是
Apple提供的證書

00:13:05.953 --> 00:13:07.621 
也不是App Store的
證書

00:13:07.688 --> 00:13:09.223 
也不是開發人員
ID證書

00:13:10.190 --> 00:13:11.758 
這是需要注意的
最後一點

00:13:11.825 --> 00:13:13.994 
如果你有證書
簽發機構提供的

00:13:14.061 --> 00:13:16.597 
中間證書
在簽署期間

00:13:16.663 --> 00:13:18.065 
也需要包括在內

00:13:20.367 --> 00:13:21.735 
第四步也就是最後一步

00:13:22.236 --> 00:13:23.670 
你現在有了
簽署的JSON文件

00:13:23.770 --> 00:13:25.272 
需要上傳至
網站服務器

00:13:25.772 --> 00:13:27.307 
這會到達 
服務器的根目錄

00:13:27.374 --> 00:13:28.208 
例如

00:13:28.876 --> 00:13:30.777 
www.example.com

00:13:30.844 --> 00:13:33.580 
/ apple-app
-site-association

00:13:34.681 --> 00:13:36.216 
需要注意
域名支持的每個app

00:13:36.283 --> 00:13:39.553 
也許需要不同的
JSON文件 

00:13:39.620 --> 00:13:41.355 
這是爲域名妥善
簽署過的

00:13:41.989 --> 00:13:43.824 
例如example.com

00:13:43.891 --> 00:13:45.626 
和<u>www.example.com</u>

00:13:45.692 --> 00:13:47.160 
<u>&lt;http://www.</u>
<u>example.com&gt;</u>是不同的

00:13:48.662 --> 00:13:51.231 
我們在iOS 8中
引入了這個功能性

00:13:51.465 --> 00:13:53.867 
支持兩個功能：Handoff
from the Web

00:13:54.234 --> 00:13:55.536 
和Shared Web
 Credentials

00:13:56.436 --> 00:13:59.439 
在iOS 9中 我們
添加了通用鏈接的支持

00:13:59.706 --> 00:14:01.975 
我們需要讓它
變得儘量簡單

00:14:02.042 --> 00:14:05.479 
便於儘快在app中
採用通用鏈接

00:14:06.246 --> 00:14:10.918 
不好意思 是從
iOS 9種子2開始

00:14:11.652 --> 00:14:13.554 
我們不再要求
大家簽署

00:14:13.620 --> 00:14:16.056 
Apple-app-sit
e-association文件

00:14:16.123 --> 00:14:18.425 
只要上傳未簽署的
JSON 謝謝

00:14:22.329 --> 00:14:23.197 
謝謝

00:14:23.263 --> 00:14:26.700 
只要上傳未簽署的JSON文件
加上相同的文件名

00:14:26.767 --> 00:14:29.369 
apple-app
-site-association

00:14:29.436 --> 00:14:31.805 
到HTTPS服務器

00:14:32.172 --> 00:14:33.941 
iOS就會處理
其餘工作

00:14:34.675 --> 00:14:37.010 
如果需要支持iOS 8的
向後兼容 

00:14:37.077 --> 00:14:39.813 
注意簽名要求
還依然有效

00:14:40.147 --> 00:14:41.515 
如果是從 iOS 9開始

00:14:41.782 --> 00:14:43.150 
則無需
填寫文件

00:14:43.217 --> 00:14:48.388 
我們來談談
應用的運用

00:14:48.889 --> 00:14:50.824 
需要調整
應用委託

00:14:50.891 --> 00:14:52.759 
需要用到
授權

00:14:52.826 --> 00:14:56.396 
我給大家看看怎麼做

00:14:56.563 --> 00:14:58.532 
首先是
應用委託

00:14:59.132 --> 00:15:01.635 
如果去年用過Handoff 
這會非常相似

00:15:03.170 --> 00:15:05.239 
當用戶活動 
應用委託

00:15:05.572 --> 00:15:08.242 
這個方法會發送到
應用委託

00:15:10.410 --> 00:15:12.446 
用戶活動對象
不好意思

00:15:12.513 --> 00:15:15.249 
用戶活動對象
有着頁面URL屬性

00:15:15.716 --> 00:15:17.518 
在這一功能的情況下

00:15:17.584 --> 00:15:20.821 
會一直是HTTPS
或HTTPURL

00:15:21.255 --> 00:15:23.390 
這一功能永遠都不會爲零值

00:15:25.325 --> 00:15:28.262 
在通用鏈接的情況下
活動類型

00:15:28.328 --> 00:15:29.630 
一直都是

00:15:29.696 --> 00:15:32.099 
NS User Activity
Type Browsing Web

00:15:33.166 --> 00:15:36.270 
一旦確認了
活動類型符合你的預期

00:15:37.504 --> 00:15:39.540 
就可以
通過NSURLComponent類

00:15:39.606 --> 00:15:43.177 
從網頁URL
細分URL

00:15:44.311 --> 00:15:46.713 
與自定義URL方案相似
URL可能會

00:15:46.780 --> 00:15:49.550 
不代表app中的
任何內容

00:15:49.616 --> 00:15:53.187 
或代表過時
或變形的內容

00:15:53.787 --> 00:15:56.957 
如果出現這樣的情況
你應該查明並優雅地失敗

00:15:57.057 --> 00:15:59.893 
現在 在這裏優雅
根據各app的情況

00:16:00.327 --> 00:16:02.996 
也許需要
向相關使用顯示提醒

00:16:03.363 --> 00:16:06.333 
解釋出了什麼差錯
或者在Safari

00:16:06.500 --> 00:16:09.770 
打開鏈接效果會更好
這可以從app來實現

00:16:09.837 --> 00:16:12.406 
調用UI Application
Open URL即可

00:16:12.940 --> 00:16:14.775 
從中拿走的
最重要的是

00:16:14.975 --> 00:16:16.810 
不會讓用戶
盯着空白的

00:16:16.877 --> 00:16:18.278 
View Controller

00:16:20.848 --> 00:16:24.084 
一旦應用委託
得到升級 

00:16:24.151 --> 00:16:25.519 
你需要更新
app的授權

00:16:26.153 --> 00:16:27.554 
使用XCode會很容易

00:16:28.088 --> 00:16:30.090 
導航至
項目設置

00:16:30.190 --> 00:16:31.625 
再到配置
不好意思

00:16:31.692 --> 00:16:35.662 
功能選項卡
並選擇相關域名

00:16:37.097 --> 00:16:39.199 
你需要添加
app支持的

00:16:39.266 --> 00:16:42.402 
每個域名的輸入
app鏈接 後面加上冒號

00:16:42.736 --> 00:16:43.871 
再加域名名稱

00:16:44.238 --> 00:16:45.806 
同樣 app支持的

00:16:45.873 --> 00:16:48.775 
每個域名在這裏需要單獨的輸入
這些都很清楚

00:16:49.209 --> 00:16:52.045 
Example.com和
www.example.com

00:16:52.112 --> 00:16:54.114 
需要不同的輸入
正如大家所見

00:16:56.583 --> 00:16:57.751 
我給大家看看
這些怎樣

00:16:57.818 --> 00:16:58.852 
才能很快都實現

00:16:59.152 --> 00:17:01.755 
但是 首先我想
回顧兩個最佳實踐

00:17:03.223 --> 00:17:05.492 
因爲所有內容是
來自app以外

00:17:05.893 --> 00:17:08.529 
數據可能會變形
你可能會需要驗證

00:17:09.963 --> 00:17:12.199 
如果是這樣 這並非是說
你犯了錯

00:17:12.598 --> 00:17:14.167 
而是說
這種情況發生時

00:17:14.233 --> 00:17:16.136 
你需要優雅地
失敗

00:17:17.971 --> 00:17:20.840 
一旦在處理URL
你需要牢記

00:17:20.907 --> 00:17:23.911 
HTTP在iOS 9上做出警告

00:17:24.344 --> 00:17:25.913 
這是爲了用戶安全

00:17:26.079 --> 00:17:27.214 
和隱私的考慮

00:17:27.281 --> 00:17:29.483 
例如 你傳遞了使用數據

00:17:29.550 --> 00:17:30.884 
NSURLSession

00:17:30.951 --> 00:17:34.021 
就應該一直使用HTTPS

00:17:35.122 --> 00:17:37.824 
如果需要在app使用
未加密的HTTP

00:17:38.525 --> 00:17:40.494 
則要回顧第711號講座

00:17:40.994 --> 00:17:42.930 
《網絡互聯
NSURLSession》

00:17:43.030 --> 00:17:45.432 
其中涉及重要的
網絡互聯新技術

00:17:45.666 --> 00:17:47.701 
App Transport 
Security

00:17:49.736 --> 00:17:52.372 
我們來看
這些怎樣在XCode中使用

00:17:52.940 --> 00:17:53.874 
我會爲大家展示

00:17:53.941 --> 00:17:55.309 
來自WWDC app的代碼

00:17:55.375 --> 00:17:57.244 
這在App Store中可以獲得

00:18:01.415 --> 00:18:03.050 
這裏是

00:18:03.116 --> 00:18:04.952 
WWDC項目

00:18:05.018 --> 00:18:07.054 
我創建一個新的
擴展 其中會有

00:18:07.120 --> 00:18:08.956 
我們今天看到的
代碼

00:18:09.323 --> 00:18:11.425 
這個擴展是在
應用委託類

00:18:11.491 --> 00:18:12.392 
我首先要做的是

00:18:12.459 --> 00:18:15.796 
添加我們探討過的應用
委託方法

00:18:16.496 --> 00:18:17.331 
同樣

00:18:17.531 --> 00:18:20.167 
如果去年用過
Handoff 這裏是

00:18:20.234 --> 00:18:21.268 
同樣的委託方法

00:18:21.768 --> 00:18:24.471 
你需要加以擴展
來支持這個新功能

00:18:25.372 --> 00:18:27.741 
我們感興趣的
參數是

00:18:27.808 --> 00:18:31.011 
用戶活動參數
其中包括用戶

00:18:31.078 --> 00:18:32.346 
所作所爲的信息

00:18:32.412 --> 00:18:35.215 
在本例中
是從網站導航

00:18:37.718 --> 00:18:38.852 
我們還感興趣

00:18:38.919 --> 00:18:41.421 
活動類型
和網頁URL

00:18:42.322 --> 00:18:45.425 
出於我們的目的
活動類型一直是NSUser 

00:18:45.492 --> 00:18:46.760 
活動類型BrowsingWeb

00:18:46.994 --> 00:18:49.730 
但是 如果app支持
來自其他來源的

00:18:49.796 --> 00:18:52.999 
用戶活動 例如
Handoff 那麼你就要

00:18:53.066 --> 00:18:54.968 
檢查我所做的
活動類型

00:18:56.203 --> 00:18:58.906 
因爲它是NSUser
活動類型BrowsingWeb

00:18:58.972 --> 00:19:00.707 
我知道會有網頁URL
而且不是零值

00:19:00.974 --> 00:19:03.944 
因此我使用
網頁零值

00:19:04.111 --> 00:19:07.814 
屬性的顯性打開
來從中獲取URL

00:19:07.881 --> 00:19:10.684 
我會把它發送給函數
顯示URL

00:19:11.018 --> 00:19:13.620 
它負責細分
URL 並把它

00:19:14.087 --> 00:19:16.757 
交付給
用戶界面

00:19:16.823 --> 00:19:17.958 
這樣用戶就可以看到

00:19:20.194 --> 00:19:22.129 
這個函數的簽名
相當簡單

00:19:22.196 --> 00:19:25.132 
它將單一的URL
作爲輸入 並返回Boolean

00:19:25.199 --> 00:19:27.935 
表示我們是否
可以處理URL

00:19:28.535 --> 00:19:30.838 
現在方法的主體
有些更爲複雜

00:19:30.904 --> 00:19:32.639 
但是我會帶大家
逐行來看

00:19:33.540 --> 00:19:36.944 
首先我們要做的是創建NSURL
Components實例

00:19:37.578 --> 00:19:40.881 
我說過 這個類 
會細分URL

00:19:41.014 --> 00:19:43.984 
並允許你訪問
其中的各部分

00:19:44.384 --> 00:19:46.486 
而無需你搭建
自己的解析器

00:19:47.955 --> 00:19:51.024 
一旦有了這個對象
我們會從中

00:19:51.091 --> 00:19:52.192 
提取感興趣的部分組件

00:19:52.960 --> 00:19:55.963 
對於WWDC app
我們感興趣的是

00:19:56.330 --> 00:19:57.431 
主機和路徑組件

00:19:58.465 --> 00:20:00.601 
現在WWDC app

00:20:00.667 --> 00:20:02.135 
可以
處理URL來自

00:20:02.202 --> 00:20:03.370 
不止一個域名的情況

00:20:03.437 --> 00:20:05.038 
所以我要檢查域名

00:20:05.105 --> 00:20:06.473 
確保它是我所預期的

00:20:07.107 --> 00:20:08.542 
在這裏 我有個
開關語句

00:20:09.142 --> 00:20:11.678 
是在developer.apple
.com介紹的

00:20:11.745 --> 00:20:14.114 
康拉德之前給大家
看過這個URL 不好意思

00:20:14.181 --> 00:20:15.282 
URL的主機名稱

00:20:16.617 --> 00:20:18.819 
一旦進行了匹配
我希望匹配路徑

00:20:19.953 --> 00:20:22.623 
我會用開關語句
這在Swift中非常強大

00:20:22.956 --> 00:20:25.192 
立刻蒐集所有的組件
並在一個代碼行中

00:20:25.259 --> 00:20:29.229 
進行比較
s/videos/WWDC

00:20:29.463 --> 00:20:30.998 
有些可以是
也可以不是一年

00:20:32.432 --> 00:20:34.368 
我希望來
看看值 

00:20:34.434 --> 00:20:36.470 
現在是個字符串
並把它改爲Int

00:20:36.537 --> 00:20:42.075 
我把它轉換爲Int
初始程序 不好意思

00:20:42.943 --> 00:20:44.545 
我還會蒐集
講座序號

00:20:44.611 --> 00:20:46.613 
在本例中
是第509號講座

00:20:46.680 --> 00:20:48.448 
在康拉德給大家
展示的例子中

00:20:48.515 --> 00:20:50.951 
是第101號講座

00:20:51.018 --> 00:20:53.253 
我馬上給大家看
Find Session方法

00:20:54.688 --> 00:20:56.089 
如果組件
可以匹配

00:20:56.356 --> 00:20:58.025 
我就會將它
呈現給用戶

00:20:58.091 --> 00:21:01.628 
但是我希望
先確認輸入

00:21:02.963 --> 00:21:03.997 
因爲可能會是

00:21:04.698 --> 00:21:07.234 
它不在任何合理範圍

00:21:07.301 --> 00:21:09.536 
例如 年份是在
Apple成立之前

00:21:09.603 --> 00:21:11.071 
或講座序列號
是數百萬

00:21:12.206 --> 00:21:13.540 
我用講座的年份

00:21:13.740 --> 00:21:15.375 
在兩個範圍中
進行比較

00:21:15.442 --> 00:21:17.845 
2011到2015
是年份

00:21:18.412 --> 00:21:20.714 
100到10000
是講座序號

00:21:20.781 --> 00:21:22.482 
如果是在這兩個範圍內
則看似有效

00:21:22.549 --> 00:21:24.918 
可以向用戶
進行呈現

00:21:25.352 --> 00:21:27.020 
我們繼續來呈現

00:21:29.289 --> 00:21:32.492 
我提到這個Find 
Session方法 馬上就給大家看

00:21:33.393 --> 00:21:34.228 
在這裏

00:21:34.661 --> 00:21:37.030 
這是專爲app準備的

00:21:37.097 --> 00:21:39.166 
大家不大可能
拿到完全相同的代碼

00:21:39.233 --> 00:21:41.034 
我也不會
講太多細節

00:21:41.335 --> 00:21:44.371 
但是思路是
提供的數據可能是

00:21:44.438 --> 00:21:47.407 
來自不止一種來源
我們希望檢查所有這些內容

00:21:47.608 --> 00:21:50.043 
首先我們要看
這個片段 是2014年 

00:21:50.110 --> 00:21:53.580 
和之前的URL的情況
包括講座ID

00:21:54.181 --> 00:21:57.851 
如果不包含
講座ID 我們就看看

00:21:58.385 --> 00:21:59.253 
查詢

00:21:59.620 --> 00:22:02.389 
從NSURL查詢項
分離出的查詢

00:22:02.789 --> 00:22:06.260 
在本例中 查詢項的屬性
已經爲我們填好了

00:22:07.394 --> 00:22:08.996 
我們再重複一遍
可以發現

00:22:09.062 --> 00:22:10.931 
匹配的ID
或實例

00:22:10.998 --> 00:22:13.600 
任何一種都會
包括講座序號

00:22:16.336 --> 00:22:17.871 
現在 代碼基本
已經就緒

00:22:17.971 --> 00:22:19.072 
不過 有些內容缺失了

00:22:19.673 --> 00:22:21.108 
這裏有很多
返回錯誤

00:22:21.175 --> 00:22:24.311 
還有很多
無法處理URL的情況

00:22:25.245 --> 00:22:28.215 
同樣 這樣是可以的
因爲我們會時常

00:22:28.282 --> 00:22:29.349 
收到無效輸入

00:22:29.416 --> 00:22:31.919 
但是在應用委託中

00:22:32.152 --> 00:22:33.887 
我不會對返回值
做任何處理

00:22:34.321 --> 00:22:36.690 
如果獲得明顯
無效的URL

00:22:37.090 --> 00:22:38.525 
用戶則什麼
都看不見

00:22:38.892 --> 00:22:41.628 
打開WWDC Apple 
會出現空白的

00:22:41.695 --> 00:22:43.197 
View Controller

00:22:43.263 --> 00:22:45.232 
這是我希望
完全避免的情況

00:22:45.766 --> 00:22:47.334 
我們需要
優雅地失敗

00:22:47.401 --> 00:22:49.136 
這可以非常
非常簡單地實現

00:22:49.837 --> 00:22:52.573 
在本例中 如果出現
URL返回錯誤

00:22:52.840 --> 00:22:54.975 
我會瞭解 我並未 
給用戶呈現任何內容

00:22:55.309 --> 00:22:57.544 
並通過UI
ApplicationpenURL

00:22:57.611 --> 00:22:59.580 
將URL傳遞
給Safari

00:23:00.848 --> 00:23:02.983 
所有這些代碼改變
你都需要採用

00:23:03.217 --> 00:23:05.853 
如果你已經獲得
自定義URL方案的代碼

00:23:05.986 --> 00:23:07.754 
很可能它會與
我們這裏的情況

00:23:07.821 --> 00:23:08.655 
非常相似

00:23:09.723 --> 00:23:13.293 
現在我就將向大家
展示添加代碼前後

00:23:13.460 --> 00:23:15.796 
app會是什麼樣子
但是在此之前

00:23:16.129 --> 00:23:17.264 
我需要加上授權

00:23:17.898 --> 00:23:20.067 
因此我進入Project
 Setting

00:23:20.133 --> 00:23:21.835 
選擇Capabilities選項卡

00:23:22.302 --> 00:23:24.238 
並選擇Associated 
Domain

00:23:25.806 --> 00:23:27.407 
我還會在這裏加上
一個輸入

00:23:27.541 --> 00:23:29.643 
因爲我們並非是
只用到一個域名

00:23:30.010 --> 00:23:33.447 
不過同樣 如果不只是
一個域名 example.com

00:23:33.514 --> 00:23:36.850 
www.example.com
它們需要在這個

00:23:36.917 --> 00:23:37.784 
授權中 分別輸入

00:23:38.352 --> 00:23:40.320 
在本例中 我需要
applinks:

00:23:40.554 --> 00:23:43.423 
developer.
apple.com

00:23:44.458 --> 00:23:45.292 
就是這樣

00:23:45.626 --> 00:23:46.994 
我準備在
客戶端繼續

00:23:47.060 --> 00:23:48.996 
那麼我會讓大家
看看在加上這個之前

00:23:49.062 --> 00:23:50.297 
app是什麼樣子

00:23:51.164 --> 00:23:53.500 
這裏是我的iPad
這是我們加上之前

00:23:53.567 --> 00:23:57.371 
安裝的WWDC app
拷貝 不好意思

00:23:57.437 --> 00:24:00.274 
是在我們加上
通用鏈接之前

00:24:01.308 --> 00:24:03.110 
我將前往
同樣的文本信息 不好意思

00:24:03.177 --> 00:24:05.279 
是我之前發給
康拉德的同樣的iMessage 

00:24:06.747 --> 00:24:08.982 
信息內容完全相同
可是當我點擊它的時候

00:24:09.583 --> 00:24:11.451 
因爲我沒有使用
通用鏈接

00:24:12.219 --> 00:24:13.587 
它只在Safari中打開

00:24:14.521 --> 00:24:18.058 
Safari是個不錯的app
可以顯示很棒的內容

00:24:18.125 --> 00:24:20.861 
特別是 它並未 
提供可以從app

00:24:20.928 --> 00:24:21.862 
獲得的所有選項

00:24:22.296 --> 00:24:25.465 
我可以在app和Safari上
觀看視頻

00:24:25.532 --> 00:24:28.869 
我還可以從app
提供反饋 使之成爲 

00:24:28.936 --> 00:24:31.438 
以後可作爲收藏以後觀看
我甚至可以下載後 脫機觀看

00:24:31.839 --> 00:24:35.075 
正如我會給大家展示的那樣 
在app中 現在有了這個

00:24:35.175 --> 00:24:37.244 
在app中 現在大家
手中有了這個

00:24:37.778 --> 00:24:39.813 
看上去有點
像是這個樣子

00:24:40.514 --> 00:24:43.584 
這還是我之前給
康拉德發的URL

00:24:43.650 --> 00:24:47.387 
和之前一樣 我輕點一下
打開主題

00:24:47.788 --> 00:24:49.022 
並可以把它
加入收藏

00:24:49.356 --> 00:24:51.558 
我可以觀看視頻
下載 等等

00:24:52.359 --> 00:24:54.761 
基本上 我們要做的
所有內容就是這些

00:24:58.365 --> 00:24:59.199 
謝謝

00:25:04.071 --> 00:25:06.773 
我把遙控交給
康拉德之前

00:25:06.974 --> 00:25:09.710 
要非常感謝大家能來
而且我非常希望

00:25:09.776 --> 00:25:11.345 
看到大家能用
iOS 9中的

00:25:11.411 --> 00:25:13.714 
通用鏈接
能有所創造

00:25:13.914 --> 00:25:14.781 
謝謝

00:25:20.320 --> 00:25:21.188 
非常棒

00:25:22.022 --> 00:25:22.956 
謝謝 喬納森

00:25:24.558 --> 00:25:27.794 
通過通用鏈接

00:25:28.328 --> 00:25:29.263 
你可以爲所有

00:25:29.329 --> 00:25:32.766 
用戶提供可能實現的
最佳用戶體驗

00:25:33.934 --> 00:25:37.437 
用戶如果在你的iPhone
或iPad上安裝了你的app

00:25:38.272 --> 00:25:39.606 
連在你網站上的鏈接

00:25:39.673 --> 00:25:42.109 
就會在app立刻打開

00:25:42.376 --> 00:25:45.712 
而不需要通過
Safari中間過渡

00:25:47.881 --> 00:25:51.051 
你不再需要在自己的網站上
編寫JavaScript 

00:25:51.451 --> 00:25:53.453 
來檢查是否安裝了
你的app

00:25:53.520 --> 00:25:56.323 
或是試圖去檢查
是否安裝 

00:25:56.390 --> 00:25:58.292 
再代替用戶安裝app

00:26:00.727 --> 00:26:03.030 
如果用戶並未安裝
你的app

00:26:03.197 --> 00:26:05.399 
你的鏈接也仍可以
在Safari無縫打開

00:26:07.634 --> 00:26:09.002 
出於同樣原因

00:26:09.236 --> 00:26:13.006 
你的鏈接在Mac

00:26:13.073 --> 00:26:14.575 
甚至其他平臺上
也會依然有效

00:26:16.310 --> 00:26:19.813 
因爲這些都是在
用戶設備上本地操作

00:26:20.080 --> 00:26:22.249 
就不會浪費時間
前往用戶

00:26:22.316 --> 00:26:23.550 
網絡服務器

00:26:24.418 --> 00:26:25.853 
或是你的網絡服務器

00:26:26.920 --> 00:26:31.291 
當然 這也意味着
Apple或其他

00:26:31.358 --> 00:26:34.094 
第三方都無法跟蹤
用戶在做什麼

00:26:37.431 --> 00:26:41.435 
我們今天
講了一些 

00:26:41.502 --> 00:26:45.272 
談到如果沒有
安裝你的app 

00:26:45.539 --> 00:26:47.107 
這些鏈接怎樣將用戶
帶到你的網站

00:26:47.908 --> 00:26:50.077 
如果是這樣 許多人
可能會希望

00:26:50.143 --> 00:26:53.313 
幫助用戶發現
並安裝你的app

00:26:53.680 --> 00:26:56.517 
ILS有一項技術 
可以幫上忙

00:26:57.317 --> 00:26:59.286 
這就是
Smart App Banner

00:27:00.354 --> 00:27:02.256 
我們用幾分鐘時間
來談談

00:27:02.322 --> 00:27:05.692 
Smart App Banner
這是關於使用它們

00:27:05.759 --> 00:27:06.793 
將花費多長時間

00:27:08.362 --> 00:27:09.997 
那麼Smart App
 Banner是什麼？ 

00:27:10.297 --> 00:27:12.366 
這是無侵入的UI元素

00:27:12.799 --> 00:27:14.568 
可以幫助將用戶
帶到app

00:27:15.035 --> 00:27:16.870 
可以在iOS上
通過Safari 

00:27:16.937 --> 00:27:18.338 
自動呈現

00:27:20.507 --> 00:27:22.643 
如果用戶並未安裝
你的app

00:27:23.010 --> 00:27:24.311 
廣告條則會 

00:27:24.378 --> 00:27:27.214 
啓動App Store
以便用戶下載

00:27:27.981 --> 00:27:30.584 
如果用戶已經安裝了你的app

00:27:30.651 --> 00:27:31.952 
你的app 廣告條則會

00:27:32.019 --> 00:27:33.487 
用戶啓動app

00:27:35.055 --> 00:27:38.292 
Smart App Banner
的添加對你的網站而言微不足道

00:27:39.927 --> 00:27:43.697 
iOS 9 app搜索功能
有項新內容

00:27:44.131 --> 00:27:46.166 
Apple將
Smart App Banner

00:27:46.233 --> 00:27:49.036 
用於幫助索引你的app
及其內容

00:27:49.102 --> 00:27:50.671 
這可以
提高用戶發現

00:27:50.938 --> 00:27:53.440 
並安裝你的
app的可能性

00:27:55.309 --> 00:27:58.512 
現在 有些人也許會用
自定義URL方案

00:27:58.812 --> 00:28:03.817 
讓用戶從網站
進入app

00:28:04.885 --> 00:28:06.753 
這樣也可以

00:28:06.820 --> 00:28:07.921 
但並不推薦這麼做

00:28:08.722 --> 00:28:11.558 
這樣並不會確保
自定義URL方案的

00:28:11.625 --> 00:28:14.361 
用戶體驗在未來
會保持一致

00:28:15.329 --> 00:28:18.165 
Smart App Banner
可提供更好的用戶體驗

00:28:20.300 --> 00:28:22.469 
爲使用Smart App
Banner 你只需要

00:28:22.536 --> 00:28:24.671 
在網站的標頭部分

00:28:24.738 --> 00:28:26.940 
添加一行HTML

00:28:28.509 --> 00:28:30.677 
apple-itunes-app
元標籤

00:28:30.744 --> 00:28:32.412 
會告知Safari 

00:28:32.479 --> 00:28:35.115 
你想要安裝或顯示
Smart App Banner

00:28:37.251 --> 00:28:38.919 
內容屬性必須

00:28:38.986 --> 00:28:40.687 
包括你的app ID 

00:28:41.221 --> 00:28:43.790 
這是用於將用戶
指向正確的app

00:28:44.525 --> 00:28:47.628 
可以通過便捷的iTunes
link maker鏈接生成工具

00:28:47.694 --> 00:28:48.896 
來獲取你的app ID

00:28:50.597 --> 00:28:51.965 
app參數應該包括

00:28:52.032 --> 00:28:56.570 
當前顯示頁面
的URL

00:28:57.371 --> 00:28:58.505 
這其中有兩個原因

00:28:59.106 --> 00:28:59.940 
首先

00:29:00.407 --> 00:29:02.676 
這可以實現
自定義爲用戶

00:29:02.743 --> 00:29:04.244 
顯示的視圖

00:29:06.046 --> 00:29:09.249 
它會被傳遞到
應用開放URL源

00:29:09.316 --> 00:29:10.884 
應用註解方法

00:29:12.119 --> 00:29:13.320 
其二

00:29:13.387 --> 00:29:14.788 
它可以幫助
確保app搜索可以

00:29:14.855 --> 00:29:17.524 
識別出你的站點
不僅僅是

00:29:17.591 --> 00:29:18.792 
着陸頁

00:29:19.026 --> 00:29:20.627 
若要了解這方面的
更多詳情

00:29:21.028 --> 00:29:24.398 
我推薦大家聽聽《介紹搜索API》
那場講座

00:29:24.765 --> 00:29:26.733 
可以找到相關視頻

00:29:26.800 --> 00:29:27.701 
這是昨天的講座

00:29:29.703 --> 00:29:32.306 
最後 要注意Smart
App Banner不會出現在

00:29:32.372 --> 00:29:34.074 
iOS模擬器中 所以一定

00:29:34.141 --> 00:29:35.509 
要在實體設備上
進行測試

00:29:36.977 --> 00:29:39.413 
一旦你使用了
Smart App Banner

00:29:40.080 --> 00:29:43.150 
一旦你的app可以
將鏈接帶入你的網站

00:29:43.617 --> 00:29:46.253 
你就會有非常棒的
機會來簡化

00:29:46.553 --> 00:29:48.322 
你的網站

00:29:49.289 --> 00:29:52.793 
它不再需要
成爲你的app的

00:29:53.093 --> 00:29:53.927 
推廣工具

00:29:54.928 --> 00:29:58.131 
這樣可以專注於
以最好的方式

00:29:58.532 --> 00:30:00.167 
呈現你的內容

00:30:01.168 --> 00:30:03.637 
你不再需要參與

00:30:03.704 --> 00:30:06.106 
顯示廣告條

00:30:06.273 --> 00:30:07.808 
或開場屏

00:30:07.875 --> 00:30:08.976 
或編寫代碼

00:30:09.042 --> 00:30:10.711 
來處理自定義URL方案

00:30:11.545 --> 00:30:16.416 
網站現在使用起來更簡單
編寫也更容易

00:30:19.052 --> 00:30:20.053 
好的

00:30:20.120 --> 00:30:21.889 
我們已經介紹了
如何讓用戶

00:30:21.955 --> 00:30:24.091 
進入你的app

00:30:25.058 --> 00:30:25.893 
一旦如此

00:30:27.227 --> 00:30:29.129 
許多人
就會登錄

00:30:29.196 --> 00:30:31.131 
你的服務
因爲這樣會有幫助

00:30:31.732 --> 00:30:34.101 
如果是這樣
他們也許會看到

00:30:34.334 --> 00:30:35.169 
類似這樣的屏幕

00:30:35.903 --> 00:30:36.737 
登錄表

00:30:37.871 --> 00:30:40.507 
這對用戶而言
會很是沮喪

00:30:41.341 --> 00:30:43.343 
也許他們不記得
憑證

00:30:43.810 --> 00:30:46.046 
即使已經在Safari多次登錄過

00:30:46.113 --> 00:30:47.781 
你的站點也無濟於事

00:30:48.682 --> 00:30:51.818 
他們不想或者不知道
怎麼去查找密碼

00:30:52.553 --> 00:30:54.121 
這時候 用戶可能

00:30:54.488 --> 00:30:56.190 
就會選擇
放棄 離開

00:30:56.924 --> 00:30:59.026 
你的app 也許
甚至會刪掉它

00:31:00.561 --> 00:31:02.196 
但是如果你可以

00:31:02.563 --> 00:31:04.998 
羅列出一系列憑證

00:31:05.232 --> 00:31:06.266 
讓用戶選擇會怎樣呢？

00:31:07.134 --> 00:31:08.302 
可能會變成這個樣子

00:31:09.336 --> 00:31:10.170 
和這個樣子

00:31:11.238 --> 00:31:13.807 
用戶可以輕鬆一點
他們之前

00:31:13.874 --> 00:31:16.777 
保存在Safari中的
密碼

00:31:17.678 --> 00:31:20.914 
具體實現的技術
在iOS 8中有過介紹

00:31:21.315 --> 00:31:23.684 
叫做Shared
Web Credential

00:31:25.953 --> 00:31:28.555 
Shared Web
Credential允許你的app

00:31:28.622 --> 00:31:30.924 
訪問Safari
保存的密碼

00:31:31.391 --> 00:31:34.528 
因此可以
讓用戶後顧無憂

00:31:34.595 --> 00:31:36.430 
不必在不同的
設備的不同

00:31:36.897 --> 00:31:38.966 
上下文中
記住自己的密碼

00:31:40.701 --> 00:31:41.768 
怎麼做到的呢？

00:31:42.703 --> 00:31:46.473 
當Safari在iOS
或OS X上

00:31:46.907 --> 00:31:48.742 
看到有用戶登錄

00:31:48.809 --> 00:31:50.611 
或填寫賬戶
創建表單

00:31:50.878 --> 00:31:52.813 
它可以通過不同
方式幫助用戶

00:31:53.180 --> 00:31:56.750 
具體而言 Safari 
可以在鑰匙串上

00:31:56.817 --> 00:31:58.385 
代替用戶
保存密碼

00:31:59.553 --> 00:32:01.655 
它可以通過
iCloud Keychain

00:32:01.722 --> 00:32:04.191 
在用戶的所有設備中
同步這些密碼

00:32:04.258 --> 00:32:05.626 
那麼 它們可以在用戶的

00:32:05.726 --> 00:32:07.961 
iPhone iPad和Mac上
可供使用

00:32:09.196 --> 00:32:12.933 
它會建議用戶使用
保密性高的密碼

00:32:14.368 --> 00:32:15.235 
當然 在用戶 

00:32:15.502 --> 00:32:18.539 
登錄的時候
也可以代替用戶

00:32:18.839 --> 00:32:20.908 
自動填寫密碼

00:32:21.842 --> 00:32:24.411 
有了Shared Web
Credential API

00:32:24.611 --> 00:32:27.714 
它可以防止用戶
在登錄時

00:32:27.781 --> 00:32:28.749 
卡在app上

00:32:30.884 --> 00:32:32.653 
使用Shared 
Web Credential

00:32:32.719 --> 00:32:33.787 
分爲兩步驟

00:32:34.788 --> 00:32:35.622 
首先

00:32:35.956 --> 00:32:38.492 
你需要
在app和我們談及

00:32:38.559 --> 00:32:40.694 
通用鏈接的
網站之間

00:32:41.061 --> 00:32:44.031 
建立密切聯繫

00:32:44.831 --> 00:32:45.933 
其次

00:32:45.999 --> 00:32:48.035 
你需要
在你的app中使用

00:32:48.101 --> 00:32:49.903 
一個小API 來訪問
憑證本身

00:32:51.939 --> 00:32:55.976 
因爲分享網頁
認證證書允許

00:32:56.043 --> 00:32:58.512 
用戶分享密碼
我們需要確定

00:32:58.579 --> 00:33:01.715 
你可控制自己的
app和網站

00:33:03.150 --> 00:33:05.052 
正如我們允許
允許你的app

00:33:05.252 --> 00:33:07.054 
可以從網站處理鏈接一樣

00:33:08.522 --> 00:33:10.691 
你的服務器告知我們

00:33:10.757 --> 00:33:11.792 
可以信賴你的app

00:33:12.593 --> 00:33:13.861 
只需要簡單添加

00:33:13.927 --> 00:33:16.029 
Apple-app-site
-association文件

00:33:16.096 --> 00:33:17.331 
即可 這點喬納森提到過

00:33:17.898 --> 00:33:18.966 
具體而言

00:33:19.032 --> 00:33:23.670 
你只需要通過
你的網站所信賴的服務器

00:33:25.072 --> 00:33:26.306 
app祕鑰

00:33:28.075 --> 00:33:29.810 
app ID數組
分享憑證

00:33:29.877 --> 00:33:32.346 
在網絡憑證祕鑰下

00:33:32.412 --> 00:33:34.615 
添加頂層字典即可

00:33:37.117 --> 00:33:39.553 
你的app還要告知我們
要信賴你的網站

00:33:40.153 --> 00:33:41.788 
這可以通過添加
一個或多個

00:33:42.322 --> 00:33:44.191 
網絡憑證輸入
到相關

00:33:44.491 --> 00:33:46.627 
域名授權
這個我們

00:33:47.160 --> 00:33:48.262 
剛纔談到過

00:33:48.862 --> 00:33:52.466 
還可以使用
XCode的項目檢測器來實現

00:33:52.666 --> 00:33:54.168 
就像喬納森演示的那樣

00:33:56.703 --> 00:33:57.538 
好的

00:33:57.871 --> 00:34:00.674 
現在 我們來談談
在你的app中使用API

00:34:02.209 --> 00:34:05.312 
在你的app中 
典型的流程是這個樣子

00:34:05.746 --> 00:34:06.580 
首先

00:34:06.647 --> 00:34:09.583 
你的app要
檢查是否在鑰匙串

00:34:09.650 --> 00:34:12.186 
保存了憑證
如果保存了 則用它來登錄

00:34:13.687 --> 00:34:14.855 
如果沒有

00:34:14.922 --> 00:34:17.925 
它會要求
用Safari保存的

00:34:17.991 --> 00:34:20.694 
任何密碼來進入

00:34:21.428 --> 00:34:23.063 
如果可用
它就會使用這些

00:34:23.130 --> 00:34:24.931 
還將在本地保存
然後登錄

00:34:25.966 --> 00:34:27.201 
如果不可用

00:34:27.266 --> 00:34:29.136 
它會顯示內置的登錄UI

00:34:29.369 --> 00:34:32.371 
請求憑證
再按照通常方式來繼續

00:34:34.541 --> 00:34:35.943 
請求Safari的密碼的

00:34:36.210 --> 00:34:39.746 
基本執行
大概是這個樣子

00:34:40.480 --> 00:34:42.149 
主要函數是

00:34:42.216 --> 00:34:44.284 
SecRequestShared
WebCredential

00:34:45.118 --> 00:34:46.719 
它會用到
完成處理器

00:34:48.822 --> 00:34:51.658 
也可以使用域名
和用戶名參數

00:34:53.627 --> 00:34:54.761 
在完成處理器中

00:34:54.962 --> 00:34:56.830 
我們會檢查是否
取回了憑證

00:34:57.698 --> 00:35:00.000 
如果取回 則用它來登錄

00:35:00.834 --> 00:35:01.768 
否則

00:35:01.835 --> 00:35:03.203 
我們將
顯示登錄UI

00:35:04.838 --> 00:35:07.140 
注意在兩種情況下
我們都會分派到主隊列

00:35:07.207 --> 00:35:08.709 
因爲這樣並不會確保

00:35:09.009 --> 00:35:11.879 
完成處理器
會在主隊列調用

00:35:14.047 --> 00:35:17.417 
如果你的app允許用戶
創建賬戶

00:35:17.751 --> 00:35:19.152 
或改變密碼

00:35:19.386 --> 00:35:21.955 
你則的確應該
升級Safari的鑰匙串

00:35:22.155 --> 00:35:23.991 
這樣 下次用戶
登錄你的網站時

00:35:24.057 --> 00:35:26.426 
比如 是通過
Mac來登錄

00:35:26.727 --> 00:35:29.062 
則會自動填入
正確的密碼

00:35:29.363 --> 00:35:30.764 
可以使用這裏顯示的

00:35:30.831 --> 00:35:33.834 
SecAddSharedWeb
Credential函數來實現

00:35:36.937 --> 00:35:38.739 
Shared Web 
Credentials API

00:35:38.805 --> 00:35:40.374 
也會讓你生成安全的密碼

00:35:40.440 --> 00:35:43.310 
所用的算法和Safari
完全一樣

00:35:43.944 --> 00:35:45.946 
通過Sec Create 
Shared Web

00:35:46.013 --> 00:35:48.515 
Credential 
Password函數 如這裏所示

00:35:49.550 --> 00:35:51.952 
還有一些額外的
高級API功能

00:35:52.019 --> 00:35:54.254 
如果大家感興趣
我建議大家

00:35:54.321 --> 00:35:57.291 
可以看看去年的講座《你的App
你的網站和Safari》

00:36:02.329 --> 00:36:04.698 
我們已經介紹了
一些不錯的工具

00:36:05.132 --> 00:36:08.402 
可以爲用戶
在你的app和

00:36:08.468 --> 00:36:10.504 
網站上提供
最佳體驗

00:36:11.605 --> 00:36:12.639 
首先

00:36:12.706 --> 00:36:16.276 
在iOS 9上
只需你做一點工作

00:36:16.944 --> 00:36:19.179 
你的網站的普通鏈接

00:36:19.246 --> 00:36:21.215 
就會變成通用鏈接

00:36:22.349 --> 00:36:25.819 
可以像打開你的網站
一樣 輕鬆打開

00:36:25.886 --> 00:36:26.854 
你的app

00:36:27.921 --> 00:36:31.425 
iOS還可以確保 
用戶可以獲得

00:36:31.491 --> 00:36:34.161 
你的app或網站
可實現的

00:36:34.528 --> 00:36:35.863 
最佳體驗

00:36:36.897 --> 00:36:40.868 
使用自定義
URL帶用戶進入

00:36:40.934 --> 00:36:42.870 
你的app的時代已經過去了

00:36:45.305 --> 00:36:46.139 
接下來

00:36:46.874 --> 00:36:49.009 
你可以使用
Smart App Banner

00:36:49.409 --> 00:36:52.279 
可以讓用戶首次
來到你的網站時

00:36:52.513 --> 00:36:53.847 
幫他們找到
你的app

00:36:54.648 --> 00:36:55.782 
在時候的訪問中

00:36:56.116 --> 00:36:58.919 
它們會重新引導
用戶進入你的app

00:36:59.319 --> 00:37:02.089 
它們始終會
幫助App Search

00:37:02.489 --> 00:37:04.691 
索引你的app和內容

00:37:04.758 --> 00:37:06.660 
這樣在用戶的Safari和

00:37:06.727 --> 00:37:08.328 
Spotlight中就都可以使用

00:37:09.997 --> 00:37:10.831 
最後

00:37:10.898 --> 00:37:12.733 
通過使用
共享網絡憑證

00:37:13.233 --> 00:37:16.870 
你可以讓app訪問
Safari保存的密碼

00:37:17.171 --> 00:37:20.174 
幫助用戶輕鬆
登錄你的app

00:37:22.509 --> 00:37:24.278 
若要了解我們今天
介紹的更多詳情

00:37:24.444 --> 00:37:25.946 
可以去看看
我們的文檔資料

00:37:26.713 --> 00:37:28.549 
大家還可以在
開發人員論壇中提問

00:37:28.815 --> 00:37:30.751 
當然也可以去DTS看看

00:37:32.319 --> 00:37:35.756 
還可以聯繫約翰·戴維斯
我們的網絡技術開發顧問

00:37:35.956 --> 00:37:38.492 
或者傑克·伯倫斯
App框架開發顧問

00:37:38.892 --> 00:37:40.961 
去年和今年 還有
若干相關講座

00:37:41.028 --> 00:37:43.363 
其中會深入
介紹我們

00:37:43.430 --> 00:37:44.698 
所講的內容

00:37:46.033 --> 00:37:47.734 
感謝大家 希望大家
喜歡大會的其餘部分