00:00:20.420 --> 00:00:23.524 
Safari可擴展性的
最新內容

00:00:23.590 --> 00:00:24.424 
<br/> 
大家好

00:00:24.791 --> 00:00:25.893 
我是布萊恩·溫斯坦

00:00:25.993 --> 00:00:29.463 
是Safari和WebKit的
工程師我來這裏和大家

00:00:29.630 --> 00:00:32.064 
聊聊《Safari可擴展性的
最新內容》

00:00:33.400 --> 00:00:37.004 
今天 我們會介紹
擴展Safari的幾種新方法

00:00:37.604 --> 00:00:40.774 
你可以爲iOS和OS X
編寫內容攔截器

00:00:42.209 --> 00:00:44.912 
Safari Extensions
Gallery也有改變

00:00:45.846 --> 00:00:48.282 
還有新的app擴展
類型 可以將你的

00:00:48.348 --> 00:00:51.552 
內容直接加在Safari的
Shared Links中

00:00:53.220 --> 00:00:55.889 
我們這就開始
直入正題 談談

00:00:55.956 --> 00:00:56.990 
內容攔截器

00:01:00.160 --> 00:01:01.862 
我們先來看
一個大問題：

00:01:02.162 --> 00:01:03.630 
內容攔截器是什麼？

00:01:04.197 --> 00:01:08.635 
內容攔截器確定了
頁面上的內容子集或

00:01:08.702 --> 00:01:12.039 
資源不會顯示
或者都不會加載

00:01:12.573 --> 00:01:15.108 
我相信大家都可以
設想自己在瀏覽Web時

00:01:15.175 --> 00:01:16.109 
有意攔截的內容

00:01:17.477 --> 00:01:20.447 
可以通過兩種重要方法
使用內容攔截器

00:01:20.514 --> 00:01:21.381 
來攔截內容

00:01:21.915 --> 00:01:25.319 
可以在頁面隱藏元素
或一併攔截

00:01:25.385 --> 00:01:26.520 
加載資源

00:01:27.421 --> 00:01:29.223 
一段時間以來 你可以
在OS X上使用Safari擴展

00:01:29.389 --> 00:01:32.626 
來實現這個功能
但是如今 我們讓

00:01:32.693 --> 00:01:34.561 
iOS也有了這個功能

00:01:35.062 --> 00:01:38.532 
App會提前告知Safari
它們想要攔截的內容

00:01:38.599 --> 00:01:41.935 
而不是在實際加載過程中
Safari諮詢

00:01:42.002 --> 00:01:44.938 
app是否
進行攔截

00:01:45.372 --> 00:01:48.108 
這種新模式
快速而高效 

00:01:48.375 --> 00:01:50.377 
因爲Safari不需要 
在加載時 

00:01:50.577 --> 00:01:52.212 
諮詢app 

00:01:52.579 --> 00:01:56.149 
內容攔截器
被編譯成字節代碼

00:01:56.316 --> 00:01:58.285 
這樣可以高效地
進行評估

00:01:58.852 --> 00:02:02.489 
除此之外 新模式
可以很好地保護用戶隱私

00:02:02.756 --> 00:02:05.993 
因爲內容攔截器
不會瀏覽

00:02:06.093 --> 00:02:07.361 
用戶在做什麼

00:02:08.762 --> 00:02:12.065 
要創建內容攔截器
你需要在

00:02:12.132 --> 00:02:16.537 
iOS上生成app擴展
這會返回一個列表

00:02:16.603 --> 00:02:18.605 
包括你想
攔截的內容

00:02:18.672 --> 00:02:21.942 
規則列表的
JSON字符串

00:02:23.310 --> 00:02:27.181 
這裏是我常去的網站
作者會介紹 

00:02:27.247 --> 00:02:29.116 
他打球的不同
球場 還有

00:02:29.349 --> 00:02:30.984 
一些漂亮的
圖片

00:02:31.552 --> 00:02:34.588 
但是網站有些
內容很是煩人

00:02:35.088 --> 00:02:36.757 
我希望編寫
內容攔截器

00:02:37.057 --> 00:02:38.759 
來攔截那些
讓我煩心的內容

00:02:39.259 --> 00:02:41.662 
最顯眼的惱人之處
是左側的

00:02:41.728 --> 00:02:43.297 
點擊誘餌鏈接

00:02:44.831 --> 00:02:47.835 
在我滾動頁面時
它們甚至都不離左右

00:02:48.168 --> 00:02:50.504 
我們來編寫規則
隱藏這一元素

00:02:53.340 --> 00:02:56.610 
首先來看 我們
應該隱藏哪個元素

00:02:56.944 --> 00:03:00.380 
來看網絡檢測器
我們看div存在ID泄露問題

00:03:00.447 --> 00:03:03.283 
在網絡檢測器中
選中時

00:03:04.117 --> 00:03:10.123 
我們實際上在
設備上做了覆蓋

00:03:10.190 --> 00:03:12.860 
顯示這是需要
隱藏的正確元素

00:03:13.360 --> 00:03:15.896 
那麼我們現在
知道該隱藏的元素

00:03:16.230 --> 00:03:17.664 
我們來編寫規則完成此事

00:03:19.333 --> 00:03:23.270 
每項規則 每項內容
攔截規則都是

00:03:23.537 --> 00:03:26.440 
包含動作和觸發器
字典的JSON對象

00:03:26.573 --> 00:03:30.711 
這個動作告知Safari
該做什麼

00:03:31.111 --> 00:03:32.746 
觸發器告知Safari

00:03:32.813 --> 00:03:35.148 
何時要採取
相應的行動

00:03:35.816 --> 00:03:39.019 
我們先來看看
隱藏這個元素的

00:03:39.219 --> 00:03:41.221 
動作字典 
是要隱藏這個元素

00:03:41.688 --> 00:03:45.826 
我們的動作
就是將類型CSS不顯示

00:03:46.126 --> 00:03:48.795 
也就是說我們
在頁面元素應用

00:03:48.996 --> 00:03:50.531 
不顯示樣式

00:03:50.898 --> 00:03:54.234 
當動作類型爲
CSS不顯示時

00:03:54.468 --> 00:03:57.471 
在動作字典中
會用到選擇器

00:03:57.871 --> 00:04:00.073 
所有的選擇器
都得到Safari支持

00:04:00.140 --> 00:04:02.709 
WebKit是得到
內容攔截器支持

00:04:03.110 --> 00:04:05.045 
在本例中 我們想

00:04:05.112 --> 00:04:07.748 
用ID Link來攔截
內容

00:04:08.882 --> 00:04:11.985 
現在我們來定義
何時想要採取這個行爲

00:04:12.319 --> 00:04:14.521 
會用到觸發器
字典來實現

00:04:16.023 --> 00:04:19.692 
因爲Links是相當泛型
的選擇器 可以用於

00:04:19.760 --> 00:04:22.095 
其他頁面的真實內容

00:04:22.162 --> 00:04:24.364 
我只想讓這個規則

00:04:24.565 --> 00:04:28.268 
在用戶位於bigbearsgolf
blog.com頁面時應用

00:04:28.936 --> 00:04:31.572 
如果我想讓規則
在用戶位於

00:04:31.638 --> 00:04:34.675 
bigbearsgolfblog.
com以外的任何站點運用

00:04:35.142 --> 00:04:37.611 
我會只將如果域值祕鑰

00:04:37.678 --> 00:04:38.912 
替換爲除非域值

00:04:38.979 --> 00:04:40.414 
並保持相同值

00:04:41.281 --> 00:04:44.651 
我希望在加載任何資源時
都應用這一動作

00:04:44.852 --> 00:04:48.388 
同樣只要我在bigbears
golfblog.com

00:04:48.689 --> 00:04:52.826 
我就會設置作爲
正則表達式的URL過濾器

00:04:52.893 --> 00:04:55.696 
在下載的
每個URL資源上運行

00:04:55.963 --> 00:04:57.397 
以便匹配所有的URL

00:04:57.664 --> 00:04:58.632 
在稍後的例子中

00:04:58.699 --> 00:05:01.001 
我們會再說說
URL過濾器

00:05:01.802 --> 00:05:04.304 
我們來看這個規則
放在一起是什麼樣子

00:05:05.372 --> 00:05:08.108 
我們有動作類型
CSS不顯示

00:05:08.342 --> 00:05:09.977 
也就是說我們
在隱藏元素

00:05:11.044 --> 00:05:14.047 
選擇器用於描述
我們隱藏的元素

00:05:15.649 --> 00:05:16.850 
接着在觸發器裏

00:05:17.050 --> 00:05:20.287 
我們說明想要
這個樣式運用到哪個域名

00:05:21.855 --> 00:05:24.825 
在加載時 我們希望將
它用在哪些資源

00:05:27.060 --> 00:05:28.862 
在運用內容
攔截器時

00:05:29.162 --> 00:05:30.430 
網頁是這樣的

00:05:31.899 --> 00:05:34.201 
鏈接列表
不復存在 我可以

00:05:34.268 --> 00:05:35.602 
集中在感興趣的
內容上來

00:05:39.473 --> 00:05:40.307 
但是

00:05:40.374 --> 00:05:41.642 
當我看着
Web檢測器時

00:05:41.909 --> 00:05:44.011 
發現頁面上
還有一處煩人的內容

00:05:44.912 --> 00:05:47.314 
如果你來看
頁面的資源

00:05:47.714 --> 00:05:50.417 
就可以看到
從example.com

00:05:50.484 --> 00:05:52.920 
加載的腳本名爲Tracking
script.JS 

00:05:53.387 --> 00:05:55.289 
這個腳本實際上

00:05:55.355 --> 00:05:57.424 
在跟蹤我訪問的不同頁面

00:05:57.491 --> 00:05:59.193 
這樣可以從我的瀏覽
歷史中

00:05:59.259 --> 00:06:00.561 
可以搭建出我的配置 

00:06:00.961 --> 00:06:03.130 
當我在看控制檯時

00:06:03.197 --> 00:06:04.531 
它會幫助警告我

00:06:04.598 --> 00:06:05.599 
稱我被跟蹤了

00:06:06.600 --> 00:06:07.801 
感謝 Tracking腳本

00:06:09.236 --> 00:06:12.372 
我會在加載時
一起攔截這個腳本

00:06:15.676 --> 00:06:18.478 
我們先來定義
這個規則的動作 

00:06:22.349 --> 00:06:24.585 
動作類型爲攔截

00:06:24.651 --> 00:06:25.986 
是指我們會攔截

00:06:26.053 --> 00:06:28.989 
匹配相應觸發器的
任何資源加載

00:06:29.289 --> 00:06:30.724 
我們來看
這個觸發器

00:06:31.959 --> 00:06:34.628 
觸發器會定義
動作何時應啓動

00:06:34.962 --> 00:06:37.631 
但是在本例中
我們已經定義過URL過濾器

00:06:37.965 --> 00:06:40.033 
資源類型
和加載類型

00:06:40.567 --> 00:06:43.871 
當三項內容 URL過濾器
資源類型和加載類型

00:06:44.071 --> 00:06:47.040 
全部匹配 觸發器
就會啓動

00:06:47.875 --> 00:06:50.210 
我們先來介紹
URL過濾器

00:06:51.078 --> 00:06:52.546 
這是個正則表達式

00:06:52.613 --> 00:06:54.248 
在所被要求的每個URL上

00:06:54.314 --> 00:06:55.349 
都會運行

00:06:55.883 --> 00:06:58.452 
在這種情況下
它會與任何包括

00:06:58.719 --> 00:07:01.688 
字符串Tracking 
的下劃線腳本相匹配

00:07:02.022 --> 00:07:03.724 
這將匹配

00:07:03.790 --> 00:07:06.627 
example.com
Trackingscript.js

00:07:07.995 --> 00:07:10.030 
觸發器的其餘組件

00:07:10.097 --> 00:07:13.400 
會提升觸發器的
針對性

00:07:13.700 --> 00:07:16.069 
我們並不需要
攔截的內容矯枉過正

00:07:17.371 --> 00:07:20.140 
首先我們要的是
確定一組

00:07:20.207 --> 00:07:22.075 
資源類型
來匹配

00:07:22.543 --> 00:07:26.013 
在本例中 我們只想
攔截加載腳本

00:07:26.413 --> 00:07:29.750 
所以把腳本作爲
我們希望匹配的資源類型

00:07:30.717 --> 00:07:34.087 
最後 我們規定了
第三方的加載類型

00:07:34.588 --> 00:07:36.823 
加載類型可能爲
兩個值

00:07:37.224 --> 00:07:39.426 
是第一方
和第三方

00:07:39.927 --> 00:07:42.396 
當加載是來自
相同的方案 域名和端口時

00:07:42.462 --> 00:07:43.697 
則被視作是第一方

00:07:44.097 --> 00:07:47.634 
作爲頁面的
主要資源

00:07:48.068 --> 00:07:50.604 
在我們的例子中
我們只希望攔截

00:07:50.671 --> 00:07:53.307 
第三方加載的
跟蹤腳本

00:07:53.640 --> 00:07:56.443 
也就是說如果
用戶是在example.com

00:07:56.743 --> 00:07:58.579 
腳本仍然會
成功加載

00:08:00.013 --> 00:08:02.316 
我們來看規則
放在一起是什麼效果

00:08:03.550 --> 00:08:06.720 
當我們配合這個內容
攔截規則重新加載頁面時

00:08:07.221 --> 00:08:08.355 
大家可以看到

00:08:08.422 --> 00:08:10.457 
我們根本沒有加載

00:08:11.391 --> 00:08:12.426 
我們根本沒有加載

00:08:12.492 --> 00:08:14.361 
Tracking 
script.js

00:08:14.828 --> 00:08:17.064 
控制檯沒有給出警告

00:08:17.331 --> 00:08:18.332 
稱我們被跟蹤

00:08:19.433 --> 00:08:20.267 
非常棒！

00:08:26.039 --> 00:08:26.874 
因此

00:08:26.940 --> 00:08:29.743 
你的內容攔截器
會成爲這些規則

00:08:29.810 --> 00:08:30.711 
的JSON數組

00:08:31.078 --> 00:08:33.447 
現在 你已經描述了
想要攔截的內容

00:08:33.881 --> 00:08:36.450 
下一步就是
在iOS設備上獲取

00:08:36.582 --> 00:08:37.851 
內容攔截器

00:08:38.385 --> 00:08:41.855 
我剛纔說過 iOS上的 
內容攔截器是

00:08:41.922 --> 00:08:42.923 
從app擴展中加載

00:08:43.222 --> 00:08:45.259 
很簡單 
你可以自己做一個

00:08:45.492 --> 00:08:48.495 
開始時 你只需要
在項目中添加新目標

00:08:48.929 --> 00:08:51.865 
從iOS應用擴展列表中
選擇內容

00:08:51.932 --> 00:08:53.767 
攔截器擴展

00:08:54.234 --> 00:08:57.004 
當設置在啓動了你的
內容攔截器 

00:08:57.070 --> 00:08:59.339 
app擴展就會被
實例化

00:08:59.840 --> 00:09:01.842 
與其他的app
擴展類似

00:09:01.909 --> 00:09:03.110 
它是默認關閉狀態

00:09:04.144 --> 00:09:07.080 
Safari會把你的規則
編入字節代碼

00:09:07.147 --> 00:09:08.382 
這樣每次啓動

00:09:08.448 --> 00:09:11.552 
Safari時 就會加載
並快速評估

00:09:12.119 --> 00:09:14.454 
一旦你生成了
app擴展

00:09:14.621 --> 00:09:17.991 
就會有動作請求
處理器

00:09:18.225 --> 00:09:19.560 
像這樣

00:09:20.327 --> 00:09:24.498 
app擴展所做的就是
在app擴展實例化時 

00:09:24.565 --> 00:09:27.367 
將攔截器

00:09:27.467 --> 00:09:29.503 
list.JSON的內容
返回Safari

00:09:29.870 --> 00:09:32.840 
攔截器list.JSON
自動進入

00:09:33.240 --> 00:09:35.542 
你的擴展目標
編寫自己的內容攔截器

00:09:35.609 --> 00:09:37.277 
你所需要
做的就是

00:09:37.344 --> 00:09:38.812 
填寫這個JSON文件

00:09:39.980 --> 00:09:40.814 
此外

00:09:42.015 --> 00:09:44.117 
內容攔截器自動
用於Safari

00:09:44.184 --> 00:09:45.252 
或任何使用

00:09:45.319 --> 00:09:47.788 
Safari View 
Controller的app

00:09:47.855 --> 00:09:50.524 
如果你有顯示
Web內容的app

00:09:50.824 --> 00:09:52.459 
則應該查看本週早些時候

00:09:52.526 --> 00:09:55.229 
介紹Safari View
Controller的講座內容

00:09:56.597 --> 00:09:57.664 
但是

00:09:57.731 --> 00:09:59.933 
對部分app而言
靜態攔截表 

00:10:00.000 --> 00:10:01.034 
還不夠

00:10:01.368 --> 00:10:03.103 
你可能想
提供內容攔截器的

00:10:03.170 --> 00:10:04.605 
自定義內容

00:10:04.671 --> 00:10:06.440 
或是讓用戶從

00:10:06.507 --> 00:10:08.275 
諸多不同
攔截表中選擇

00:10:08.609 --> 00:10:12.279 
或是讓用戶選擇
他們不想運用的具體站點

00:10:12.813 --> 00:10:13.947 
爲此

00:10:14.014 --> 00:10:15.816 
和其他 
app擴展一樣

00:10:16.083 --> 00:10:19.152 
我們建議你把管理
設置放入app

00:10:20.020 --> 00:10:22.923 
當用戶採取的動作
會改變

00:10:22.990 --> 00:10:24.057 
攔截表的內容時

00:10:24.324 --> 00:10:26.159 
你只需要告知

00:10:26.393 --> 00:10:28.295 
Safari重新
實例化app擴展

00:10:28.428 --> 00:10:30.931 
這將導致內容
攔截器被重新編譯

00:10:31.798 --> 00:10:32.633 
爲此

00:10:32.900 --> 00:10:34.301 
我們
在Safari服務框架中

00:10:34.368 --> 00:10:36.436 
的新款API

00:10:36.770 --> 00:10:38.505 
名爲SF內容攔截器

00:10:38.572 --> 00:10:41.608 
管理器重新加載
帶有標識符的內容攔截器

00:10:42.142 --> 00:10:44.945 
你只需要傳遞
內容攔截器的

00:10:45.012 --> 00:10:46.113 
束標識符

00:10:46.446 --> 00:10:49.516 
這將導致Safari
重新運行app

00:10:49.683 --> 00:10:51.418 
擴展並升級
解析內容

00:10:51.485 --> 00:10:53.053 
攔截器生成的
字節代碼

00:10:54.121 --> 00:10:57.257 
這不過是內容攔截器
可實現的部分功能

00:10:57.357 --> 00:10:59.760 
可見開始製作自己的
內容攔截器是多麼簡單

00:11:00.160 --> 00:11:02.829 
我想有請
阿萊克斯·克里斯滕森來做演示

00:11:03.197 --> 00:11:04.031 
阿萊克斯?

00:11:10.737 --> 00:11:11.572 
<br/> 
謝謝 布萊恩

00:11:13.307 --> 00:11:16.009 
我是阿萊克斯·克里斯滕森
來自Safari和WebKit

00:11:16.076 --> 00:11:18.512 
我將給大家展示
如何在iOS製作內容攔截器

00:11:19.313 --> 00:11:21.481 
我們會通過兩種
方式 攔截內容

00:11:22.115 --> 00:11:23.951 
我們將在Web頁面
隱藏部分元素

00:11:24.017 --> 00:11:25.118 
我們還會
攔截部分加載

00:11:26.987 --> 00:11:27.955 
現在

00:11:28.622 --> 00:11:31.024 
我不瞭解大家會怎樣
但是我自己是時常在

00:11:31.091 --> 00:11:32.526 
Web衝浪

00:11:32.593 --> 00:11:35.229 
感覺的確
可以通過刪除

00:11:35.295 --> 00:11:37.164 
部分網頁內容的擴展

00:11:37.231 --> 00:11:39.499 
來提升
用戶體驗

00:11:40.334 --> 00:11:42.803 
大家看看
我收藏的Web頁面

00:11:42.870 --> 00:11:44.338 
大家就會明白
我是在說什麼

00:11:50.143 --> 00:11:51.311 
就這樣

00:11:51.478 --> 00:11:56.683 
哦！我就喜歡
這樣的Web頁面

00:11:56.750 --> 00:12:01.021 
我可以瞭解
可愛小狗圖片的世界上

00:12:01.088 --> 00:12:02.389 
在發生什麼

00:12:02.956 --> 00:12:09.496 
這些內容 我每天
至少會查看一個 

00:12:09.563 --> 00:12:12.199 
寶貴的屏幕空間非常有限

00:12:13.901 --> 00:12:17.938 
這裏的評論有些
煩人 而且還佔用了

00:12:18.005 --> 00:12:20.574 
寶貴的屏幕空間
我本想留着

00:12:20.641 --> 00:12:21.909 
放可愛的小狗照片的

00:12:22.843 --> 00:12:24.745 
我們進入Web檢測器 

00:12:24.811 --> 00:12:26.680 
來看這個問題
該怎麼解決

00:12:28.115 --> 00:12:32.452 
在Mac上打開Safari

00:12:32.553 --> 00:12:35.689 
如果進入開發菜單
模擬器

00:12:36.323 --> 00:12:37.758 
可愛的小狗和cats.com

00:12:37.824 --> 00:12:39.326 
大家可以看見 

00:12:39.393 --> 00:12:41.361 
我們要檢查這個
iOS模擬器實例

00:12:42.596 --> 00:12:45.399 
如果我們按住鼠標
可以看到

00:12:45.465 --> 00:12:47.734 
這就是我想
隱藏的div

00:12:50.103 --> 00:12:52.239 
這是個類評論

00:12:53.440 --> 00:12:56.443 
如果我們研究Web頁面的結構
就會看出

00:12:56.510 --> 00:12:59.046 
我想隱藏的
其他div

00:12:59.112 --> 00:13:00.781 
也都有
類評論

00:13:00.914 --> 00:13:04.251 
編寫選擇器
div.comments非常簡單

00:13:04.718 --> 00:13:08.088 
可以發現 頁面上我想隱藏的
所有元素 

00:13:08.155 --> 00:13:14.161 
都使用了CSS
不顯示樣式

00:13:14.228 --> 00:13:17.364 
我們來制定規則
在iOS內容攔截器中完成這個任務 

00:13:24.538 --> 00:13:29.977 
打開Xcode 
生成新項目iOS 

00:13:31.278 --> 00:13:32.980 
單視圖應用

00:13:33.814 --> 00:13:36.850 
我的app希望大家能有
比"我的app"更好的名稱

00:13:39.286 --> 00:13:40.854 
在桌面上
生成它

00:13:42.489 --> 00:13:43.323 
好

00:13:43.390 --> 00:13:45.559 
從這裏我們進入文檔

00:13:46.026 --> 00:13:47.094 
新建

00:13:47.160 --> 00:13:47.995 
目標

00:13:50.464 --> 00:13:52.766 
在iOS下

00:13:53.433 --> 00:13:54.902 
應用擴展

00:13:55.302 --> 00:13:57.404 
這裏有
內容攔截擴展模板

00:13:57.471 --> 00:13:58.906 
就是布萊恩
剛說過的那個

00:14:04.545 --> 00:14:05.712 
我的內容攔截器

00:14:07.047 --> 00:14:09.950 
我們不要激活
這個方案 因爲我們

00:14:10.017 --> 00:14:12.252 
要在iOS模擬器上 
運行app

00:14:13.120 --> 00:14:14.821 
加入新的目標

00:14:15.255 --> 00:14:16.356 
變成這個樣子：

00:14:16.423 --> 00:14:18.025 
mycontentblocker

00:14:19.126 --> 00:14:20.360 
在其中

00:14:21.228 --> 00:14:23.063 
生成了
攔截器list.JSON

00:14:23.597 --> 00:14:25.098 
我們準備把規則
放在這裏

00:14:27.434 --> 00:14:28.502 
現在

00:14:31.905 --> 00:14:33.240 
我有應用於

00:14:35.509 --> 00:14:40.080 
選擇器
div.comments的規則

00:14:40.981 --> 00:14:44.818 
並把樣式CSS不顯示
應用於選擇器匹配的

00:14:44.885 --> 00:14:48.655 
頁面所有
元素中

00:14:54.127 --> 00:14:56.163 
我們現在把這個
應用到所有地方

00:14:57.331 --> 00:14:59.366 
用點星號正則表達式

00:15:00.801 --> 00:15:01.668 
代表所有地方

00:15:03.704 --> 00:15:05.305 
在模擬器中運行

00:15:06.139 --> 00:15:06.974 
這就是我的app

00:15:09.076 --> 00:15:10.410 
好的

00:15:10.577 --> 00:15:11.745 
如果我們進入設置

00:15:14.014 --> 00:15:14.982 
Safari

00:15:18.352 --> 00:15:19.319 
內容攔截器

00:15:20.521 --> 00:15:22.122 
這是我的app的
內容攔截器

00:15:22.990 --> 00:15:24.057 
我們把它打開

00:15:25.392 --> 00:15:27.561 
重新加載頁面 看看它會做什麼

00:15:36.236 --> 00:15:37.504 
所有評論都不見了

00:15:38.238 --> 00:15:39.673 
我可以把屏幕空間

00:15:39.740 --> 00:15:42.843 
放可愛的小狗照片
我來這個站點就是這個目的

00:15:42.910 --> 00:15:47.014 
如果仔細看
你可能會發現

00:15:47.814 --> 00:15:49.850 
有一幅圖 不是
可愛的小狗照片

00:15:51.251 --> 00:15:55.355 
我其實是個愛狗人士 
而不是愛貓人士

00:15:58.559 --> 00:16:02.396 
我不想看到
這些貓咪的照片

00:16:04.298 --> 00:16:06.900 
(Laughter)我不想等到
這些貓咪照片都加載下來

00:16:06.967 --> 00:16:08.235 
也不想把帶寬
用在下載

00:16:08.802 --> 00:16:11.305 
我根本
不想要的

00:16:11.371 --> 00:16:15.375 
貓咪上面 
我們把這些加載完全攔截掉

00:16:21.949 --> 00:16:24.451 
回到Web檢測器
和資源選項卡

00:16:25.953 --> 00:16:28.589 
大家可以看到
這個頁面上的資源

00:16:31.425 --> 00:16:34.228 
有些名稱我可以通過
編寫正則表達式識別出來

00:16:34.695 --> 00:16:37.331 
如果包括斜槓

00:16:38.665 --> 00:16:39.800 
貓咪
那可能就是貓咪照片

00:16:42.202 --> 00:16:43.470 
我們攔截這些加載

00:16:47.641 --> 00:16:49.810 
這裏我還有個規則

00:16:51.912 --> 00:16:53.547 
動作類型攔截

00:16:54.281 --> 00:16:59.586 
如果匹配正則表達式

00:16:59.653 --> 00:17:01.655 
斜槓貓咪 我們就攔截它

00:17:01.989 --> 00:17:03.957 
我覺得這
有點太過泛型

00:17:04.023 --> 00:17:06.292 
我估計這樣可能
會攔截掉一些

00:17:06.359 --> 00:17:09.262 
我不想攔截的頁面
比如任何位置的URL

00:17:09.329 --> 00:17:11.431 
要是有這樣的斜槓類型
就會被攔截

00:17:11.498 --> 00:17:12.965 
但是這可能會導致問題

00:17:13.534 --> 00:17:14.401 
我們先這麼用在

00:17:14.468 --> 00:17:17.471 
cutepuppiesand
cats.com之中我相當肯定

00:17:17.538 --> 00:17:19.339 
網站上若有斜槓
貓咪的URL 可能就是

00:17:19.406 --> 00:17:21.875 
我想要攔截的
貓咪照片

00:17:23.609 --> 00:17:26.480 
好的 我們來運行一下
看看會怎樣

00:17:33.887 --> 00:17:35.822 
我們回到設置中
做轉換  

00:17:35.889 --> 00:17:37.424 
並重新編譯
內容攔截器

00:17:37.824 --> 00:17:40.661 
你還可以使用API
從app內部完成這個任務

00:17:44.164 --> 00:17:45.532 
返回Safari

00:17:46.266 --> 00:17:47.100 
重新加載
頁面

00:17:47.868 --> 00:17:48.735 
就這樣

00:17:48.802 --> 00:17:50.304 
貓咪照片不見了

00:17:50.704 --> 00:17:52.239 
但有些內容出現了問題

00:17:52.339 --> 00:17:55.475 
小狗照片太大了

00:17:55.742 --> 00:17:57.110 
沒有背景顏色

00:17:57.444 --> 00:17:59.146 
看似CSS
也不見了

00:17:59.713 --> 00:18:03.584 
<br/> 
我們肯定不想這樣

00:18:03.650 --> 00:18:05.552 
我們回到設置中
Web檢測器

00:18:05.619 --> 00:18:06.453 
看看是怎麼回事

00:18:07.254 --> 00:18:10.057 
這裏

00:18:10.123 --> 00:18:11.124 
大家會看到

00:18:11.658 --> 00:18:13.560 
CSS在URL中

00:18:14.361 --> 00:18:17.564 
還是以 /cat開頭

00:18:17.631 --> 00:18:18.899 
是貓咪和dogs.css

00:18:18.966 --> 00:18:21.602 
我們無意中
把它攔截了

00:18:22.269 --> 00:18:24.938 
有兩種辦法

00:18:25.005 --> 00:18:26.874 
來解決問題

00:18:27.007 --> 00:18:29.676 
我們還有一個規則

00:18:29.743 --> 00:18:31.578 
只適用於圖像或...

00:18:33.547 --> 00:18:36.149 
可以有些創意

00:18:36.216 --> 00:18:39.520 
但我會這麼做

00:18:40.587 --> 00:18:42.356 
如果匹配了
貓咪和小狗

00:18:42.890 --> 00:18:45.192 
我們想忽略掉
攔截的規則

00:18:51.498 --> 00:18:52.366 
就這樣

00:18:52.766 --> 00:18:55.435 
其中有貓咪和小狗
就忽略之前的規則

00:18:55.836 --> 00:18:58.872 
這會攔截貓咪圖片
這是我想要的樣子

00:18:58.939 --> 00:19:02.676 
但是會讓貓咪和
dog.css通過 

00:19:06.580 --> 00:19:07.981 
好的 我們再來運行一下

00:19:16.723 --> 00:19:19.927 
切換 重編譯
內容攔截器

00:19:23.697 --> 00:19:25.032 
並重新加載頁面

00:19:26.767 --> 00:19:27.601 
就這樣

00:19:32.139 --> 00:19:35.008 
我希望內容攔截器的
用戶像這樣

00:19:35.342 --> 00:19:36.577 
來查看網頁

00:19:37.044 --> 00:19:38.779 
直接就是
小狗照片

00:19:39.079 --> 00:19:40.414 
好

00:19:41.748 --> 00:19:45.953 
今天 我們攔截了部分貓咪照片
隱藏了一些評論

00:19:46.620 --> 00:19:49.423 
誰知道明天
你想攔截什麼內容呢？

00:19:49.489 --> 00:19:50.624 
隨你啦

00:19:50.691 --> 00:19:52.926 
試着在iOS上
製作內容攔截器吧

00:19:53.193 --> 00:19:54.027 
布萊恩 上來吧

00:20:01.869 --> 00:20:02.903 
<br/> 
謝謝 阿萊克斯

00:20:03.070 --> 00:20:04.471 
剛纔是對怎樣

00:20:04.538 --> 00:20:06.540 
在iOS生成
製作內容攔截器進行綜述

00:20:06.940 --> 00:20:08.876 
其中只是介紹了
可實現的部分功能

00:20:11.311 --> 00:20:14.548 
因爲我們覺得
攔截列表模型是

00:20:14.615 --> 00:20:16.149 
攔截Web內容的最好方法

00:20:16.216 --> 00:20:17.417 
我們已經把

00:20:17.484 --> 00:20:21.121 
相同的模型通過傳統的Safari
擴展API帶回Mac

00:20:21.655 --> 00:20:24.591 
幾年前 大家就可以
使用Safari

00:20:24.791 --> 00:20:27.060 
攔截內容
但是當前的攔截模型

00:20:27.127 --> 00:20:30.464 
可以反向影響
用戶瀏覽的

00:20:30.631 --> 00:20:31.832 
效果

00:20:33.333 --> 00:20:36.103 
有了這款新的攔截
列表模型 因爲Safari

00:20:36.170 --> 00:20:38.872 
在任何加載發生之前 
就知道了攔截列表

00:20:39.173 --> 00:20:40.374 
速度就會快很多

00:20:40.641 --> 00:20:43.644 
因爲我們已經優化了
這些攔截列表

00:20:43.710 --> 00:20:45.078 
生成的編譯字節代碼

00:20:45.279 --> 00:20:46.980 
也會大幅提高
內存效率

00:20:47.948 --> 00:20:51.285 
如果有人使用...
編寫擴展

00:20:51.351 --> 00:20:54.354 
如果有人過去
編寫過內容攔截擴展

00:20:54.955 --> 00:20:56.590 
他們會瞭解
可加載方法

00:20:57.191 --> 00:20:59.459 
所以我們在
反對可加載方法

00:20:59.793 --> 00:21:03.096 
如果Safari擴展
規定了攔截列表

00:21:03.397 --> 00:21:06.567 
調用可加載會變成
擴展中的停止操作

00:21:06.633 --> 00:21:11.505 
在Safari擴展中
增加內容攔截器

00:21:11.572 --> 00:21:14.041 
你只需要在Safari的
擴展構建器中

00:21:14.374 --> 00:21:17.144 
設置內容攔截器文檔

00:21:17.477 --> 00:21:22.182 
這可以是你的iOS app
所用的完全相同的JSON文檔

00:21:23.550 --> 00:21:25.953 
但是 如果你想
爲用戶提供

00:21:26.019 --> 00:21:28.956 
攔截內容的
自定義選項

00:21:29.256 --> 00:21:32.192 
同樣要讓他們從
不同的攔截列表中選擇

00:21:32.459 --> 00:21:35.295 
或者當用戶在具體頁面時
讓攔截列表

00:21:35.362 --> 00:21:38.265 
不能適用我們已添加了
JavaScript API

00:21:38.565 --> 00:21:41.502 
來動態配置
你的內容攔截器

00:21:42.336 --> 00:21:46.106 
你可以從擴展的
全局頁面調用

00:21:46.173 --> 00:21:48.675 
Safari.extension.
set內容攔截器

00:21:48.742 --> 00:21:51.378 
並傳遞至
內容攔截器

00:21:51.879 --> 00:21:53.580 
內容攔截器

00:21:53.647 --> 00:21:55.182 
可以是對象

00:21:55.516 --> 00:21:56.683 
或JSON字符串

00:21:56.884 --> 00:21:57.985 
API二者都接受

00:22:00.721 --> 00:22:02.389 
剛纔是對iOS和OS X

00:22:02.456 --> 00:22:05.259 
的內容攔截器
進行綜述

00:22:06.159 --> 00:22:08.829 
當我們談論
傳統的Safari擴展時

00:22:09.429 --> 00:22:10.297 
我們對

00:22:10.364 --> 00:22:12.633 
Safari Extensions
Gallery有所改變

00:22:18.071 --> 00:22:20.440 
若有誰不熟悉
Safari Extensions

00:22:20.507 --> 00:22:23.310 
Gallery 它其實是
用戶發現Safari 

00:22:23.377 --> 00:22:25.979 
擴展的
最佳位置

00:22:26.346 --> 00:22:28.982 
可以直接從
Safari的菜單

00:22:29.283 --> 00:22:31.485 
並從Safari的
擴展偏好直接訪問

00:22:31.985 --> 00:22:33.487 
只有在這裏

00:22:33.554 --> 00:22:37.391 
用戶點擊一下
即可安裝擴展

00:22:38.625 --> 00:22:41.195 
如果你對製作
Safari擴展很是認真

00:22:41.361 --> 00:22:42.829 
你現在就已經在這個庫裏了

00:22:43.096 --> 00:22:45.966 
我之前說過 這裏是
用戶發現並

00:22:46.166 --> 00:22:48.235 
安裝擴展
最便捷的位置

00:22:48.902 --> 00:22:51.538 
爲了用戶的
安全起見

00:22:51.772 --> 00:22:53.473 
很快庫裏的所有

00:22:53.540 --> 00:22:57.177 
擴展都會由Apple
簽署並主持

00:22:57.411 --> 00:22:59.713 
利用這一點
你只需向

00:22:59.780 --> 00:23:02.583 
庫中重新
提交擴展即可

00:23:03.584 --> 00:23:05.986 
還有一點
非常棒的是

00:23:06.053 --> 00:23:09.089 
一旦你已經向庫
提交過一個版本

00:23:09.423 --> 00:23:12.693 
如果提交更新的話
用戶會自動

00:23:12.759 --> 00:23:14.428 
免費獲得擴展的更新版本

00:23:14.862 --> 00:23:17.264 
你不必再編寫
更新清單

00:23:18.232 --> 00:23:20.767 
但是如果你的版本
在庫中沒有

00:23:21.301 --> 00:23:25.172 
當你想讓用戶
更新庫中的

00:23:25.239 --> 00:23:28.442 
最新版本時
你需要在更新

00:23:28.509 --> 00:23:31.845 
清單中添加新的旗標
說明

00:23:31.912 --> 00:23:33.914 
Safari應更新
擴展到

00:23:34.081 --> 00:23:35.382 
庫中的版本

00:23:35.782 --> 00:23:37.117 
很快

00:23:37.351 --> 00:23:39.953 
自動更新
將僅適用於

00:23:40.020 --> 00:23:42.923 
Extensions
Gallery中的擴展

00:23:44.725 --> 00:23:46.760 
這些是Safari 
ExtensionsGallery

00:23:46.827 --> 00:23:47.661 
所做的改變

00:23:47.794 --> 00:23:50.264 
我來介紹本次講座的
最後一項內容

00:23:50.531 --> 00:23:52.132 
Shared
 Links app擴展

00:23:55.469 --> 00:23:57.704 
Shared Links是一項
Safari功能

00:23:57.771 --> 00:23:59.072 
就在書籤和

00:23:59.139 --> 00:24:00.941 
閱讀列表旁

00:24:01.208 --> 00:24:02.910 
其中包括你感興趣的

00:24:03.343 --> 00:24:05.279 
不同來源的
鏈接流

00:24:05.979 --> 00:24:08.949 
推特 領英 
微博賬戶的鏈接

00:24:09.016 --> 00:24:10.851 
都會自動
顯示

00:24:11.418 --> 00:24:14.788 
此外 在iOS 8和Safari 
Yosemite版本

00:24:15.122 --> 00:24:17.658 
我們爲用戶
增加了收藏網站

00:24:17.724 --> 00:24:21.094 
RSS訂閱功能
使其可以直接

00:24:21.161 --> 00:24:22.829 
在Shared Links顯示

00:24:23.330 --> 00:24:26.233 
在截屏中 大家可以看到
我的推特賬戶以及

00:24:26.500 --> 00:24:29.469 
訂閱的部分網站
是分散狀態

00:24:30.771 --> 00:24:34.074 
在iOS 9和Safari的OS
X ElCapitan版本中

00:24:34.441 --> 00:24:36.376 
我們添加了
新的方法

00:24:36.443 --> 00:24:39.479 
可以直接在Safari的
Shared Links中獲取內容

00:24:39.847 --> 00:24:41.815 
這些是Shared
Links app擴展

00:24:42.182 --> 00:24:43.917 
這是新的app擴展類型

00:24:44.218 --> 00:24:47.721 
對於iOS和OS X
有着同樣的API

00:24:48.755 --> 00:24:51.925 
先從生成新
app擴展開始

00:24:51.992 --> 00:24:53.827 
就像我們剛
介紹內容攔截器時那樣

00:24:54.328 --> 00:24:58.665 
你生成新的目標
在感興趣的平臺

00:24:58.832 --> 00:25:00.467 
選擇Shared Links
擴展

00:25:01.368 --> 00:25:06.139 
若要app擴展能
在高層級運行

00:25:06.340 --> 00:25:09.710 
這需要在正確的
時機調用app擴展

00:25:09.910 --> 00:25:13.080 
你會返回
NSExtension項的列表

00:25:13.580 --> 00:25:15.716 
在Shared Links app
擴展的情況下

00:25:16.583 --> 00:25:19.219 
每個NSExtension
會直接轉爲

00:25:19.286 --> 00:25:21.355 
Shared Links項

00:25:21.655 --> 00:25:24.224 
這裏有NSExtension項的
白板 還有我們

00:25:25.292 --> 00:25:27.828 
準備生成的
Shared Links項

00:25:27.928 --> 00:25:30.631 
我將向大家介紹
怎樣通過代碼來完成

00:25:31.098 --> 00:25:34.801 
先在NSExtension項
定義部分用戶信息

00:25:35.269 --> 00:25:37.905 
我們首先要定義的
是每個NSExtension項的

00:25:37.971 --> 00:25:39.506 
標識符

00:25:39.940 --> 00:25:41.808 
app擴展返回的

00:25:41.875 --> 00:25:45.145 
NSExtension項
不會有重複的標識符

00:25:46.180 --> 00:25:50.350 
接着來定義URL字符串
當用戶選擇Safari的

00:25:50.517 --> 00:25:53.687 
Shared Links項時
這就是加載的內容

00:25:55.189 --> 00:25:59.159 
然後 我們定義Shared
Links項的出版日期

00:25:59.493 --> 00:26:01.728 
Safari使用每項的日期

00:26:01.995 --> 00:26:04.765 
在用戶的Shared
 Links內部

00:26:04.831 --> 00:26:07.734 
不同來源分散項 

00:26:08.535 --> 00:26:09.369 
最後

00:26:09.436 --> 00:26:11.338 
你可以定義
顯示名稱

00:26:11.405 --> 00:26:13.974 
這會在Shared Links
項的頂部顯示

00:26:14.875 --> 00:26:15.742 
要注意兩點

00:26:16.043 --> 00:26:18.645 
獨特的標識符
必須與擴展的

00:26:18.779 --> 00:26:21.682 
多種實例化
相一致

00:26:22.082 --> 00:26:24.918 
如果擴展需要
多次調用

00:26:24.985 --> 00:26:27.054 
並返回相同的
Shared Links項

00:26:27.454 --> 00:26:30.557 
獨特的標識符需要
是時間相同

00:26:31.091 --> 00:26:33.660 
顯示名稱可以
完全可選

00:26:34.661 --> 00:26:37.998 
如果沒有設定 
Safari將使用

00:26:38.198 --> 00:26:40.033 
Shared Links
app擴展的顯示名稱

00:26:41.869 --> 00:26:44.471 
然後 我們定義
Shared Links項的標題

00:26:44.738 --> 00:26:48.041 
這就是NSExtension項的
屬性標題

00:26:49.843 --> 00:26:53.046 
然後定義Shared
Links項的說明文字

00:26:53.614 --> 00:26:55.782 
即NSExtension項的
屬性內容

00:26:55.849 --> 00:26:57.184 
文本

00:26:57.718 --> 00:27:00.487 
如果內容太多 
二者都會

00:27:00.554 --> 00:27:02.189 
自動省略

00:27:03.724 --> 00:27:05.993 
這是Shared Links項的
全部文本

00:27:06.293 --> 00:27:07.861 
我們看到的圖像
會怎樣呢？

00:27:08.095 --> 00:27:11.298 
左上角的圖標
是NSExtension項

00:27:11.365 --> 00:27:13.834 
附件數組中的
首次輸入

00:27:14.501 --> 00:27:17.938 
在本例中 我會
使用擴展束中的一個圖像

00:27:18.071 --> 00:27:20.374 
但是你可能會
從這裏的Web抓取一個圖像

00:27:20.774 --> 00:27:24.611 
右上角的圖標
就是你的app圖標

00:27:24.945 --> 00:27:27.581 
因此如果返回
多個Shared Links項

00:27:28.115 --> 00:27:30.017 
而且是不同的
顯示名稱

00:27:30.984 --> 00:27:35.289 
右上角的圖標
將提供app的品牌化

00:27:35.989 --> 00:27:41.428 
讓用戶知道這些內容
是來自你的app

00:27:41.495 --> 00:27:45.065 
一點提示 如果這是
首次使用NSExtension項

00:27:45.465 --> 00:27:47.734 
那麼NSExtension項的
所有屬性

00:27:48.035 --> 00:27:50.671 
屬性標題
屬性內容文本

00:27:50.838 --> 00:27:54.541 
和附件 必須在設置
用戶信息後完成設置

00:27:55.609 --> 00:27:58.946 
這就是從Shared Links
內部獲取內容的全部所需

00:27:59.446 --> 00:28:01.715 
我想有請阿萊克斯
回來 介紹另一個演示

00:28:02.316 --> 00:28:03.150 
阿萊克斯?

00:28:12.693 --> 00:28:13.527 
好

00:28:14.161 --> 00:28:17.331 
我有些內容想放在Shared
Links當中

00:28:17.531 --> 00:28:19.266 
我會製作
Shared Links擴展

00:28:20.400 --> 00:28:21.935 
先來給大家
看看我說的是什麼意思

00:28:27.140 --> 00:28:27.975 
好

00:28:30.477 --> 00:28:34.181 
如果打開Safari
大家可以看到在側邊欄

00:28:34.948 --> 00:28:39.887 
我有一束來自
推特賬戶訂閱的鏈接

00:28:40.554 --> 00:28:43.991 
我希望把Shared Links 
擴展的用戶準備的內容

00:28:44.458 --> 00:28:45.792 
放在這裏

00:28:46.827 --> 00:28:48.695 
我們來製作
Shared Links擴展

00:28:51.031 --> 00:28:51.932 
打開Xcode

00:28:53.433 --> 00:28:55.736 
生成新項目

00:28:55.802 --> 00:28:58.305 
我們按照OS X來做
但是在iOS上也一樣

00:29:06.780 --> 00:29:08.382 
現在 把它放在桌面

00:29:10.551 --> 00:29:15.923 
好的現在 從這裏進入文檔
新建 目標

00:29:17.357 --> 00:29:22.663 
在OS X應用擴展下
這裏有Shared

00:29:22.729 --> 00:29:24.898 
Links擴展模板
布萊恩剛給大家看過

00:29:27.601 --> 00:29:28.435 
我們繼續

00:29:29.603 --> 00:29:33.607 
My Shared Links擴展

00:29:35.209 --> 00:29:36.043 
這個名稱不錯

00:29:37.010 --> 00:29:40.314 
激活擴展方案

00:29:40.948 --> 00:29:42.249 
好 我們激活了
因爲想要

00:29:42.316 --> 00:29:44.751 
在Safari上
運行擴展

00:29:47.754 --> 00:29:50.557 
現在新的目標

00:29:50.624 --> 00:29:53.794 
形成了My Shared
Links擴展

00:29:54.795 --> 00:29:57.531 
它把模板
Swift放在這裏

00:30:00.234 --> 00:30:03.403 
這個Swift
非常簡單

00:30:04.304 --> 00:30:09.443 
它剛生成了NSExtension項
填入了用戶信息

00:30:10.511 --> 00:30:13.480 
提供了屬性標題
和部分上下文文本

00:30:14.848 --> 00:30:16.316 
不好意思 是內容文本

00:30:16.750 --> 00:30:20.587 
它用一個數組調用了
完全請求返回項

00:30:20.954 --> 00:30:23.290 
在本例中 就是一項

00:30:25.359 --> 00:30:26.760 
我們來看看
它在框外做了些什麼

00:30:30.197 --> 00:30:31.765 
用Safari來運行

00:30:36.069 --> 00:30:37.638 
我們用Xcode
進行調試

00:30:37.804 --> 00:30:39.740 
工具想知道
目前發生的情況

00:30:46.079 --> 00:30:47.347 
就這樣

00:30:47.414 --> 00:30:52.019 
這裏我們有
來自My Shared Links

00:30:52.085 --> 00:30:56.089 
擴展的部分內容
如果我點擊它

00:30:57.324 --> 00:31:00.761 
就會被帶到
Apple.com 非常棒

00:31:00.894 --> 00:31:02.429 
這就是模板
表示的內容

00:31:03.297 --> 00:31:08.302 
現在 不過我希望把內容
放在這裏

00:31:08.368 --> 00:31:13.941 
我想把Swift
稍作調整

00:31:18.178 --> 00:31:22.850 
我帶大家看一下
怎麼做

00:31:22.916 --> 00:31:23.851 
非常簡單

00:31:24.751 --> 00:31:29.022 
只要發送NSURL
請求

00:31:29.556 --> 00:31:30.457 
到我的服務器

00:31:31.391 --> 00:31:32.726 
HTTPS

00:31:32.793 --> 00:31:35.295 
一定要用HTTPS

00:31:35.362 --> 00:31:37.564 
cutepuppiesand
cats.com

00:31:37.631 --> 00:31:38.866 
斜槓data.JSON

00:31:39.533 --> 00:31:42.603 
我給大家看看
發送請求後 

00:31:42.736 --> 00:31:43.837 
將會收到的代碼

00:31:46.740 --> 00:31:49.109 
就是帶有幾個鏈接的

00:31:49.576 --> 00:31:50.444 
JSON API

00:31:50.511 --> 00:31:52.012 
還有我想放入

00:31:52.746 --> 00:31:53.780 
Shared Links的部分內容

00:31:57.918 --> 00:31:58.752 
好

00:31:58.819 --> 00:32:00.787 
這會生成一個請求
獲得JSON

00:32:01.655 --> 00:32:03.423 
它會爲解析的

00:32:04.625 --> 00:32:07.995 
JSON數組的
每個值解析JSON

00:32:08.896 --> 00:32:11.865 
從中會得到一些
字符串

00:32:12.766 --> 00:32:16.003 
它會填入
通過部分

00:32:16.069 --> 00:32:19.139 
內容製成的
NSExtension項

00:32:19.339 --> 00:32:25.345 
我將URL作爲獨特的
識別符 因爲我知道

00:32:25.612 --> 00:32:27.114 
對於我的數據而言
它們都是獨特的

00:32:27.414 --> 00:32:29.249 
如果這對你的數據而言
不是這樣

00:32:29.716 --> 00:32:32.486 
那麼就想辦法爲每個
獲得獨特的值

00:32:33.720 --> 00:32:36.356 
我有個圖標

00:32:38.825 --> 00:32:40.160 
需要添加

00:32:44.198 --> 00:32:45.032 
就這樣

00:32:45.332 --> 00:32:47.201 
就是我的小狗圖標

00:32:48.402 --> 00:32:49.570 
我把它的位置放錯了

00:32:51.138 --> 00:32:52.639 
我們把它放在演示中

00:32:55.509 --> 00:32:57.277 
我需要加上它

00:33:02.416 --> 00:33:03.617 
加上小狗圖標

00:33:05.485 --> 00:33:07.721 
我還要加

00:33:08.355 --> 00:33:09.623 
在這個目標上

00:33:10.123 --> 00:33:11.692 
My Shared Links擴展

00:33:11.758 --> 00:33:13.460 
那麼 My Shared
 Links擴展

00:33:13.861 --> 00:33:14.795 
就可以訪問這個圖標

00:33:17.364 --> 00:33:18.799 
我們現在來運行一下

00:33:18.866 --> 00:33:19.833 
我們來看看會怎樣

00:33:24.438 --> 00:33:25.572 
首先關閉Safari

00:33:29.309 --> 00:33:31.612 
就這樣

00:33:32.112 --> 00:33:33.981 
我們就來運行這個
看看會怎樣

00:33:36.450 --> 00:33:38.886 
工具需要了解
目前發生的情況

00:33:45.058 --> 00:33:47.861 
我的內容
還沒有顯示

00:33:48.028 --> 00:33:49.029 
我們來看看是什麼問題

00:33:50.464 --> 00:33:51.865 
如果直接看這裏

00:33:52.766 --> 00:33:54.034 
會看到一系列錯誤

00:33:55.469 --> 00:33:58.805 
如果打開控制檯
來看系統

00:33:58.872 --> 00:34:02.209 
日誌控制檯
你會看到

00:34:04.077 --> 00:34:05.579 
一系列沙箱異常

00:34:06.480 --> 00:34:07.581 
這是因爲

00:34:08.248 --> 00:34:09.949 
我的
擴展是沙箱的

00:34:10.217 --> 00:34:12.219 
爲確保用戶安全

00:34:13.053 --> 00:34:15.422 
這些擴展只能訪問
有必要的內容

00:34:15.589 --> 00:34:17.824 
這一獨特的擴展

00:34:17.891 --> 00:34:19.226 
現在還不能
訪問網絡

00:34:21.295 --> 00:34:23.063 
我們試着提出
NSURL請求

00:34:23.130 --> 00:34:24.498 
我們的確需要

00:34:25.666 --> 00:34:26.567 
訪問這個網絡

00:34:26.632 --> 00:34:27.835 
如果我點擊

00:34:28.368 --> 00:34:29.902 
這裏的項目

00:34:31.138 --> 00:34:33.974 
然後進入功能

00:34:35.409 --> 00:34:36.243 
這裏

00:34:36.777 --> 00:34:38.512 
我需要
檢查對外的連接

00:34:39.213 --> 00:34:40.047 
以便

00:34:40.313 --> 00:34:42.850 
這個擴展

00:34:43.650 --> 00:34:44.818 
可以發送

00:34:45.351 --> 00:34:46.820 
初始的對外
連接以獲取

00:34:46.887 --> 00:34:48.255 
JSON數據 

00:34:53.360 --> 00:34:54.194 
好

00:34:54.460 --> 00:34:55.329 
好 我們運行一下

00:35:08.609 --> 00:35:09.510 
就這樣!

00:35:14.815 --> 00:35:16.149 
就在我們想要的位置

00:35:16.216 --> 00:35:18.285 
現在有了內容

00:35:18.719 --> 00:35:20.454 
以及內容的鏈接

00:35:20.821 --> 00:35:22.756 
我可以將用戶

00:35:22.956 --> 00:35:26.093 
從Safari 
Shared Links帶到網站

00:35:27.394 --> 00:35:28.962 
如果有內容
想要放入

00:35:29.029 --> 00:35:30.731 
Safari Shared 
Links

00:35:31.231 --> 00:35:33.233 
試着製作Shared 
Links擴展

00:35:33.567 --> 00:35:34.968 
好的 該你了 布萊恩！

00:35:44.978 --> 00:35:45.812 
<br/> 
謝謝 阿萊克斯

00:35:45.879 --> 00:35:47.614 
跟我們演示了
幫助用戶

00:35:47.781 --> 00:35:50.150 
幫助用戶使用Shared
Links app擴展

00:35:50.217 --> 00:35:51.785 
發現你的內容
是多簡單的事情

00:35:52.686 --> 00:35:54.288 
我們今天
都聊了些什麼？

00:35:54.821 --> 00:35:56.323 
我們介紹了
爲iOS編寫

00:35:56.390 --> 00:35:58.125 
內容攔截器
的功能

00:35:58.825 --> 00:36:00.961 
如果你在Mac上有
內容攔截器

00:36:01.328 --> 00:36:03.030 
你就肯定會
用到這個新款API

00:36:03.096 --> 00:36:05.766 
它可以爲用戶
提供更快

00:36:05.966 --> 00:36:08.268 
內存更高效的
瀏覽體驗

00:36:10.070 --> 00:36:12.573 
若在Safari 
ExtensionsGallery

00:36:12.639 --> 00:36:14.041 
有擴展
請再次提交

00:36:14.107 --> 00:36:17.411 
這樣你的新版本就可以
得到Apple的簽署和主持

00:36:17.878 --> 00:36:19.346 
如果在這裏沒有
擴展

00:36:19.580 --> 00:36:21.048 
現在就是開始的絕好時機

00:36:21.882 --> 00:36:22.716 
最後

00:36:22.783 --> 00:36:25.319 
如果你有一組鏈接
在Shared Links中

00:36:25.986 --> 00:36:27.955 
可以運用
你現在可以直接

00:36:28.021 --> 00:36:30.657 
把它們放在Safari
這樣用戶就可以

00:36:30.724 --> 00:36:31.959 
找到它們 並返回你的網站

00:36:33.527 --> 00:36:37.064 
如果有任何問題
可以聯繫約翰·戴維斯

00:36:37.130 --> 00:36:40.033 
我們的Web
技術開發顧問

00:36:40.667 --> 00:36:41.735 
很快

00:36:42.135 --> 00:36:45.005 
我們還有博客
介紹Safari

00:36:45.072 --> 00:36:48.842 
內容攔截的所有
功能 是在

00:36:49.176 --> 00:36:51.144 
WebKit.org博客上

00:36:51.512 --> 00:36:55.415 
儘可以通過Apple開發人員
論壇和我們聯繫

00:36:56.617 --> 00:36:59.853 
有關講座
如果你有app

00:36:59.920 --> 00:37:01.722 
其中會顯示Web內容

00:37:01.788 --> 00:37:04.191 
可以查看《介紹Safari
視圖控制器》的部分

00:37:05.425 --> 00:37:07.094 
正如大家所見
我們用Web檢測器

00:37:07.160 --> 00:37:09.563 
幫助生成內容攔截器

00:37:09.630 --> 00:37:11.431 
若想了解
Web攔截器的更多詳情

00:37:11.698 --> 00:37:14.168 
可以查看《使用Safari
來交付和

00:37:14.234 --> 00:37:16.136 
調試響應式Web設計》
講座

00:37:17.504 --> 00:37:18.605 
我將...

00:37:18.672 --> 00:37:22.309 
阿萊克斯和我 在本次講座後
會直接去媒體實驗室A

00:37:22.576 --> 00:37:24.278 
如果有問題 
就來找我們

00:37:25.579 --> 00:37:27.614 
謝謝！
祝大家週五過得愉快