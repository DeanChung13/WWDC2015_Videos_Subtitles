傑森·比弗: 下午好
歡迎來到Cocoa Touch講座
我是傑森·比弗
是高級工程經理在iOS小組工作
iOS 9的最新內容有很多
不過 我首先希望來回顧一下在過去幾年所做的改進
自從iOS 6起 我們開始爲怎樣構建iOS應用等
較大改進奠定基礎我們開始在所推出的每個主要版本中
都體現了這樣的改進
在iOS 6中 我們增加了自動佈局
以便於輕鬆構建動態和多功能界面
以便對適用尺寸和屏幕方向
以及本地化等方面的改進
做出反應
在 iOS 7中 我們推出了動態類型
這可以幫助在用戶可選的
文字大小應用中實現漂亮的印刷樣式
與自動佈局一道
界面可以與用戶所選文本大小的改變自動適應
通過採用動態類型系統
可以在文本渲染應用中免費
爲文本的可讀性實現改進
在iOS 8 我們做出的改進可能算得上是最大
我們引入了適應性概念
這是指應用應該
在運行環境下適應改變
這一概念的基礎就是尺寸類別
尺寸類別會根據
空間是否會受到具體的尺寸束縛導致
應用的用戶界面發生結構改變
在這裏所顯示的設置應用中在iPad和iPhone
運行的代碼完全相同
尺寸類別的不同導致用戶界面的結構變化
尺寸類別iKit視圖控制器許多部件的適應性
視圖控制器的呈現搜索結果
上拉菜單等等所有這些都
與尺寸分類和必須配合使用的可用空間相適應
我們去年引入
適應性概念的時候我們爲何會往這方面發展還不是很清晰
在應用中我們通常是全屏
在應用運行的時候一般不需要改變用戶界面結構
隨着多任務處理的引入
做出上述改進的原因就很清晰了
你無需針對具體硬件
構建兩種不同的體驗
針對用戶運行的app你可以提供
根據尺寸打造的體驗連續性
應用這些基礎性基礎不僅app
可以用於我們所推出的所用硬件
也可以支持這些多任務處理的新功能
以及我們已有合作的已採納所有這些改變的開發人員
在某種情況下真是隻需要幾分鐘時間就可以讓他們的app
與我們的app無縫對接
需要特殊處理的是Picturein Picture功能
如果應用支持背景媒體播放可以在iOS 9中
使用新的API啓動播放器
支持 Picture inPicture 功能
要記住 Picture inPicture 功能
和所有多任務處理一樣應用
需要作爲“良民”確保
不會干擾整體用戶體驗
本週 還有幾場多任務處理的講座
《iPad多任務處理入門》
《基於媒體的App多任務處理要點》
以及《爲多任務處理優化App》
我們來繼續介紹iOS 9的最新內容
首先是自動佈局
我們先來講講最新的UI佈局指南分類
以免你在自動佈局束縛中用到了
額外的視圖 現在可以使用佈局指南
以避免視圖層次搞亂
我們介紹的是默認的兩個佈局指南
佈局邊界指南和可讀內容指南
可以在UIView使用這些屬性
在定義視圖內容方面
允許更多的表達性
這些會替代我們在iOS 8中所介紹的佈局邊界
在編寫新代碼時 都應使用佈局指南在重新訪問舊編碼時
也應該將邊界替換爲佈局指南
我準備花些時間介紹一下第二種情況
可讀內容指南
當文本主體很大時
文本行長度與文本的可讀性
和易讀性都有很大關係
如果文本行太寬就像這樣
就很難看到文本行起始位置閱讀時
也就很難接上下一行
相反 如果文本行太窄
目光太過頻繁地來回轉移則會打斷閱讀節奏
文本行的理想長度取決於許多因素
包括字體 大小 行距
不過通過使用可讀內容指南
可以確保無論用戶文本大小
或應用渲染文本的可用空間
如何文本的可讀性都不會有問題
我們來談談怎樣使用佈局指南
減少應用中的視圖數量
比如說有個視圖是要展示若干星球
我們希望以父視圖爲中心來展示
或是沿着x軸排開
在使用自動佈局束縛之前
我們要先在視圖層次中引入一系列
額外視圖來實現這一點
現在先來定義佈局指南
這定義的是視圖安排的空間
比例我們也生成了另一組束縛
是以這些視圖爲中心
然後只需改變活動狀態的束縛就可以實現漂亮的動畫是這個樣子
本例中 我們同時改變了所有的束縛
但是如果我們是在不同的時間
使用框架動畫改變束縛
就會實現諸多非常有趣的效果
在iOS 9我們還將StackView引入iOS
以便於將子視圖作爲堆棧管理
可以實現垂直或水平排布
StackView在覆蓋下使用自動佈局
不過可以管理所有的束縛
可以調整間隔對齊
可以在可用空間允許均等
或按比例調整視圖分配方法
StackViews還可以嵌套
可以將StackView作爲另一個StackView的元素
以便生成非常豐富的佈局
這些佈局將自動調整
內容顯示方式並根據可用空間
進行調整像這樣
我們還引入了快捷欄
連上硬件鍵盤後在屏幕底邊
或軟件鍵盤上有顯示
快捷欄包括字體控制 如黑體 斜體
下劃線 剪切 複製和粘貼
還可以根據應用自定義
符合UI文本輸入協議的任何內容
可以返回至使用該方法的輔助輸入項
UI文本輔助輸入項是iOS 9中的新分類
有着兩個屬性用於確定
引導和追蹤欄-按鈕組
這樣就可以輕鬆在這裏加入自己的元素
現在正如在State of the Union專題會所見
我們不再必須在單一的故事板上
爲應用準備整個界面
可以將故事板彼此相連
我們還提供瞭解開引線的方法
我們現在可以在操作系統實現完全的從右至左支持
如果曾做過從右至左的語言本地化
並在iOS 9上連接了app
這一切也都將在app上自動實現
所有的UI Kit控件都將自動反轉
注意導航也發生了反轉
所有的動畫也都反轉
列表視圖單元格佈局甚至滑塊和開關
也都發生反轉
集合視圖也會自動反轉佈局
流向改爲從右至左
這裏我們看到起始標記的滑動要求向右滑動
未讀標記要求是向左滑動
視圖控制器和視圖上有兩個屬性
名爲語義內容屬性
可以確定內容如何排布
默認狀態下 所有內容都會自動反轉
不過可以按照應用中
所需通過自定義覆蓋這些屬性
還有一種方法
可以爲具體的內容屬性獲取佈局方向
語義內容屬性有着5個值之一
第一個未明確這是默認狀態
除非有理由改變UI Kit做的事情
這個值不用管它
如果有一組控件代表播放
快進和倒退等播放控件
可以使用播放獲取佈局方向
如果有一組控件代表或導致
UI中出現部分方向改變
例如 文本對齊控件文本編輯器中的左中右
可以使用獲取佈局方向
最後 還有兩個額外的值
可以執行從左至右
或從右至左的佈局
對於圖像而言 UI Kit不清楚
圖像是否應該在任何情況下都默認反轉
比如照片這類用戶內容
就不應反轉而在應用中的控件部分
則應該進行反轉
因此在UI圖像的從左到右有屬性或方法
可以讓你告訴我們是否想反轉圖像
另外還有一個屬性可以詢問圖像是否已經反轉
鼓勵大家都到國際界面的
最新UI Kit支持看看了解一下
怎麼讓app支持從右至左的語言
關於用戶友好性現在可以使用
更多的語音 比如亞歷克斯那樣以及AV
語音合成中的高質量語音
我鼓勵大家在關於 iOSAccessibility 方面
瞭解更多怎樣讓app實現用戶友好性的內容
大家可以看到過我們在iOS 9中
引入一系列最新文本編輯手勢
這些手勢可以在屏幕底部的鍵盤上操作
或也可以在文本區操作
它們可以實現間接移動插入點
可以輕鬆實現選擇詞語句子或段落
只需多次點擊即可
還可以輕鬆擴展現有的選擇
連同我們介紹的快捷欄
你可以輕鬆訪問 複製和粘貼而無需移動到文本
文本互動操控可以相當輕鬆便捷
現在在應用中什麼都不用做
來運用這些文本編輯手勢
不過如果在自己應用中的文本視圖中
自定義了這些手勢
應該確認不要與
最新的系統文本手勢發生衝突
在iOS 7中 我們增加了
發現鍵盤硬件鍵盤命令的應用支持
App可以有自己的命令
比如生成新文檔的命令
這對已經瞭解這些命令的用戶
很是方便但是無法發現
這些命令是什麼
在 iOS 9中 我們引入了最新鍵盤命令探索功能
HUD 如果持續按下硬件鍵盤上的命令鍵並且保持片刻
HUD將會顯現告知此刻
可用的命令組是什麼
注意 這取決於上下文
根據當時應用的狀態不同
你會獲得不同的命令組
因此 並不是看到整個命令組部分啓動 部分關閉
而是隻能看到目前可以應用的部分
在應用中運用 只需要爲爲每個主要命令
設置可探索功能標題
UI Kit可以自動找出
哪些命令在當時可以使用
我們可以聊一聊觸屏事件
在屏幕上跟蹤在手指和屏幕上
產生的筆觸之間會有一些固有延遲
需要花些時間掃描硬件
完成所有中間處理和繪圖
再將結果完全顯示出來
這就是所謂觸屏顯示延遲
大部分用戶在大多數情況
不會注意到這個延遲
當用戶移動手指足夠快時延遲纔會明顯
儘管iOS已經具備業界領先的觸屏顯示延遲
在iOS 9中我們將延遲水平又做了大幅改進
在屏幕上跟蹤跟蹤觸控時
UI Kit會隨着每次屏幕刷新
通知應用這樣應用就可以更新狀態
在部分更新款的硬件中
觸屏更新的頻率要超過顯示器
因此在上一次顯示器刷新後現在有新方法
可以訪問任何中間觸屏
對於繪圖應用而言這可以更流暢更準確地繪圖
作爲改善觸屏顯示延遲的第一步
我們現在還可以實現觸控預測
這會用到高級算法考慮觸控速度
加速度以及曲率
來預測觸控的走向
這就可以明顯減少繪圖時的延遲因爲可以預測出觸控
將發生的位置而不是後知後覺
我們其實還不止於此
除了提供觸控預測
我們在整個軟件堆棧都做了調整
以便進一步降低延遲我說過60毫秒以上
已經是業界領先水平
我們降到了不足30毫秒
我們還引入了UI Kit動態的一系列改變
首先是我們支持非矩形碰撞邊界
除了矩形我們現在還支持橢圓形
和基於路徑的碰撞
這樣就會更爲接近真實的碰撞相互作用
我們還支持大量的現場行爲
我們現在有線性和放射性引力就像這樣
彈力 阻力和速度或是噪音和湍流場
就像這樣 以及電場和磁場等
我們還支持 定義自己的場效的能力
最後 我們添加
一些新增額外附件類型
在簡單附上兩個對象之前
如果想以某種方式束縛它們的運動
必須要設置若干外部束縛
有了這些新增附件類型
可以極大簡化構建UI動態模型的過程
我們也添加了模糊半徑動畫的能力
爲實現漂亮的效果就像這樣
聚光燈效果的進出
我們還iOS 9中引入了一系列EPI改進
以優化在Swift中的應用
這是利用Swift的更好表達能力
並改善編譯時間類型檢查功能
在可空性方面 可以明確屬性行爲
以及返回值能否爲零值
我們已經介紹了整個API定義了
零論證或返回零值
是否擔保不爲零值
我們還有輕量級泛型
這是輕量級形式的類型參數化
可以實現Cocoa和CocoaTouch API的更好表達
例如 UI視圖的子視圖方式
可以返回UI視圖數組而不僅僅是ID數組
在《Swift最新內容》講座中有更多相關內容
iOS 9新增了通知能力可以實現針對用戶的文本輸入
或是來自客戶的文本輸入速度可以等同於回覆文本消息
UI用戶通知動作分類具備新的行爲屬性
如果設置文本輸入行爲
通知會有文本字段允許快速回復
還有一個額外的動作參數字典
可允許自定義Send按鈕的名稱
我們還要介紹最新的SF Safari視圖控制器
這可以實現用原生語言app顯示網絡內容
並用所有主要Safari UI元素所包圍
用戶對此已經非常熟悉
甚至還可以支持高級功能
比如Reader和自動填表
在《Safari視圖控制器介紹》講座中 會有更多內容
在iOS 9中 我們引入了一系列最新擴展點
可實現在系統中擴展其他應用
對於VPN 我們有三個新擴展點
有包隧道提供者可以幫助你
構建自己的VPN隧道協議客戶端
還有app-代理提供者可以幫助你執行
自己的自定義透明網絡代理協議客戶端
還有過濾器控制提供方和過濾器數據提供方
可允許實現動態裝置上內容過濾
對於Safari有兩個新擴展點
Shared Links可以讓應用明確可以在共享鏈接
用戶種子上顯現的內容
內容攔截擴展可允許定義
內容或頁面資源的子集
並防止其顯現
對於Spotlight還有一個擴展可以允許系統
對應用數據進行索引而且還可以在背景完成
這樣就無需啓動應用來重新對
app內容進行索引
在《App搜索介紹》講座中有更多相關內容
最後 音頻單元或核心音頻插件可以作爲樂器 音效
或音頻發生器來使用
直至現在 iOS用戶還在僅限於
Apple提供的內置音頻單元
在iOS 9中 我們增加了新擴展點
可以將自己的音頻單元連入iOS
大家在《音頻單元擴展》講座中可以瞭解更多內容
很多人都問到我我也很高興地宣佈
我們已經發布全新Swift和Objective-C API
用於聯繫人互動
謝謝
大家在《iOS 10的iOS聯繫人框架介紹》中
可以瞭解更多內容
對於Wallet和Passkit在銀行和商家應用中
現在可以從零開始提供卡片
如果有特殊授權
還可以靜默Apple Pay如果出現了
會影響應用的情況
因此 比如在應用在某種條件下
需要顯示條碼而且還連有NFC終端
通常會使得Apple Pay顯現
可以靜默這個功能這樣才能掃描條碼
在覈心位置app連接到iOS 9
或是晚些時候
背景位置跟蹤會有些改變
在CL Location Manager上還有新的API
要求一次位置更新
如果不需要持續更新位置
這是更爲有效方式
來獲得用戶的當前位置
對於MapKit 有若干新功能具備地圖視圖
第一是訪問3d Flyover View
現在可以顯示流量以及量表和刻度尺
已生成自己的自定義調出
在HealthKit中 可以直接實時訪問 Watch OS 2
傳感器數據還有若干新數據類型
跟蹤用戶水分的攝入量
跟蹤其在陽光下暴露的時間
以及生殖健康
新款API可實現更好的HealthKit
數據設備跟蹤更好地支持刪除數據
以及跟蹤鍛鍊的新款練習會話API
幾個月前 我們公佈了ResearchKit
可以用於開發人員和研究人員
創建醫藥研究app
ResearchKit現在包括iPad支持...
PureToneAudiometry
的新活動任務可用於確定
聽力閾值水平
以及簡單反應時任務
以便衡量用戶對事件的反應時間
還有一種圖像捕捉步驟可供使用
正如大家昨天所見我們對HomeKit做了部分調整
我們現在可以支持詳細變更通知
燈亮起時
就可以獲得具體的委託信息
明確特點和改動的配件
因此現在可以讓具體的燈亮起
而不是泛泛地房間裏有改動通知
HomeKit有4個預定義動作組 
早上醒來出門到家
上牀睡覺你可以完成這些標準動作
關燈 鎖門這類事情
確保車庫門關好
所有這類問題都無需用戶另行配置
在iOS 8可以生成定時觸發器
實現執行計劃場景
在iOS 9可以生成更爲複雜的觸發器
例如 要知道 當門鎖打開時
動作傳感器檢測到動作
這是在日出後30分鐘發生的事情
當然 Watch上還有HomeKit 可以用手錶
直接控制家中的設備
有Wi-fi功能的附件可以遠程連接
即便沒有Apple TV也沒關係
還可以與它們通過iCloud
直接溝通
有藍牙功能的配件
可以自動連上Wi-Fi
即便超出了配件的藍牙有效範圍
也依然可以控制
最後我們在家中的若干新項中
加入標準定義
對於CloudKit而言我們更新了
公共數據庫的限制和定價
但是更令人興奮的是我們可以實現...
CloudKit WebServices
來整合網絡應用
本週還有兩個講座是關於CloudKit 
《CloudKit最新內容》和《CloudKit訣竅和技巧》
至此爲止 UI文檔
和動作控制器會將發送給其他app的
每個文檔都進行備份
現在 只要打開到位只要是在iCloud中儲存 
app可以要求直接打開文檔
可以在info.plist中
添加祕鑰
聲明適合執行新的代理方式
來直接打開文件即可
我們將在《構建基於文檔的app》講座中詳細討論這個問題
現在 許多應用包括的資源在用戶首次
開啓應用時並不需要
將app可能會用到的每個資源都包括在內  會令app
捆綁包太過龐大影響安裝速度
甚至會導致超出OTA限制
這會影響銷售
爲解決這個問題我們來介紹按需資源
應用會上傳單一的文件包恰巧是滿足當天
所需 但是當應用有需求時
內容可以動態下載
這些資產都是運用基於輸入信息
以及用戶行爲的啓發式邏輯處於智能化緩存狀態
在Xcode中 資產都是使用簡單標籤分組
我們先來講講...
NS BundleResourceRequest 的新分類
這可以實現用給定的標籤要求所有資源
一旦這些資源得以下載你可以使用熟悉的API去訪問
　比如UI圖像命名圖像等
還有辦法在Xcode中進行檢測
模擬並未獲得資源而對服務器提出要求
Xcode可以像服務器一般工作
嚮應用發送相應資源
現在 我們介紹另一種新技術
來解決應用大小的問題就是app分割
現在 應用常帶有與用戶安裝的硬件
不相關的資產和可執行內容
這一分割技術可以提供用戶設備
所需的資源和可執行內容部分
使用應用分割技術處理App Store
可以自動生成併爲運行
iOS 9的設備提供應用的定製變量
這其中只包括設備相關的資源和可執行內容部分
在服務器運用這種技術
不相關的內容甚至都不會下載
這會節省安裝時間
並有希望將app處於OTA限制以下
我們還要介紹最新的NS數據資產分類
和設備上的這可以輕鬆獲取根據內存
圖像處理能力定製的內容
現在來看Game Center 我們加入了嘉賓玩家功能  
在Game Center的多玩家模式中 實現了新的配置
我們還統一了Game Center服務器環境
以便於開發和測試的流線化
最後 我們來介紹ReplayKit
這可以提供分享遊戲體驗的新方法
可以實現app輕鬆錄製視頻和音頻
並與其他用戶分享
在iOS 9中 SpriteKit支持Metal
適用於相應的系統支持
對於不支持Metal的系統它是開放式GL
這些都是自動完成無需人工幹預
還有一個全新的動作編輯器
當然它與按需資源緊密整合
在《SpriteKit最新內容》講座中有更多詳情
對於SceneKit在Xcode中有全新的場景編輯器
可以支持粒子 物理 
動作等等 
SceneKit還有相當多的新功能
場景轉換 音頻節點 模型i/o 
環境光遮蔽 光照圖以及許多其它功能
SpriteKit和SceneKit是構建遊戲
圖形界面的強大框架
對於遊戲它的強大之處不僅在於圖像能力
遊戲有實體和組件部分
還有代理在遊戲中都有着目標和行爲
需要發現路徑算法允許代理在遊戲附近導航
還需要AI允許代理決定之後
要採取怎樣的行動
參與遊戲所需的所有
這些元素現在都可在GameplayKit中找到
在《GameplayKit介紹》講座中還可以瞭解更多詳情
最後當然 我們要談談WatchOS 2
除了直接訪問現有的框架
還有新框架如Watch連結性
將app與電話和WatchKit連結 來搭建Watch錶盤組件
在《WatchOS 2 WatchKit介紹》中
可以瞭解更多詳情
本週所有講座的綜述在《探討WatchOS 2》
中有介紹
若要了解更多信息當然有文件資料
有在線論壇開發人員技術支持
謝謝希望大家這周過得愉快