構建App跟Researchkit
大家好！
我叫約翰·厄爾
是ResearchKit團隊的一名工程師
今天我要講講ResearchKit
以及如何促進App研究
今天 我的談話內容由四個部分構成
首先要講講什麼是ResearchKit
然後再談幾個問題
幾個影響App型研究設計的相關問題
雖然我的主旨是在闡述如何使用
ResearchKit構建App時
ResearchKit在研究App的具體功能
最後 由於它是一個開放源碼項目
我要講講大家該如何促成ResearchKit
那我們就開始吧！
什麼是ResearchKit？
簡而言之它是一個開放源碼工程
可以在GitHub上使用
但是如果延伸一下
我們首先需要了解一點動機
即使您以前從未參與過醫學研究工作
但是類似工作您可能已經見過
無論是在大學還是在醫院
如果您已經參與了一項研究工作
您可能會打電話和調查員碰頭
別人給您解釋具體工作及其風險和效益
然後您可能要回答問題採集樣本比以往更頻繁
現在 這可是一個重量級模型
研究人員已經告訴我們它有三個問題
第一個問題是有限參與
在大學校園內貼傳單只是將人員參與
侷限在校園附近的居民
進行海量研究則需要很多研究團隊開展合作
這就意味着 如果開展研究頻率也不會太高
第二個問題是數據較主觀也不常見
經常是通過調查每月收集一次數據
或者週期更長
這就影響了提出的問題
限制了數據質量
第三個問題是單向通信
您曾經參與的研究工作具體結果您可能從未聽說過除非您認識調查員
這就是我們認爲App帶來的好處
App Store經銷模式輻射範圍很廣
可以幫助研究人員接觸更多研究對象
因此採用ResearchKit的前五種研究App
註冊參與者超過70,000人在他們的研究領域中
已經開展了很多研究項目這也是規模最大的一個
第二 App的數據可以持續流動
這與主觀不常見的人工收集數據形成鮮明對比
最後 App可以局部記錄
每個參與者的情況以便向他們反饋
在症狀管理方面的具體表現
並有助於保持他們的參與度
而且也不會增加調查人員的工作量
在Apple我們以前希望爲更多研究項目
讓這一點成爲現實這就是構建ResearchKit的原因
ResearchKit是一種開放源碼框架
可以在GitHub上使用
使用它 創建研究App更容易
無論是商用App
還是納入學術研究
現在iOS有了很棒的API
可以用來收集被動數據信息
比如HealthKit和CoreMotion
但是要成功開展App研究
還有很多方面需要了解
我們希望在這些方面，ResearchKit對您有所幫助
現在ResearchKit有三個模塊
第一個模塊是調查
ResearchKit提供標準UI模板
可以用來調查iPhone或iPad
我們採用了最常見的健康研究測量工具
對它進行了測試比如SF12或EQ5D
第二個模塊是知情同意
在人體觀察研究領域它是一項常規要求
爲了讓參與者充分了解研究細節
並在此情況下獲得參與者的同意
每項研究工作的細節都存在差異
因此ResearchKit會提供模板
在App過程中可以用來展示這種差異
ResearchKit的第三個模塊是現時任務
現時任務是一種半控測試項目
在此項目中參與者按步驟接受指令
通過裝置上的傳感器收集數據時
即可執行該任務
例如在這種步態與平衡任務中
我們在來回步行過程中將手機放入口袋
通過加速儀和陀羅儀可以收集步態評估數據
因此我們瞭解了ResearchKit三個方面
調查知情同意和現時任務
在發佈ResearchKit同時
與我們合作的調查人員向AppStore 提供了他們自己的App
即使現在我們也在使用這些Apps收集疾病相關數據
非常廣泛比如帕金森病、糖尿病、
心血管疾病、哮喘和乳腺癌
我們已與上述合作機構共同爲這些App
以及這些機構
共享的核心共用庫開放了源代碼
因此如果需要快速啓動它就能幫助您開始App
那麼App究竟具備哪些功能呢？
在適應階段它們都採用了
ResearchKit的知情同意模塊
但是之後一旦註冊參與者
它們會以幾種方式採集數據
首先它們採用ResearchKit的
調查模塊和現時任務模塊通過排程活動
採集更多主觀測量結果
此外它們採用HealthKit和CoreMotion
通過被動數據採集獲得了客觀度量值
而且 通過加入一份儀表盤標籤
解決了單向通信問題
因此參與人員可以查看和跟蹤
源自調查結果的兩種主觀量度值
比如情緒以及源自HealthKit的
客觀度量值如重量參數
因此正是ResearchKit和App在使用它
但是隨着ResearchKit的開發
我們對構建App型研究項目過程中
涉及的其它方面有了更好的瞭解
當時我們認爲這些對共享至關重要
因此在這裏我願意和大家一起分享我的一些心得
如果您是一名構建研究App項目的工程師
可能在項目團隊中並不只有您一人
還有很多事情需要其他成員去完成
這裏我可以就此作一些簡單介紹
也許最重要的就是聯繫與您所在單位有關的道德委員會
或機構評審委員會
以便就研究方案
通過某種形式的道德評審
爲此您需要決定向該參與者
通報研究情況究竟會意味着什麼
您會採用這種紙質形式
並且希望您能夠對它進行壓縮
最終適合移動App需要
在我們進入ResearchKit知情同意模塊時
我們會詳細闡述
接下來 由於ResearchKit不提供後臺服務
您需要計劃如何保持研究數據
因此可能需要您本人去調查
或與第三方服務提供商簽訂合同
任何一種方式您都需要爲數據安全和保密承擔責任
最後您還需要策劃如何共享研究數據
參與人員可能需要採用儀表盤標籤
或其它方式而調查人員則
可能要求您去尋求各方知情同意
因此如您所見實際App架構之外
還有各種各樣的問題
它們將對研究型App設計產生一定影響
更多相關資源
請登錄我們的網站ResearchKit.org
並且還可參閱
我們的ResearchKit用戶郵寄清單
通過上述網站和清單
可以接觸之前也順利完成任務的其他研究者
因此無需道別
接下來讓我們談談使用ResearchKit構建App
在研究過程中ResearchKit究竟能夠發揮什麼作用？
如上所述ResearchKit有三個模塊
調查模塊知情同意模塊
和現時任務模塊
ResearchKit所有這些模塊的
運行模式大致相同
要求用戶執行的每項活動
被確定爲一項任務
每項任務可以包含一個或幾個步驟
爲了執行一項任務您希望就此向用戶展示
爲此將使用任務視圖控制器
一個任務視圖控制器就是一個容器視圖控制器
有點像導航控制器或標籤條控制器這在UI工具箱您可能比較熟悉
在展示任務視圖控制器時
將進入該任務的第一步
然後在任務視圖控制器內顯示它是一個視圖控制器
可以顯示該步驟的數據
這一步結束時任務視圖控制器將
採集它輸出的結果並對該任務所有步驟
輸出的數據進行覈對
最後當任務完成時任務視圖控制器將通知委託代表
您也會瞭解任務結果
關於已經通過的步驟該任務結果將有一個相應步驟結果
如果超過一個步驟
相應會有若干步驟結果
這就是ResearchKit內的對象模型
現在我們深入瞭解一下其中一個核心對象
也就是上述步驟
下面我們看看各個步驟
在ResearchKit內一個步驟實際對應的
是一項ResearchKit任務中
用於每個頁面的基本模板
並且子類是一種步驟
剛好是一個抽象基類對於ResearchKit不同模塊
需要的每個不同步驟而言
可以用於每個不同類型
如調查
因此您可能會收到一項指令一個調查問題和調查問卷
或者對於其它而言如現時任務需要倒計時器
對於認知型任務可能需要玩記憶遊戲
因此一般情況下這個基本模板
會在頁面中央展示該步驟內容
爲此已有預定義要素下面我們會談及
此外一般還包括向前導航控制器
在步驟視圖控制器內顯示
從代碼來看它的效果如何呢？
將ORKStep作爲抽象基類
並且它是該對象內的一個子類
因此我要說說使用Objective-C
撰寫這個框架文件但從Swift完全可以使用
並且我們還在此基礎上增加了爲空性和泛型
因此它可以和Swift 2一起使用
那麼基類
有哪些重要特徵呢？
第一項特徵也是最關鍵特徵即標識符
這是您作爲開發人員需要提供的一串字符
它可能是人工可讀字符串也可能是UUID
或者與本步驟某項記錄
以及數據庫中相應任務對應的標識符
該標識符的重要性在於
它將該步驟與相應步驟結果連在一起
並且在您的任務語境中必須是唯一標識符
接下來所有步驟都有一個標題和文本
並且一般來說它們都適合每個步驟模板中的
同一對應位置
如果您正在寫一個問題例如針對調查中的一個問題步驟
一般來說您會設置一個短標題
並且這個實際問題本身會對文本特徵進行覈實
還有一項特徵需要說明一下那就是備選性質
因此調查和ResearchKit中的每個步驟
或者很多其它步驟可能都屬於備選性質
實際上它們默認爲備選性質
如果需要關閉它比如因爲需要提供特定答案
您就可以利用這種特徵
那就是所謂的步驟但是爲了使用一項步驟
需要將它放入任務文本
現在ResearchKit中的任務還沒有一種抽象基類
相反它只是一份協議
定義了任務視圖控制器與每項任務的互動方式
仍然有一項關鍵特徵即識別符
與在本App中可能收集的其它任務結果相比
它是該任務結果的唯一識別方式
接下來雖然任務視圖控制器需要
瞭解該任務中下一步驟的具體內容
爲此我們根據步驟協議方法對該步驟進行了定義
其中我們從任務視圖控制器通過了當前步驟
通常情況下您剛好回到下一步驟
但有時您想了解...
您想根據現有結果決定採用哪種測試方案...
需要展示哪一步
例如如果我選了A您希望進入A步
如果我選了B您希望進入B步
爲此任務視圖控制器將通過該任務一項結果
您可以用來做出上述決定的現有任務結果
在尋找該任務的第一個步驟時
任務視圖控制器將通過零作爲當前步驟
並且該任務完成時
告知任務視圖控制器沒有其它後續步驟
就此已經沒有能夠讓您歸零的其它步驟了
同樣任務視圖控制器
可能會詢問您的任務：之前應該有哪些步驟
因此通過方法前步驟您可以採取一些措施
比如防止後向導航
因此關於任務協議
有多種其它特徵和方法
執行一項任務可能比較複雜
因此ResearchKit包括ORKTask的執行
它是單純情況下的ORKOrder任務
其中您希望採用連續順序展示您的各種步驟
因此在這裏您通過一個標識符和一個步驟陣列
即可讓這些步驟從只讀特徵返回
但是任務視圖控制器
只是通過ORKtask協議與它的預訂任務互動
因此您可以按步驟呼叫而不是對該步驟特徵進行評估
現在如果您需要條件邏輯
還有一種預訂任務版本是它的一個子類
稱爲ORKNavigable預訂任務
通過它可以明確結果相關述語
以及相應終點步驟
這是最近通過外部促成方在該框架基礎上
增加的內容今天我沒有時間談論它
但是您有機會瞭解GitHub相關細節
任務就談到這裏
但是執行一項任務需要使用任務視圖控制器來展示這項任務
下面讓我們看一看任務視圖控制器
您將啓動一項任務
並且需要經由此項任務創建一個任務視圖控制器
但是您會注意到第二項特徵任務運行UUID
這就是UUID
它是該任務此次特定運行的唯一識別方式
因此如果這裏我們通過零
表明這是一個新任務實例
我們從零開始
但是如果我保存工作成果假設調查時間很長
假設我希望中途暫停那麼我可能保存
在新任務視圖控制器中確定日程
重新啓動這項任務時我們一定會希望恢復以前的工作運行UUID
因爲它與任務運行確實相同
然後您需要設立代表
如果希望瞭解何時完成任務
可以召回代表
但是同樣也會召回代表
這樣就有機會
對任務視圖控制器行爲進行定製
例如針對特定步驟使用新步驟視圖控制器
代替默認步驟
此外有些任務可能會輸出信息
一種文件輸出
例如如果在執行任務時使用麥克風收集音頻數據
那麼我們會希望在執行任務過程中
將該數據寫入音頻文件
在ResearchKit中爲了給予支持
您會給來自該任務的文件輸出
應該進入您的任務視圖控制器
指定一個輸出目錄
任務完成時您需要處理這些文件
然後負責清理
最後通過程序展示任務視圖控制器並獲得類似信息
因此您所看到的這種任務視圖控制器
它的行爲相當標準
並且任務視圖控制器本身
只能控制數量很少的視窗不動產
因此它控制這個導航條
設定進度顯示結果
可能還設定一些向後導航控制機構
此外它向步驟視圖控制器提供的信息
剛好能夠正確顯示向前導航控制機構
任務視圖控制器到此爲止
但是得到結果呢？
讓我們看看下面如何獲得結果
下面介紹DidFinishWithReason
代表召回
任務完成時您的代表將收到該信息
這裏您會瞭解到任務視圖控制器結束的原因
可能結束的其中一項原因是用戶選擇了在任務中途保存工作成果
如果是那樣您會希望提取恢復數據
它是一種不透明NSData性質 然後保存
因爲以後希望繼續執行任務時需要用示例說明新任務視圖控制器
並將其傳輸到專用初始化程序中的恢復數據
但是通常情況下您會順利完成任務
因此您希望從任務視圖控制器的結果屬性
抓取相關結果並用它解決一些問題
如對它進行序列化發送到服務器
或者可能需要分析以便向用戶展示其中一些信息
最後需要解除該任務視圖控制器
因爲已經展示了任務視圖控制器
還需要爲解除控制器承擔責任
現在大家瞭解了ResearchKit的基本概況
以及使用任務型模式的方法
現在讓我們看看它該如何匹配
ResearchKit第一個模塊調查模塊
因此ResearchKit中的調查由三部分構成
指令、調查問題和調查問卷
反之每部分對應一個步驟
因此我們有一個調查問題
我們有一個指令步驟 一個問題步驟和一個問卷步驟
在ORKStep基類現有內容基礎上
我們再增加一些指令步驟
但是問題步驟和問卷步驟比它們稍微多一些
我們要看看下個環節
這是問題步驟和任何其它步驟一樣
它有一個識別符在任務範圍內必須唯一
問題步驟也有回答格式
回答格式是ORKAnswer格式的一個子類
對應希望展示步驟的特定類型
由於各種子類覆蓋範圍很廣
因此我們可能有一個Boolean回答格式
包括“是/否”問題文本選擇回答格式
提供圖像比例尺的圖像選擇回答格式
或者日期型和時間間隔格式
種類繁多可以在GitHub上查看
問題步驟就談到這裏
那麼問卷步驟呢？
這裏有一個問卷步驟並且問卷步驟有一個識別符
而且還有一系列問卷項目
這裏是問卷項目
每個文件項目都有一個識別符
在問卷步驟語境內必須唯一
和問題步驟一樣問卷項目也有回答格式
並且在受支持答卷項目中
ResearchKit支持相同回答格式
例如我們可以將文本選擇回答格式與
同一表格的數字答案格式混合在一起
這就是ResearchKit調查模型對象的對象模型
那麼如何獲得結果呢？
這是預訂任務及其識別符和一個步驟陣列
完成任務後就會獲得任務結果
同樣有匹配識別符和一系列結果
如果預訂任務啓動一個指令步驟
那麼指令步驟會有一個識別符
一旦完成任務就會獲得步驟結果
及其相應識別符
該步驟結果的結果屬性爲空
因爲在該指令步驟期間未收集到任何數據
我們要做的就是向它們展示該指令
雖然這個對象沒有什麼有用屬性
類似開始日期和結束日期
告訴您該指令在頁面上持續的時間
此外還可能有一個問題步驟
這個問題步驟有一個識別符
與相應步驟結果匹配
不同於指令步驟結果
實際上會有一個child結果
承載實際答案與答案格式對應
表格結果工作方式極爲相似
這裏有一個預訂任務包含唯一問卷步驟
有兩個問卷項目當然在問卷步驟內
識別符必須唯一
收到答案時
會收到任務結果和匹配識別符
還有步驟結果以及與該問卷步驟匹配的識別符
然後收到相應child問題結果
這次還會收到一系列問題結果每個問卷項目都有一個結果對應
還有與相應文件項目匹配的識別符
這就是ResearchKit中的對象模型
以及如何使用調查並且用來展示調查項目的方法
我要讓大家看一看Xcode簡短展示
這裏有一個示例App它顯示錶格視圖
和一份有效任務清單這裏我要將一項調查任務
整合在一起讓大家看看我已經提到的一些特徵
這裏是表格視圖控制器
表格視圖控制器有一個--當您選擇一行時
它會舉例說明任務視圖控制器
並顯示該任務設定代表
和輸出目錄完成任務後
我們會在didFinish召回中顯示--我們會解除該任務視圖控制器
現在切換到任務枚舉這裏保留實際任務
大家看到我定義了各種情形包括調查情形
並且顯示的任務當前爲空
但是現在我要將它定義爲調查任務
下一步我會創建它
爲了創建調查任務我要定義計算屬性
調查任務這裏我創建了一項預訂任務
以及識別符調查並附帶一個步驟陣列
現在該陣列爲空
我要添加一個指令步驟
現在這個指令步驟有一個識別符
這裏我正在生成識別符
因爲我知道它們在該任務內是唯一識別符
我設置了一個標題和文本
將在頁面上顯示
您會注意到我已經將這些標註爲本地化字符串
因爲這些模型對象的內容實際上已經本地化
如果打算在多個場合使用App
需要將該內容以及App中需要本地化的
其它項目進行本地化
然後我會添加一個問題步驟
這個問題步驟是一個“是/否”問題
現在有了一個布爾回答格式
它有一個標識符組和一個標題問題如下：
在一個典型日在您爬完幾段樓梯後
您的健康狀態對自己是否有所影響？
這是一個非常典型的問題
在普通健康調查問卷中很常見
我們已經提過問卷表格所以我要增加一個問卷步驟
這是一份問卷 有識別符 有標題
還有一個常見問題：在上兩週您受到以下問題
困擾的頻率是多少？
現在我們列出各種問題每個問題都有一個問卷項目
因此其中每項都是一個問題
採用文本選擇回答格式
這是一個多項選擇問題但只能選擇一個答案
大家可以看到這裏我給的答案
根本不是幾天 超過這些天數的一半 幾乎是每天
它們也有相應數值這些值將會進行編碼
納入結果對象因此以後可以分析結果
這些同樣可能是屬性列表類值
它可能是一個整數--寧可是一個s數
或者可能是一個字符串像這樣
我們看到了這個興趣項
我的問題是做事情少有興趣或快樂
我們會再增加兩項
填完表格
設置完畢後我還想做一件事情
讓您看看結果，
爲此我已爲大家構架了UI所以我們可以研究一下
App自身中的一些結果
這件事情實際在GitHub上的
ORKCatalog樣本App中完成
但是今天我還要序列化到JSON
讓大家看看JSON輸出效果
爲此 我們將回到任務視圖控制器委託DidFinishWithReason
它希望再增加一個步驟 我要把它挪開
我要在任務上添加結論步驟我忘了做這件事情
所以這是我們的結論步驟
那就回到這裏吧
我要打開reason
如果順利完成任務
我會從任務視圖控制器提取結果
然後我想將它序列化到JSON
並且ResearchKit框架本身不包括任何JSON序列化
我們已經將一些東西納入其中一個測試App
以便證明JSON序列化會用於一項真實App
這裏我已將其納入現在我可以向大家演示了
所以我會運行它並讓大家看看調查項目在ResearchKit的情況
開始執行任務時
我會立即看到這個指令步驟
還會顯示進度
我可以取消該任務
我已經有了標題和文本也有了導航控制機構
大家看到它已預先生成方便開始啓動
從任務視圖控制器搭建的框架開始
實現了自動化
我進來時看到了自己的布爾問題
我可以選擇自己的答案如果我選擇跳過這個問題
我輸入的答案會被清除如果我返回答案已經沒有了
一旦我返回我可以回答一些不同問題
因此我要仔細檢查給出答案
可能我並未回答全部問題但我可以繼續
最後我完成了
我們看看結果吧！
如前所述這裏我們看到了任務結果
還有一個起始日期和結束日期據此可以查看該調查項目持續的時間
我們有了輸出目錄一個任務運行UUID
從任務視圖控制器開始直接通過
我們也有了任務識別符
child結果陣列包含一個步驟結果陣列
因此初始指令步驟我們有了指令步驟結果
初始指令步驟沒有children
因爲我們未收集到用戶提供的附加信息
此外 還有問題步驟結果
包含一個布爾問題結果
以及爲我的問題提供的實際答案
這時我回答“是”
然後從這裏的答卷步驟我們得到答卷步驟結果
以及感覺形式標識符和我輸入的每個答案
我回答了前兩個問題
我沒有回答該表格中的最後一個問卷項目
大家可以看到這裏沒有實際答案屬性
並且最後對於結束指令步驟我們還有一個步驟結果
現在我要讓大家看看在開發App過程中
如果需要變更調查項目修改答案格式該有多輕鬆
我希望做的一件事情就是改變我的布爾答案格式
或許“是”提供的信息並不充分
或許我的健康狀況受到很大影響
或者影響不大
爲此我可以切換到文本選擇回答格式
針對允許我提供全部答案的每個選項
我可以提供一些細節文本這樣我可以選擇“是 影響很大”
或者“是 影響不大”
這裏您還要注意一點排他性設置
如果是多選項您可以將一個或多個選項設爲排他性選項
如果選擇了一個選項系統會取消所以其它選項
我也可能希望改變我的答卷步驟
正如大家看到的那樣它是一種垂直捲動的長表格
可能那不是我在App中期望的那樣
也許我希望有一些水平滑條
可以用來顯示大致相同的內容
得到相同答案但是表現方式可以不同
只需切換到ORKScale格式
明確最大值和最小值的說明內容
即可在ResearchKit內輕鬆實現
所以我要再次運行並讓大家看看效果
又是我們的調查項目
非常相似
在這個步驟我們已經有了不同選項
以前是多選問題現在是滑條
可以用來調整數值
當我完成任務看到結果時
從架構來看結果非常類似但結果類型不同
因爲相應答案格式也不同
所以對這些結果的解釋也需要有所變化
ResearchKit調查就講到這裏
第二個模塊是知情同意
ResearchKit第二個模塊是知情同意
我們現在看一下
什麼是知情同意？
知情同意是保證參與者完全明白爲何和如何進行調查
調查意味着什麼
有何風險和收益的過程
如今 調查通常針對個人
而需要同意什麼詳細要求將取決於您的調查標準
也取決於道德審查過程
現在 參與者和調查者一起審查知情同意書
從起始頁到結尾簽名
也許您需要在同意過程中籤名
最終 知情同意通常是一份法律文件
現在App Store提交的人類研究必須包括
道德審查的證據
這並不完全意味着您需要包含像我們要討論的那個研究
元件中的知情同意模塊那樣的知情同意過程
因爲低風險研究可能是例外的
一定的高風險研究可能需要親自工作
但許多案例中假設Researchkit
可以幫到忙那麼研究元件中的知情同意
就是合適的您可以在道德審查過程中
自行決定
那讓我們來看看知情同意模塊
是如何工作的Researchkit中
有兩個步驟需要在知情同意文件中被同意
並且這兩個步驟都可以
從ORKConsent中獲取內容
這個知情同意文件由兩個序列組成
第一個是一個部分序列
這些部分序列可能是預定義類型
就像數據採集、隱私、數據使用
這些都是您希望在知情同意文件中看到的類型
但也有自定義部分
因此Researchkit並不打算提供一個完整的解決方案
我們提供80%的解決方案
如果您需要給您的App附加信息您可以自行添加
除了知情同意文件以外還有一個簽名序列
因而我們可能有一個
包含有預填充姓名和圖像的調查簽名
以及一個我們在調查同意過程中採集的參與者的簽名和圖像
讓我們看看調查元件中的這些部分
我們有了視覺同意步驟 分享同意步驟
以及檢查同意步驟我將稍作詳細解釋
視覺同意通常在文件中各部分佔一屏
有着簡潔的動畫過渡稍後我將就這些預定義部分
作個演示
它完全可以定製因此您可以用圖像替代
您可以用動畫替代
也可以填充知情同意文件中的確切內容
讓我們看看如何編碼
您將創建一個特別種類的知情同意部分
這種情況下采集數據
然後設置屬性
我不用設置標題
因爲在iOS的所有語言都已經進行過本地化
現在我選擇的是預定義部分
但如果我不需要預定義部分或者如果我需要指定我自己的
我也可以這樣重寫
我可以指定在視覺同意過程中顯示的概要
當用戶通過視覺同意或在瀏覽整個文件時
點擊了“瞭解更多”的話
我也可以指定內容
此外您可以設置其他事項
可以設置定製圖像或者定製動畫
定製動畫只是一個視頻文件
您可以包含進您的App裏
如果設置步驟類型的話不管何種錯誤
您都可以覆蓋掉這個定製動畫或者您也可以重新設置一個
一旦您有了同意部分
您就可以把您的文件附到視覺同意步驟裏
來展示您的視覺同意序列
知情同意模塊的下一步是分享步驟
研究數據採集艱難因此在可行的多方研究中重複使用是有意義的
所以獲取更廣泛的同意
可以讓您和其他研究者
共享數據
但是那對參與者會有問題
如果數據敏感他們可能只想協助您的研究而非別人的
這個問題 在我們使用Researchkit
研發最初的App時就存在
因此我們創建同意分享步驟
我們已經提前本地化了所有iOS支持的語言
以便我們帶入您的機構名稱和幾個其他細節
您就可以問參與者
他們是否同意更廣泛地分享數據
在初期調查中超過80%的參與者對此表示同意
但我們仍然認爲這是件重要的事項
如果您的需求包含這樣一個廣泛同意的話
以上是同意分享步驟
Researchkit知情同意模塊的最後一步
是檢查步驟參與者在此檢查實際文件
可能輸入他們的名字
也可能是手指簽名
我們接下來看
這將如何編碼
現在您要開始您的同意文件
您需要加一個
您想採集的簽名
這是參與者簽名
您爲參與者在簽名線下方設置標題
如果您想生成PDF文件的話
我們就得到一個識別符
如果我們想在知情同意書中
找到一個特別的簽名的話識別符就將進行識別
您可以關閉名字採集或者簽名圖像採集
我們通過設置命令簽名圖像來關閉
然後您可以在知情同意文件中添加簽名
當您指定了您想收集何種簽名時
您就可以把同意文件附到同意檢查步驟
您可以使用多個同意檢查步驟
如果您有多人在同一設備上查看同一文件的話這是允許的
這些就是Researchkit中組成知情同意模塊的步驟
但要真的理解當您運行App時看起來的樣子
接下來我將做演示
開始編碼知情同意部分
我需要開始創建同意文件
我先做這個 這是我的同意文件
首先我需要在視覺同意中來展示同意部分
在這裏我創建一個同意部分序列
在Type Overview上我設置了概要
來創建一個同意部分
由於已經本地化過語言了我不需要設置標題
我來添加更多部分您可以看到這些動畫
我再來添加數據採集部分和隱私部分
每一部分都帶有lorem ipsum文本
此外我想展示如何給同意文件添加實質內容
內容將添加到同意檢查文件部分
或者添加到視覺同意部分在點擊“瞭解更多”時
發現的內容中
您可以直接指定內容屬性
它只是文本或者您可以指定HTML
如果您想要HTML的話
這是我的同意部分
我需要一些同意檢查步驟的簽名
我將添加參與者簽名
就像之前幻燈片裏我展示的編碼
帶有不同標題和不同識別
符的帶有名字和預定
圖像的調查者簽名
我將把這些添加到同意書中
然後 我就有了同意文件
我需要創建任務來展示我的同意過程
這是帶有識別符同意書的同意任務
我選這個是因爲它與調查不同
它應當是我閱讀
是我能明白我有了一個步驟序列它目前是空白的
首先我想要一個視覺同意步驟
我添加在這裏有識別符的視覺同意書
我從我的電腦屬性中傳遞文件
接下來我將展示同意分享步驟
它僅有幾個屬性我需要設定順序來充分填充文本
最後我需要一個同意檢查步驟
從而讓參與者
有機會輸入他們的簽名並檢查整個文件
這樣我就從同意文件中獲得了第一個簽名
我知道是參與者簽名
同意文件本身附着帶有獨特任務識別符號的
同意檢查步驟
有幾項我可以在同意檢查步驟額外定製
就像用戶輸入他們的名字和在確認對話中他們同意時
所展示的文本一樣
我已經把這些步驟添加到我的步驟序列裏了
我只需要擴展表格視圖來展示任務
制定我想展示的實際任務
我來演示同意部分
我開始知情同意任務時
直接跳到視覺同意步驟
與一些我們看到的步驟相反
視覺同意步驟每一部分有多個界面
這與我的同意文件的開始部分對應
我導航到第二步
當我向下個界面過渡時我們有美麗的動畫
我想說一下這是預定義好的動畫
您可以進一步定製屏幕
例如爲了使其適用您的App
如果您用UIAppearance設置色調
那就會覆蓋掉屏幕上方的控制按鈕
和下方這裏的按鈕
並改變圖像的顏色
對應的動畫可以很好地適用於您創建的App
當我進行下一部分
您將看到“瞭解更多”按鈕
當我點擊“瞭解更多”我能看到特別同意文件中的實質同意
我繼續來到內容分享步驟這只是一個問題步驟
我問是隻向您的機構
還是向世界各地的研究者分享數據
我想向所有您認爲合格的研究者分享數據
那麼繼續我會看到同意檢查步驟它概括了
文件每部分的標題和內容
我只設置一部分內容
但如果您想爲您的同意書設置特別的同意所有內容的話
那就會是一份需要用戶同意的完整的法律文件
現在有時您想在文件中顯示的部分
和您在視覺同意書中顯示的部分不同
您可以通過只使用文件內的部分
在調查元件中輕易地
讓它只出現在同意檢查步驟
或者通過使用完全不同的反對代表
或第三方選擇的同意文件
您可以設置HTML檢查內容
如果您需要完全定製它完全支持在同意檢查中
顯示您自己的HTML
我一旦同意了您就會看到我提供的自定義文本
我輸入我的名字
繼續我可以簽字這個我做不好
最後當我完成任務時
您就得到了一個結果就像在Researchkit上的
其他任務一樣
這裏有一個與視覺同意相應的步驟結果
顯示我看視覺同意用了多長時間
因爲我回答了“是”
就分享了一個帶有答案“是”的問題步驟
並且您會看到最終同意檢查步驟的結果
包括我輸入的簽名數據
那麼如果我在Swift的實際目標中找我的名字
我就能拉出我簽名的具體的UI圖像
以上就是Researchkit中的知情同意部分
在結束這個不值得的
已經學過的知情同意之前
還有其他事項
需要提一下
我將它們分爲兩類
第一類是知情部分
第一部分是個形式元素
我們已嘗試把視覺同意很好地適用於
小的iPhone形式元素上的同意文件
但是對於您的App您需要添加額外的定製內容
您需要試着讓內容正好適用於那些設備
接下來我鼓勵您使用定製部分
即我們在Researchkit的建議風格部分
輸入的內容
您需要表達您實際
需要的代表您的倫理的您的道德檢查過程
接下來您應該開始計劃參與者的問題是否放在同意過程中？
就是說 在用戶完全同意之前
且在他們實質上加入了您的研究之後
也許他們開始參與後會有更多問題呈現
許多已經在使用Researchkit中的App
最後整合進一個理解小測驗
這可能是有點多餘的工作
但是得知參與者會真正理解
您在視覺同意中要表達的也會讓您很放心
爲達到這個目的
您可以使用與調查模塊同樣的步驟
然後整合進同意任務即可完成
另一方面 我們得到同意
這裏有幾個點
一個是身份驗證
Researchkit沒有驗證您的參與者身份的功能
但是使用Research Kit的初始App可以用郵件驗證
來確保參與者是一個人
但這個研究可能要來自您的道德檢查過程
您也許不需要比它差太多
比如您也許需要用第三方服務
來更可靠地識別身份
一旦您有了身份的概念
您可能想要綁定身份和相關的同意記錄
這樣一來使用一些加密簽名就是合理的
以上就是知情同意
在Researchkit中的第三個模塊是主動任務
一個主動任務是半控制的測試
測試中會給予參與者執行任務的逐步指示
通過設備上傳感器在收集數據的同時執行任務
這些任務的主要
特性是它們是交互的且時間很短
因此他們是分段的任務
在一個ResearchkitApp中目前最長的任務大約是六分鐘
大多數都只有一兩分鐘
我們看一下Researchkit中預定義好的任務
這些任務一般有一些指示步驟
用於給您介紹任務基本上就是告訴您
它是什麼還有您需要做什麼
然後給您某些類別的指示讓您準備去執行
接着是一個主動的步驟數據在此時被收集
最後當任務完成時我們感謝您的參與
激活步驟是其成爲主動任務的原因
在此激活步驟是一個在我們預定義好的單獨主動任務中的基本類別
或是生成我們需要的每個任務中特殊行爲的子類
現在當我們釋放Researchkit時
有五個主動任務
前三個是用傳感器收集的數據打開設備
您被要求來回走因此我們就會有
加速計和陀螺儀收集的我們的步態
和平衡任務的數據
我們來設定健康任務當我們收集心率數據時
被要求走六分鐘
然後設定聲音任務當我們使用麥克風時
來收集您的聲音信息
此外還有兩個任務更多認知測量任務
使用更多交互觸摸行爲
我們有空間記憶任務其中有序列
被要求重複還有點擊速度任務
其中您被要求在兩個按鈕間快速轉換點擊
此外在我們釋放Researchkit以後
還增加了兩個主動測試
我們有一個聽力測試還有一個反應時間測試
您將收到一個刺激
您必須搖晃設備做出反應
爲了幫您樹立一個有關主動任務如何工作的印象
我將給您做一次演示來作爲實踐
接下來
這是一個很短的演示
因爲我只需要給這些簡單的預定義任務一個示例
我將創建這個主動任務計算特性
該任務是兩個指頭敲擊間隔
我只需要設定幾個參數
對每個我們提供的不同的主動任務來說這幾個步驟基本相同
您指定一個識別符
在您的研究中它必須是唯一的
您指定一個擬使用說明
作爲一個本地化的字符串
它將被代入我們提供給每個任務的事先預定的內容中
您指定一個時間段及您需要用戶敲擊多長時間
還可以定義一些其他的選項
來控制我們是否在任務開始和結束時包含實際指示步驟
如果我們提供的對您不合適的話
您也許會想提供您自己的指令
現在我們有了主動任務
並且想要把它增加到桌面視圖上
我只需要做幾個改動來支持它
我把它添加到我的任務列表
作爲一個代表任務提及我的計算屬性
當我運行它時我應該有第三個任務
就是兩個指頭敲擊任務
擬使用說明填充在這裏
其餘內容本地化到所有iOS支持的語言
我們保持這個到所有我們添加的主動任務
這裏是我們的下一步指示
告訴我們該做什麼
我選擇按鈕來點擊
當我進入任務並開始點擊前並不計時
我現在開始點擊
現在我們看到計時器走得越來越快
任務結束了
當任務結束時我得到一些結果
我們看一下它是如何運作的
因爲這是其中一個認知任務數據沒有被寫到文件中
數據被存放在內存裏
我已經在JSON連載我們看一下
這裏有了我們的任務
同樣我們有開始和結束日期和其他各種屬性
我們有與介紹指示相對應的步驟結果
我們有與激活步驟相對應的步驟結果
它包含一個子結果
就是兩指敲擊間隔任務的敲擊間隔結果
反過來它包含着一列樣本
樣本包含着每次敲擊的時間
和屏幕上的座標位置及識別符顯示我敲擊的那個按鈕
敲擊到按鈕外的也記錄在此
此外這個結果也有一些其它屬性細節見屏幕
我想講的是這些位置對於其它種類的主動任務
對應着什麼
您將看到基於文件的結果那些是帶着指向磁盤特定位置的
文件URL的ORKFile結果
它們會出現在您設定任務控制器時指定的輸出目錄中
以上就是我的Researchkit主動任務演示
今天我們講了Researchkit的三個模塊
調查、知情同意、主動任務
但我想還不能結束
我想Researchkit隨着第三方
就是你們的貢獻將會持續擴充
我們持續增加附加功能
使它與我們最新版本的軟件同步
因此有你們的貢獻它將變得更好
讓我們談談您可以如何貢獻
Researchkit只是GitHub上的一個開放源碼項目
那意味着您可以像和其他開放源碼項目一樣
和它進行交互
首先您需要選一個現有議題或者開始一個新的並且評論它
從中我們得知您正在繼續工作
然後您想和我們分享什麼事項時
您要交一個pull請求
此時Apple的評審
和我們外部活躍的貢獻者將評審
您貢獻的質量
它將如何與Researchkit匹配
及如何融入該項目
迄今爲止我們收到的修改中
90%已經整合進代碼庫
我認爲這是個良好的起點
讓我們的項目可以向前發展
一旦您的修改被整合
儘管這不是結束
此後某個時刻
我們將啓動整合過程
從而把Researchkit帶向一個更高版本
事實上我們昨天已經結束了第一個版本
用Researchkit 1
在這個過程中我們會再次
審覈您的修改比如可訪問性
也會本地化到iOS支持的所有語言
在此請您幫忙
希望工作聽起來不算多
您願意幫忙
讓我們再來看看您能貢獻的其它領域
我們之前提到其中一個領域
是主動任務我們已經有兩個新的上半月公衆貢獻的主動任務
我們看到還有人貢獻了答案格式
有人添加了一個垂直滑塊答案表格
有人添加了新的圖像捕捉步驟
除此以外我們期望看到更多領域
比如設備支持領域的貢獻
所以如果您有硬件設備您認爲可以用於醫療調查研究
您可以爲Researchkit添加支持
來幫助更多研究者在App中使用它
我們也希望添加一些後臺集成
因此如果您有後臺服務
您認爲可以很好地整合進Researchkit
並且它可以爲研究者提供數據存儲方案
那麼您給Researchkit添加代碼來支持您的後臺將是很有意義的
我們知道有一些貢獻者
他們已經在做了
現在我們不談細節 我想多談一點
主動任務您已看到主動任務的結構
它有指示步驟 倒計時步驟
激活步驟和完成步驟
激活步驟當您實施您的激活步驟時基礎分類中
已經有一些有用的行爲
因而激活步驟支持記錄配置
當您爲了從不同設備的傳感器中
自動採集數據
來配置您的激活步驟時您不用寫很多代碼
我們仔細看一下這是如何運作的
當下我們有五個
內置於Researchkit的記錄儀
有加速記錄 運動記錄
有從CoreMotion採集數據的計步器
有從HealthKid採集數據的
健康質量記錄
例如 它可以用來採集心率
我們也有位置記錄
我們可以在您激活步驟的過程中
從Core Location獲得信息
現在當您在iOS上使用這些時
您需要取得用戶的同意來進入數據
Researchkit不是一個系統框架
它不允許您繞過這些控制
但是我們試着理順這個過程
如果您使用一個或多個步驟任務視圖控制器會通知
並在指示之後步驟開始前詢問許可
所以我稍微講一下記錄器是如何使用的
以Researchkit中這個
六分鐘走路的健康步行爲例
這是健康步行
它是ORKActiveStep的子類
當您對ORKActiveStep做子分類時
您也對激活步驟視圖控制器做了子分類
您有一個激活步驟視圖控制器
它有個返回指針
現在給健康步行配置了記錄器配置
它將有一個帶有特定的唯一的
識別符的健康質量記錄器
它將與結果匹配您馬上就能看到
這個記錄器配置有幾個參數
有數量種類
在此就是心率數量種類
有單位 在此就是心率監視器上的每分鐘心跳
您可以配置不止一個記錄器
這個例子中就配置了計步器
再次，有了不同的識別符
當您運行健康步行時
您可從記錄器中識別結果
當步行開始 您有兩個記錄器
一個是健康質量記錄
一個是計步器
每一個都將用到
健康步行所附加的配置目標模型
當任務完成時您會得到步驟結果
作爲您任務結果的一部分
步驟結果將包含兩個子文件結果
每一個都是帶識別符號的與配置對應的記錄
如前所述文件URL將指向輸出目錄的文件在此數據會被記錄
Researchkit中的實際序列化格式
在這裏是JSON
但如果您需要不同的格式
可以直接增加一個不同格式
以上是記錄器
現在我已經提到做一個客戶激活步驟時您需要的過程
但我們在結束前還是描述一下
當您要創建您的定製激活步驟時
您先將ORKActiveStep做子分類
並將激活步驟視圖控制器做子分類
通常我們有配對的分類
然後您需要構建UI
如果您需要控制整個屏幕
那就意味着您將徹底覆蓋
您的激活步驟視圖控制器的UI
或者意味着您要定製視圖
使其適合Researchkit內置的激活步驟模板
如果您需要使用我們已有的記錄器來採集傳感器數據
您就得配置一些記錄器並且添加新的結果類別
以認知遊戲爲例您看到這裏我們有了點擊間隔任務
那是個我們特別創建的結果類別的例子
當您創建類似這個的激活類別時
您需要相應地創建您自己的類別結構
該類別結構必須可序列化
那將引出您要包括在結果中的一些限制
以上是結果步驟
我們談到
三個模塊和如何給Researchkit貢獻
我想給你們一點想法
首先 Researchkit是開放源碼的
我想讓您做一件事複製這個結果
看它如何適用於您的App
因爲它是開放源碼的您可以做出貢獻
可以對醫療研究的未來有所作爲
這是真正的要點
這是一個開放源碼項目它會成爲您讓它成爲的樣子
還有幾個其他領域您可以得到Researchkit的附加信息
我們的主頁
ResearchKit.org
我們有包含在Researchkit中的
不同項目的鏈接既有使用ResearchKit的App
也有我們再次鏈接的框架本身
舉例來說如果您是主調查人員
您想聯繫到能幫助您的項目的人們
您可以聯繫我們ResearchKit@Apple.com
最後關於技術支持我有兩個郵箱列表
如果您需要聯繫正在使用該框架的用戶
或者諮詢如何使用可以聯繫ResearchKit Users
如果是關於如何貢獻的問題可以聯繫ResearchKit Dev
當您嘗試組建一個研究App時這裏有一些相關部分可以幫您
昨天HealthKit有新消息
我們介紹了一些新的數據種類
您可以在線訪問
我們今天早上也有HealthKit和ResearchKit研討會
明天上午11:00也有
最後有一個健康和健身的研討會一共半小時
希望您參與
非常感謝 感謝聆聽