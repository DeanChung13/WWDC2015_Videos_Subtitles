國際用戶界面新UIKit支持
大家下午好！
歡迎參加
“國際用戶界面新UIKit支持”這個會議 
我叫薩拉·拉迪 我是一名國際利用軟件工程師 
和很多其他人一樣 我也十分想以我的母語
來使用你們開發的令人驚豔的app 
但是我在App Store中 就是找不到那些很棒的
app的本地化版本 
我的母語是阿拉伯語 
在我從小長大的國家裏 
那裏 我們的書寫習慣不是從右到左 
智能手機變得流行之前 我們並不用考慮
從右往左的佈局 
因此 只要對文本渲染
和字體提供支持就足夠了 
但是在今天 有了這些電子設備 
人們開始使用越來越多的電子書 
他們和自己的設備進行了越來越多的交互 
因此在你們的app中僅僅對文本提供支持已經不夠了 
對這些本地化提供支持時 考慮你的app的佈局、流 
就變得越來越重要了 
就像我一樣 有一百萬的用戶都想
以他們的母語來使用自己的app 
這是一個巨大的機遇 你可以在世界的這些區域
拓展你的市場 
這裏有一個實例 這是Apple在迪拜的一個廣告 
位於世界上最大的建築物之一 
由此你就可以瞭解
Apple在中東的存在 
那麼我們今天要談些什麼呢？
我們主要要談談...
不好意思 
我們主要要談談
與從右到左用戶界面相關的挑戰 
然後我們會介紹下新UIKit支持 
我們爲從右到左的語言添加了UIKit支持 
這樣 我們就可以讓你就可以毫不費力地
支持從右到左 
然後我們會談談你的定製佈局 
談談你如何可以通過自動佈局、在你的定製佈局中
添加從右到左支持 之後我們會介紹下我們剛剛
加到iOS 9上的新API 然後再談一些
異常情況 希望會議結束時 
我可以看到更多的app在App Store中本地化爲
阿拉伯語和希伯來語 不好意思 
讓我們開始吧 先來看一個概述 
當你用從左到右的語言設計你的app時 
比如說英語 你總是先把
最重要的元素
放到屏幕的左側 
之後 如果你還有其他元素 
它們就會自然地從左邊流到右邊 
我們這樣做的原因 
是因爲佈局本身開始跟隨腳本的
讀寫方向 
因此如果你是從右到左設計你的app、反轉腳本 
這就完全說得通了 因爲腳本的讀寫順序
就是從右到左 
此外 UI鏡像概念也不僅僅適用於靜態UI 
它同樣適用於動態UI 
比如 你在你的app中
手勢導航、導航動畫 
比如這裏 後退按鈕總是
位於屏幕的左側 
因此 在從右到左的環境中寫作時 不僅後退按鈕應該
位於右側 相應的手勢和動畫
同樣也應該位於右側 
那麼UIKit有什麼新特性呢？
在iOS 9UIKit上 發送方控制器完全支持
用戶界面鏡像 
這就意味着 但你的app在從右到左的
環境中運行時 它們會自動替你翻轉過來 
整個系統和我們所有的原生app都完全支持
從右到左的UI 因此不用擔心你的app會不一致 
我們來看看原生app中的一些標準控件 
我們就從UI表格視圖開始吧 
這個例子取自“設置”app 
我們使用了一個庫存UI表格視圖 
你可以在這裏看到 我們的設備運行語言是英語 
因此圖表位於屏幕的左側 
標籤是左對齊 表格視圖附件位於
右側 現在 把我的語言改成希伯來語 
舉例來說 它會自動替我翻轉表格視圖單元 
所以現在所有的圖標都到了右側 
文本標籤在圖標左側右對齊了 
表格附件也到了左側 
接下來是導航控件 
這是一個取自手機app的實例 
你可以看到後退按鈕現在位於屏幕的右側 
並且 導航手勢和動畫
都來自屏幕的右邊 
如果你仔細看 還有UI表格 
底部的UI表格也翻轉過來了 
所以現在“收藏夾”到了右側 
下一個 跟蹤手勢 這是另一個取自“時鐘”app
的一個UI表格視圖的實例 你可以看到幻燈片 
滑到上方的手勢來自屏幕的左邊 
如果你使用庫存UI表格視圖 然後啓用
滑到上方的手勢 就可以免費實現了 
那麼如果在你的app中允許從右到左支持呢？
如果你已經在你的app進行了這項本地化 
那麼你只需要鏈接到iOS 9即可 
然後測試你的app 
確保你的定製佈局按預期運作 
但是如果你是首次添加
這項本地化 那麼我們建議你
把你的storyboards改爲自動佈局這一基礎步驟 
這樣當你添加本地化時 
XCode就會快速爲你創建基礎字符串 
你就可以導出它們然後進行翻譯 
翻譯完畢後 你就可以通過XCode再次把它們導入 
這樣 當你運行你的app時 你就會看到 
你的翻譯被自動集成了 並且 
你的佈局也翻轉過來了 
我們再來談談測試 
即使沒有這些本地化項目、對翻譯進行集成 
XCode也會大大簡化你對從右到左的佈局的測試 
當你來到XCode結構中 
把你的應用程序的語言從系統語言改爲
從右到左的語言時 
它就會爲你模擬一個從右到左的環境 
你就可以看到你的app是否已經爲從右到左
這種環境做好準備了 
我們想向你展示下我們剛剛談到的這些內容 
我會請我的同事阿爾坦·阿哈默德
上臺給你做個演示 
<br/> 太好了 謝謝 薩拉 
我要向你們展示一個app來當例子 這是我寫的 
這是我寫的一個簡單的食譜app 我想爲你們添加
一個從右到左的本地化 讓你們看看 
藉助我們添加到iOS 9的新東西 
這有多麼容易 
這是app 相當直接 
這裏有一個表格視圖 底部有一個標籤欄 
如果我們點擊其中的一個單元 
我們就可以看到那個食譜的詳細視圖 
我們在這裏有一些定製標籤和類似的東西 
是通過自動佈局佈置的 還有一個集合視圖 
展示了那個食譜的一些照片 用戶就是要照着這個食譜 
來製作美食 
既然我們準備好向我們的app添加一個從右到左的
本地化 我們就想先看看它長什麼樣 
但是在對任何翻譯進行集成之前 
或者在做任何此類事之前 我們想先看看 
添加了新的變更之後 我們的app成了什麼樣子 
要照着薩拉所說的做 我要到XCode中對屏幕菜單
進行編輯 從應用程序語言下拉菜單中 
我要選擇從右到左的僞語言 
這樣會讓那些UI發生改變 
而不用真正加載任何翻譯 
還有一項額外的優點 
如果我的母語不是一種從右到左的語言 
我也可以在英語中看到我的app帶有從右到左的UI
是什麼樣子 這樣 在我進行任何翻譯之前 
我就不用學習那些語言 或者找一個母語人士幫我複審 
我來把它關掉 並且再次運行app 
搞定了 
一行代碼都沒寫 我就把所有的這些變更引入了
我的app 我可以發現 
東西看上去很不錯 
我們查看下我們的app 看看發生了哪些變動 
因爲我用的是標準表格視圖單元類型 即第I類 
文本標籤位於右側 
V形圖案位於左側 並且指向左側 
就連底部的標籤欄也翻轉過來了 
如同從右到左的用戶預期的那樣 
現在第一個標籤到了最右邊 
如果你再看看導航欄 你會發現之前位於右側的
導航按鈕現在也翻轉過來了 
如果我點擊其中的一個單元 
我就會發現 因爲我用的是自動佈局 
受前後約束 
文字對齊和整個UI都翻轉過來了 
這裏 有件很酷的事情要注意 集合視圖 
因爲我用的是庫存集合視圖、默認的
集合視圖流佈局 集合視圖也翻轉過來了 
因此 現在第一張照片到了右側 
而後面的項目則接到了左邊 
正如薩拉所指出的那樣 導航也顛倒過來了 
如果我點擊這個後退按鈕 你可以看看我到了哪裏 
導航從右側出現了 事實上 
如果我們嘗試滑動 我們也能看到同樣的效果 
太棒了 
我已經在我的app中檢查了這些新的從右到左的變更 
看起來很不錯 我準備好添加
翻譯、
看看
過程是什麼樣子的 
那麼我要選擇我的項目 
在項目導航中 我要去到編輯器中 
這裏 你可以看到一些與本地化相關的選項 
那麼 我要添加本地化 
我來選擇阿拉伯語 
XCode向我顯示了一個對話框 開始工作了 
這樣就會創建我需要翻譯的
本地資源文件 
下一步需要從我的項目中導出
字符串 那麼我們再回到編輯器菜單 
點擊本地化導出 
XCode問我要導出到哪裏 
我選擇桌面 然後點擊“保存” 
現在XCode從我的項目中取出了所有的字符串 
並且打包進了一個XLIFF文檔 
這是軟件翻譯常見的文件格式 
並且把文件放到了桌面上 
我可以把這個文件發給一位翻譯人員 
翻譯人員會替我正確翻譯完畢 
然後返回給我一個翻譯好的XLIFF的文件 
非常棒 翻譯人員搞定了翻譯部分 
我準備好導入本地化了 
我回到編輯器中 導入本地化 
找到我的翻譯好的XLIFF文件夾 這是我阿拉伯語、
裏面有譯文的XLIFF文件 點擊“輸入”
XCode開始運行 取走全部譯文 並且把它們整合到我的項目中 
現在我們的UI和譯文都準備就緒了 
最後一步 我要返回編輯結構菜單 
這次我要選擇阿拉伯語 
而不是從右到左的僞語言 因爲我寫入了本地化 
阿拉伯語顯示了出來 
關閉 再次運行app 
搞定了 
現在 我有了翻譯過的字符串 
我的導航控件標題翻譯過了 
我的標籤欄項目也翻譯成了阿拉伯語 
正如用戶預期的那樣 我可以給我
說阿拉伯語的客戶提供一個完整的
從右到左的用戶體驗 
這裏 還有一個額外的好處 
因爲我是用日期組件格式化程序來
格式化我的準備時間和烹製時間 
實際上 我也得到了它們的本地化版本 
使用數字和日期格式化程序的無縫插件 
可以了 
把你現有的從左到右app轉變成
從右到左的app 就是
這麼簡單 
我要請保羅上來 
請他再來講講 你應該如何轉變
你的定製UI 
就像薩拉和阿爾坦向你們演示的 
如果你用的是庫存UIKit控件 那麼向你的應用程序中添加
一個從右到左的本地化 就會非常容易 
但是如果你的情況比較複雜 那該怎麼辦呢？
首先 在我們開始之前 我想回顧下我們進行的
一些API變更 這樣 如果你正在定製化UI控件 
你就可以更加容易地支持從右到左的本地化 
如果你正在用UI文本框 那麼左視圖、右視圖、
左視圖模式、右視圖模式就會自動爲你鏡像成
從右到左 這樣 你就不需要做其它事情了 
你唯一需要注意的是矩形邊界方法 
它們不會變 
當你在設置separatorInsets時 表格視圖中 
左右測量會自動替你翻轉過來 
不需要你自己做任何其它工作 
如果你正在用滑塊 最小、最大值圖像
會自動替你翻轉過來 
這是因爲 在從右到左的語境中 滑塊的最小值位於右側 
你唯一需要注意的是矩形邊界方法 
當它們翻轉時 
如果你正在X軸上定製偏移 
如果你在從右到左的語境中運行 
你就需要確保它們正確對從右到左做出解釋 
最後 對於像你在演示中看到的導航欄來說 
我們會自動爲你翻轉左側欄按鈕項目和右側欄按鈕項目 
但是 如果你在這些API之外 
添加子視圖 你就需要確保它們擺放正確 
不然 你就會出現重疊的內容 
我們再來談談一些你可能用在你的應用程序上的
定製UI 談談應該如何正確處理它們 
就像你之前看到的 標準單元類型會自動
替你翻轉 不需要你做其它工作 
這就意味着 如果你有定製佈局 
你就需要確保它們也翻轉過來了 
以便它們和OS的其它部分、
和你的應用程序中可能的其它表格視圖單元類型
保持一致 
當然 你可以通過在你的佈局中簡單映射幀
來實現這一點 但是我們建議你
使用前後約束自動佈局
就可以了 因爲這樣就不需要你做任何
其它的事情 無論是從左到右還是
從右到左 你都可以有一模一樣的界面、代碼處理 
對於集合視圖來說 情況也很類似 
就像我們在演示中看到的 
集合視圖流佈局自動支持從右到左 
只要對項目重排序 從右流到左即可 
這就意味着 如果你是在做定製集合視圖佈局 
你需要確保它在X軸上也正確翻轉了 
一般來說 我們今天推薦你用子類集合視圖流佈局 
而不是從頭開始
寫你自己的佈局代碼 
實際上 明天下午就有個會議 
會講講如何很好地實現這一點 
會議上還會講講你可能想在Cocoa Touch中
進行的其它本地化 
那麼 在這次演示中 我們已經
多次提到了自動佈局 
但是你們可能不熟悉這項技術 
“自動佈局”是一種通過使用一組約束 
而不是使用幀 向你的UI放置元素的一種方式 
自從iOS 6之後就可以用來 讓你更方便地支持不同的
iPhone、iPad屏幕尺寸 支持不同的
尺寸等級 
新的split-view多任務處理 
讓你的應用程序更容易
兼容這項新技術 
最後 即使在從右到左本地化之前 
“自動佈局”也能讓你
更容易支持附加的本地化 
這是因爲 一旦你有了一組很好的約束 
添加一項新的本地化 就不過是
翻譯字符串罷了 你不需要
寫任何特殊代碼來正確配置佈局 
如果我在XCode中有什麼約束 
在英語中看起來是一模一樣的 這毫無疑問 
當我在俄語中運行時 它看起來可能是這樣的 
如果我爲一種長度是英語的兩倍的語言
添加本地化 那麼 
我並不需要做其它事情 
因爲約束會替我處理
所有的UI定位 
現在 從右到左這樣做 還有另外一個原因 
你的佈局會自動翻轉 
你不需要做任何其它事情 
現在 你可以在storyboards、
代碼中使用自動佈局 或者使用兩者的組合 
這樣 你的約束和storyboard就有了一個出口 
當由於某種原因 你需要改變你的UI時 
你就可以以編程方式來對它們進行處理 
我們剛纔講了前後 
同樣地 你對它們可能也不熟悉 
其實就是 當你並排有兩個標籤 
並且它們之間有水平約束時 
你就可以把它們指定爲從左到右 
或者指定爲從前往後 
不同之處在於 從左到右是不會變的 
另一方面 從前往後在從左到右的本地化中
看起來像是從左到右 
但是實際上 在從右到左的本地化中 
它是映射了你的UI和佈局 
當你在storyboards中創建約束時 
如果你創建的是默認的水平約束 
那麼它們就已經是從前往後了 
你並不需要做任何其它事 
類似地 如果你在代碼中創建約束 
並且你用的是可視化格式語言 
那麼同樣地 水平約束也會默認爲從前往後 
但是 如果你明確地創建約束 
或者你是在iOS 9上使用新的佈局定位器API 
那麼當你創建約束時 你就需要確保
你選擇了正確的屬性 
你在這個演示中看到的動畫 都會爲全部庫存控件翻轉過來 
這就意味着 如果你在你的UI中有定製動畫 
那麼你就需要確保它們也正確翻轉過來了 
當然了 如果你願意的話 你可以使用幀 
但是我們建議你使用帶有從前往後的約束的
自動佈局來代替幀 
然後改變那些約束的定值即可 
這樣就可以自動完成從左到右以及從右到左 
而不需要任何附加的代碼 
這裏有一個實例 你可以看看是怎樣實現的 
假如說 我想改變某個約束的定值 
在這裏 我有一個持續時間 
我要把偏移量改成一個不同的值 
開始動畫之前 我要調用layoutIfNeeded 
確保幀的起始位置是正確的 
然後我會調用一個隱式動畫塊 
在動畫塊裏面我可以改變約束的實際常數 
然後再次調用layoutIfNeeded 
這樣就更新了幀 
因爲它位於隱式動畫塊裏面 
變更也就會被製成動畫 
你可以在這裏看到 這裏並沒有爲從右到左
或者從左到右寫特例 只有一組單一的代碼 
代碼在兩種語境下都運行的十分完美 
現在 我們再來談談手勢 
就像你已經看過的表格視圖和導航 
我們把標準手勢翻轉過來了 
但是 手勢識別器API自身卻不會變 
原因在於 手勢識別器
本身是很抽象的 
我們在框架層次是不可能知道你使用
手勢識別器的目的 
作爲一名開發者 這對你們意味着當你們使用
手勢識別器時、當你們對手勢事件做出響應時 
你們只需要注意使用手勢識別器的
實際用途即可 
舉例來說 如果你使用你的手勢識別器
在屏幕上繪圖 你就需要保留原樣 
這是因爲母語爲從右到左的用戶不會倒着畫 
但是 還是舉例來說 如果你的表格視圖單元
有定製手勢識別器 你就需要確保
你把它翻轉過來 因爲表格視圖樣式的
佈局已經翻轉過來了 
類似地 如果你用的是導航手勢 
你也需要把它們翻轉過來 就像我們之前看到的 
前後實際上顛倒了 
這裏 要記住的最重要的事情是 
不論你在做什麼 你都需要確保手勢
能夠正確追蹤手勢下方的UI 
當你從左劃到右 但是UI卻從右移到了左 
你肯定不希望出現這種情況 
因爲這會讓人暈頭轉向 
而如果你用“自動佈局” 你的工作就可以大大簡化 
我想把阿爾坦再請回來 請她對我們剛剛
談到的事情 做一個演示 
<br/> 謝謝 保羅 
當保羅做演講時 我又考慮了下我的app 
我決定
增加一些定製UI 
因此我就創建了一個很酷的定製表格視圖單元子類 
是通過“自動佈局”佈置的 
相當直接 
這一行中有一些更多信息文本標籤 
這裏有一張漂亮的圖片 這樣用戶就可以看到他們
將要烹飪的美食的圖片 
左側還有一個很酷的小收藏夾視圖 
這樣用戶就可以通過劃動單元 把它拖出來 
和我們現在在表格視圖單元上有的
庫存swipeToDelete手勢很類似 
如果他們拖的足夠遠 那麼圖片頂部會出現一顆
小星星 告訴他們這張食譜
已經添加到了收藏夾了 
我們來看看在從左到右的
語境中、在英語中 它是什麼樣子的 
太好了 我的app現在看起來更有生機、
更有魅力了 這是一張照片 
這裏有一些文本標籤 實際上 如果我把單元
拖動的足夠遠 收藏夾視圖就顯示出來了 
如果我完成這個手勢 小星星就顯示出來了 
太好了 剛纔保羅演講時 我趁機
學習了阿拉伯語 
並且向我的app添加了阿拉伯語本地化 
那麼在這個演示中 我們就要在阿拉伯語中運行app 
這就是我們的從右到左語言 
我要返回編輯結構菜單 
這次選擇“阿拉伯語” 點擊“回車” 運行app 
哇！這是因爲我用了帶前後約束的自動佈局 
所有的事情都翻轉過來了 
現在圖片到了右側 
文本標籤都成了右對齊 
位置也都正確 
當然了 V形圖案屬於庫存 它的位置沒變 
格式化程序插件、持續時間和數字 
都爲阿拉伯語正確進行了本地化 
不過我們還沒有看定製手勢 
我們來看看 
因爲整個單元都是從右到左佈置 
用戶期望滑動收藏夾的方向也是
如此 當然更是因爲整個系統的
劃動刪除手勢也翻轉過來了 
這樣他們就知道 它是來自左側 
不論你的定製手勢是什麼 用戶都會期待
手勢從右開始 
我們來朝着這個方向滑動下 看看對於這個例子中的
一個從右到左用戶來說 會發生什麼 
你可以看到 事情並未像預期的那樣運行 
我劃動了 但是視圖沒有顯示 
表格單元視圖以爲我點的是它 
因此給我展示了詳細視圖 
這可不太說得通 
發生這種事情的原因是 
我的代碼中有一個隱含假定 
超出了那個劃動的定向性 
我期望劃動是從左到右 
或者換句話說 是沿着正的X方向 
事實上 如果我朝着那個方向劃動 
那個視圖確實可以顯示出來 
但是 它顯示的方向和我手指拖動的方向
是相反的 
這對用戶來說 可不太說得通 
你肯定想避免出現此類情況 
那就讓我們回到表格視圖單元子類 
看看我們能不能找到問題所在 
這裏你可以看到 我有兩項手勢識別器
相關的方法 
第一個是手勢識別器應該開始的方法 
我採用這種方法的原因是 
就像我之前說過的那樣 我想要對定製手勢以及
庫存表格視圖手勢都提供支持 
那麼在這裏 如果用戶滑動的方向
和我的手勢方向一致 我就讓我的手勢識別器啓動 
如果用戶朝着swipeToDelete的方向滑動 
那麼我就什麼也不做 讓表格視圖自行處理 
那麼在這裏你可以看到 我有手勢識別器的X翻譯 
如果翻譯大於零值 或者大於從左到右 
那麼我就會啓動我的手勢識別器 
那麼我們在這裏需要做的 就是校驗我們是否運行在
從右到左的語境中 如果是的話 
我們就需要查找相反方向的翻譯 
要知道我是否允許在從右到左的
本地化中 我要使用我們加到iOS上
的新API 保羅很快會講到這一點 
不過因爲我們現在正好需要 那我就先用了 
我先聲明一個叫做
isLeftToRightLayout的新常數 
我要爲語義內容屬性使用一個新的
用戶界面佈局方向 我要在我的
視圖語義內容屬性中解析我們加到 iOS 9的API 
這會返回一個解算過的佈局方向 對這個視圖來說
是從左到右還是從右到左 如果返回的方向是
從左到右 那麼我就知道 我是在
從左到右的本地化中運行 
校驗翻譯之前 下一步要做的是 
我要查看下我的isLeftToRight變量 
如果是從左到右 那麼我們像往常一樣繼續即可 
如果是從右到左 那麼我們就要尋找小於零或者位於
導航X中的翻譯 
這裏的第二個方法 
是這個updateFavoriteButtonPosition方法 
那麼在這裏 我們實際上就對約束的常數
進行了處理 並且在屏幕上顯示了那個視圖 
在這裏你還可以看到 我應該允許拖動
收藏夾按鈕常數 
這樣就可以告訴下面的代碼 是否應該開始顯示
那個視圖了 同樣地 我們會校正的X翻譯 
解決方法也很類似 我們把這個校驗拿過來 
放到這裏 
然後校驗從左到右佈局 
校驗相反方向的翻譯 
並且校驗從右到左 
這裏的最後一位是這個distancePulled變量 
因此 distancePulled變量 或者常量 
會告訴下面的代碼 用戶在單元上指頭拖動了多遠 
現在我們就可以接受一個負的翻譯了 
distancePulled變量也成爲負的 這樣
沒有什麼意義 因爲它表達了一個絕對值的
分類 要糾正這一點 
我們就也要獲取翻譯的絕對值 
這樣就可以替我們解決問題 
做了這些變更後 我們再來運行下app 
看看情況怎樣 
好了 這裏的一切看起來都不錯 
現在如果我把我的手指
拖過去 那麼事情就會像從右到左的用戶期望的那樣了 
就是這樣 你就是隻需要確保
留意你的代碼中的此類
假設 這就是從右到左的關鍵所在 
有時候 事情
就是這麼簡單 
把你的定製手勢和UI
轉變爲從右到左 就只需要做這些 
我們請回保羅 請他再講一些異常
以及最佳做法 
<br/> 好的 謝謝 阿爾坦 
我們來講一些異常 講講我們引入iOS 9的
一些新API 
其中一個就是我們在
阿爾坦的演示中看到的語義內容屬性API 
那麼在我們開始之前 我們先來談談
什麼是語義內容屬性 
語義內容屬性是UI視圖的一項新屬性 
用途是確保所有的UI在從右到左和從左到右的
語境中都能正確顯示 因爲有時候並不是所有的
UI都會翻轉 我們就需要確保我們
可以對此進行指定 
那麼 默認語義內容屬性是未指明的 
在從右到左本地化中會翻轉 
而在從左到右的本地化中則保持不變 
但是我們還有一些你可以設置的附加屬性類型 
可以阻止翻轉發生 不管是出於歷史原因還是
出於其它原因 
可以管理從右到左的用戶的異常 
最後一點 前後約束的
分辨率 實際上是基於
語義內容屬性的 
要記住這一點 
首先是回放 
這裏的想法是 如果你有某種回放控件 
你就用它來取代那個控件的語義內容屬性 
或者取代那一組控件 來進行回放 
然它們保持從左到右 
就像你在這個新的 音樂app中看到的一樣 
我們的進度條以及回放控件 
它們都保持了從左到右 並不會翻轉 
下一個是空間 
是爲了註釋控制 對應某種直接UI操縱的
註釋控制 你的遊戲中可能有一個
遊戲手柄 按上方向鍵就向上移動 
按左方向鍵就往左移動 或者是文本對齊的類似操作 
因此我們在頁面app這裏 有一個分段控件 
你就可以設置文本上的對齊方式 
即使運行在從右到左的本地化中 左對齊文本
也會停留在左側 
我們不要動它了 
最後 對於你們那些想更明確的人 
我們還有這些forceLeftToRight
和RightToLeftand從右到左屬性類型 
你從它們的名字就可以知道它們的功能 
forceRighToLeft會對從左到右的本地化中的佈局產生影響 
其它則只有當你在從右到左的語境中運行app時纔會產生影響 
對於這些我最後要說的是 如果你想用它們 
請到實驗室和我們談談 
或者在開發者論壇發帖 
以便我們確認你沒有做錯什麼事情、
確認現有的API不能很好地滿足你的需求 
也許我們漏了添加一種API 
你就可以告訴我們 
我想再談談當你支持從右到左時的
UI和文本的最佳做法 
你要確保自己時刻在做的一件事是 
就像我們在演示中看到的那樣 使用格式化程序 
對於阿拉伯語來說 這尤其重要 
因爲不同的說阿拉伯語的國家 對於一年中的
月份 使用的是不同的單詞 
你需要確保正確向你的全部用戶
顯示這些 不論他們是在哪個地區、
哪個國家用 
事實上 明天有場
“國際化中有什麼新料”演講 
就在一大早、上午九點 他們會講一下所有現有的
格式化程序 以及iOS 9上可用的一些
新格式化程序API 
但是 你還是需要確保 如果對於手勢識別器 
你有某種佈局或者邏輯分支 就像我們看到的
那樣 那麼你絕不應該用NSLocale、
NSbundle或者NSFormatter來進行確認 
你可能看到過這樣的代碼 
你想要知道自己是否運行在從右到左的本地化中 
你查找下首選語言 選擇最上面的那種語言 
看看它的書寫方向是不是從右到左 然後就搞定了！
你絕對不應該這樣做 
這樣很容易搞砸 
你不會想這樣做的 
如果你想知道自己的app是否運行在從右到左的語境中 
你應該使用我們在這個演示中看到的這個新API 
語義內容屬性用戶界面佈局方向 
進入你感興趣的視圖的語義內容屬性 
看看它是怎樣佈局的 
這樣你就知道了UI佈局的方向是從左到右 
還是從右到左 
當然了 與此相反的是 你不能把它用於
區域設置、格式設置 
這裏有一個實例 在某種程度上和上一個
幻燈片的意圖一樣 不過這個實例是正確的 
我們得到了視圖的語義屬性 
我們請求佈局方向 如果正好是從右到左 
也許 我們就可以採用定製邏輯 
處理文本時 大多數情況下 
你需要讓對齊和定向性保持
它們的默認值 
這是iOS 9上的新變動 現在默認就是自然對齊 
因此你不需要動從左到右的語言中的
左對齊文本 不需要動從右到左的語言中的
右對齊文本 
類似地 你絕不應該去動基本
書寫方向 除非你是在文本編輯器中進行書寫 
自從iOS 7後 默認就是這樣了 
可能對99%的應用程序來說 你都絕不應該
去碰這個值、改變默認值 
此外 你也不應該把這些用於佈局代碼分支 
而應該用我們在上一個幻燈片中看到的API 
最後 我要談談圖像 對於從右到左的佈局方向
來說 我們有了新API和UI圖像 叫做imageflipped 
它的功能是：當你處於從右到左的語境時 
它會自動爲你水平翻轉圖片 因此圖片在
從右到左佈局方向中會翻轉 在從左到右的佈局中則不變 
然後在從右到左佈局方向中翻轉過來 
這是基於包含圖片的圖片視圖的
語義內容屬性 
一般來說 你只有在定向圖片或者
表達某種UI上纔會用它 
這樣說從右到左的語言的用戶 
纔不會看到自己的照片成了鏡中的照片 
如果你在自己的應用程序中看到錯誤或者V形圖案 
舉例來說 就像我們在Safari工具欄看到的
後退按鈕、前進按鈕 你需要確保它們會翻轉過來 
因爲所有的
定向性概念都已經從右翻轉到了左 
類似地 如果你有某種代表UI的圖標 
舉例來說 一個列表 在新的地圖app的
通行功能中 我們有這個圖標 
讓你可以看到操作步驟 因爲它在某種程度上
代表了表格視圖 在表格視圖中 
圖標位於右側 
你可以看到 圖標已經翻轉過來了 
更微妙的是 我們也把方向指南中的
人物翻轉過來了 因爲如果我們不這麼做 
那麼人物看起來就像是在脫離屏幕邊緣 
那麼就和其它的佈局不怎麼相符了 
我想再把阿爾坦請回來 請她給你們
快速做個演示 
<br/> 最後一個演示了 我保證 
好的 
很棒 
我剛剛學到了很多關於我們添加的這個新的、
很酷的新API的知識 我決定把我的定製表格視圖
單元中的定製推向新高度 
添加一個定製V形圖案 實際上 它是一個披薩片 
這個披薩片將會引導我們的用戶到
下個畫面 
既然我們現在都已經熟悉了從右到左 
那麼我們就直接在阿拉伯語中運行我們的app 
就不再向你們展示它在英語中是什麼樣了 
因爲我們已經過了那個階段 
太好了 因爲我用了自動佈局和前後限制 
把披薩片放到了那個圖片視圖 
它的位置就是正確的了 
它位於單元左側上方 和從右到左的用戶
期待的一模一樣 
然後 很明顯你可以看到 披薩片指的方向是錯誤的 
保羅之前談到的 正是這種
定向圖片 
我們就可以使用圖片翻轉API
來進行糾正 
讓我們回到那個圖表視圖單元子類 
這裏你可以看到 我的所有的[不知所云]方法 
這些所有的出口 我的所有出口都會加載
並且準備就緒 那麼我要做的第一件事 
給我的定製V形圖案圖片獲取一個基準 
customChevronImageView.image 
既然我已經有了 我要把它放回到
圖片視圖 但是做了一個小的變更 
我要在UI圖片上 爲從右到左的佈局
方向方法調用
圖片翻轉 
這會讓你的圖片在從左到右的本地化中
不受影響 
但是在從右到左的本地化中會水平翻轉 
在這裏 重點要記住的是 
因爲這種方法已經替你弄好了 
你就不需要擔心對它進行集成了 它是從左到右 
還是從右到左？校驗下 就像我之前那樣 
在任何本地化中 你都可以信心十足地
調用這種方法 然後你可以確信 
它是不會出錯的 
就這樣 需要我們做的就這些 
做完了這個變更 我們再來運行一次app 
完美的比薩餅 
我們的V形圖案翻轉過來了
謝謝 
我們的V形圖案翻轉過來了 我們的app看上去也很棒 
我們有了翻譯 定製手勢看上去也很漂亮 
我們就準備就緒了 
把你的app本地化爲從右到左就是這麼簡單 
薩拉該你了 給大家講完這次會議 
謝謝你薩拉 演示很棒 
我們很快會把薩拉今天給我們做的演示
更新到網上 
如果你漏掉了會議的某些內容 你可以
下載這個簡單的代碼 然後看看它 
會議結束之前 我來總結一下 
當你爲從右到左的語言設計你的app時 
這些語言的母語用戶期待UI也是從右到左 
有了我們添加到iOS 9上的新原生UIKit支持 
這就是一個絕佳的機遇 
對你來說 就是添加這個本地化的好機會 
不費吹灰之力 我們還添加了新API 
對於不說母語的開發者以及說母語的開發者來說 
都會非常簡單 
你也可以藉此接觸到數以百萬計的
新用戶、新市場 
要獲取更多信息 請訪問我們的資料網站 
網址是developer.Apple.com 我們有國際化資料 
還有本地化資料 
如果你有問題 你可以把它們貼到開發者論壇 
我們也建議你們參加那些相關的會議 
我強烈推薦明天上午9 00的“國際化中有什麼新料” 
再次謝謝你們 
謝謝你們來參會 祝你們下午過得愉快！
謝謝！