国际用户界面新UIKit支持
大家下午好！
欢迎参加
“国际用户界面新UIKit支持”这个会议 
我叫萨拉·拉迪 我是一名国际利用软件工程师 
和很多其他人一样 我也十分想以我的母语
来使用你们开发的令人惊艳的app 
但是我在App Store中 就是找不到那些很棒的
app的本地化版本 
我的母语是阿拉伯语 
在我从小长大的国家里 
那里 我们的书写习惯不是从右到左 
智能手机变得流行之前 我们并不用考虑
从右往左的布局 
因此 只要对文本渲染
和字体提供支持就足够了 
但是在今天 有了这些电子设备 
人们开始使用越来越多的电子书 
他们和自己的设备进行了越来越多的交互 
因此在你们的app中仅仅对文本提供支持已经不够了 
对这些本地化提供支持时 考虑你的app的布局、流 
就变得越来越重要了 
就像我一样 有一百万的用户都想
以他们的母语来使用自己的app 
这是一个巨大的机遇 你可以在世界的这些区域
拓展你的市场 
这里有一个实例 这是Apple在迪拜的一个广告 
位于世界上最大的建筑物之一 
由此你就可以了解
Apple在中东的存在 
那么我们今天要谈些什么呢？
我们主要要谈谈...
不好意思 
我们主要要谈谈
与从右到左用户界面相关的挑战 
然后我们会介绍下新UIKit支持 
我们为从右到左的语言添加了UIKit支持 
这样 我们就可以让你就可以毫不费力地
支持从右到左 
然后我们会谈谈你的定制布局 
谈谈你如何可以通过自动布局、在你的定制布局中
添加从右到左支持 之后我们会介绍下我们刚刚
加到iOS 9上的新API 然后再谈一些
异常情况 希望会议结束时 
我可以看到更多的app在App Store中本地化为
阿拉伯语和希伯来语 不好意思 
让我们开始吧 先来看一个概述 
当你用从左到右的语言设计你的app时 
比如说英语 你总是先把
最重要的元素
放到屏幕的左侧 
之后 如果你还有其他元素 
它们就会自然地从左边流到右边 
我们这样做的原因 
是因为布局本身开始跟随脚本的
读写方向 
因此如果你是从右到左设计你的app、反转脚本 
这就完全说得通了 因为脚本的读写顺序
就是从右到左 
此外 UI镜像概念也不仅仅适用于静态UI 
它同样适用于动态UI 
比如 你在你的app中
手势导航、导航动画 
比如这里 后退按钮总是
位于屏幕的左侧 
因此 在从右到左的环境中写作时 不仅后退按钮应该
位于右侧 相应的手势和动画
同样也应该位于右侧 
那么UIKit有什么新特性呢？
在iOS 9UIKit上 发送方控制器完全支持
用户界面镜像 
这就意味着 但你的app在从右到左的
环境中运行时 它们会自动替你翻转过来 
整个系统和我们所有的原生app都完全支持
从右到左的UI 因此不用担心你的app会不一致 
我们来看看原生app中的一些标准控件 
我们就从UI表格视图开始吧 
这个例子取自“设置”app 
我们使用了一个库存UI表格视图 
你可以在这里看到 我们的设备运行语言是英语 
因此图表位于屏幕的左侧 
标签是左对齐 表格视图附件位于
右侧 现在 把我的语言改成希伯来语 
举例来说 它会自动替我翻转表格视图单元 
所以现在所有的图标都到了右侧 
文本标签在图标左侧右对齐了 
表格附件也到了左侧 
接下来是导航控件 
这是一个取自手机app的实例 
你可以看到后退按钮现在位于屏幕的右侧 
并且 导航手势和动画
都来自屏幕的右边 
如果你仔细看 还有UI表格 
底部的UI表格也翻转过来了 
所以现在“收藏夹”到了右侧 
下一个 跟踪手势 这是另一个取自“时钟”app
的一个UI表格视图的实例 你可以看到幻灯片 
滑到上方的手势来自屏幕的左边 
如果你使用库存UI表格视图 然后启用
滑到上方的手势 就可以免费实现了 
那么如果在你的app中允许从右到左支持呢？
如果你已经在你的app进行了这项本地化 
那么你只需要链接到iOS 9即可 
然后测试你的app 
确保你的定制布局按预期运作 
但是如果你是首次添加
这项本地化 那么我们建议你
把你的storyboards改为自动布局这一基础步骤 
这样当你添加本地化时 
XCode就会快速为你创建基础字符串 
你就可以导出它们然后进行翻译 
翻译完毕后 你就可以通过XCode再次把它们导入 
这样 当你运行你的app时 你就会看到 
你的翻译被自动集成了 并且 
你的布局也翻转过来了 
我们再来谈谈测试 
即使没有这些本地化项目、对翻译进行集成 
XCode也会大大简化你对从右到左的布局的测试 
当你来到XCode结构中 
把你的应用程序的语言从系统语言改为
从右到左的语言时 
它就会为你模拟一个从右到左的环境 
你就可以看到你的app是否已经为从右到左
这种环境做好准备了 
我们想向你展示下我们刚刚谈到的这些内容 
我会请我的同事阿尔坦·阿哈默德
上台给你做个演示 
<br/> 太好了 谢谢 萨拉 
我要向你们展示一个app来当例子 这是我写的 
这是我写的一个简单的食谱app 我想为你们添加
一个从右到左的本地化 让你们看看 
借助我们添加到iOS 9的新东西 
这有多么容易 
这是app 相当直接 
这里有一个表格视图 底部有一个标签栏 
如果我们点击其中的一个单元 
我们就可以看到那个食谱的详细视图 
我们在这里有一些定制标签和类似的东西 
是通过自动布局布置的 还有一个集合视图 
展示了那个食谱的一些照片 用户就是要照着这个食谱 
来制作美食 
既然我们准备好向我们的app添加一个从右到左的
本地化 我们就想先看看它长什么样 
但是在对任何翻译进行集成之前 
或者在做任何此类事之前 我们想先看看 
添加了新的变更之后 我们的app成了什么样子 
要照着萨拉所说的做 我要到XCode中对屏幕菜单
进行编辑 从应用程序语言下拉菜单中 
我要选择从右到左的伪语言 
这样会让那些UI发生改变 
而不用真正加载任何翻译 
还有一项额外的优点 
如果我的母语不是一种从右到左的语言 
我也可以在英语中看到我的app带有从右到左的UI
是什么样子 这样 在我进行任何翻译之前 
我就不用学习那些语言 或者找一个母语人士帮我复审 
我来把它关掉 并且再次运行app 
搞定了 
一行代码都没写 我就把所有的这些变更引入了
我的app 我可以发现 
东西看上去很不错 
我们查看下我们的app 看看发生了哪些变动 
因为我用的是标准表格视图单元类型 即第I类 
文本标签位于右侧 
V形图案位于左侧 并且指向左侧 
就连底部的标签栏也翻转过来了 
如同从右到左的用户预期的那样 
现在第一个标签到了最右边 
如果你再看看导航栏 你会发现之前位于右侧的
导航按钮现在也翻转过来了 
如果我点击其中的一个单元 
我就会发现 因为我用的是自动布局 
受前后约束 
文字对齐和整个UI都翻转过来了 
这里 有件很酷的事情要注意 集合视图 
因为我用的是库存集合视图、默认的
集合视图流布局 集合视图也翻转过来了 
因此 现在第一张照片到了右侧 
而后面的项目则接到了左边 
正如萨拉所指出的那样 导航也颠倒过来了 
如果我点击这个后退按钮 你可以看看我到了哪里 
导航从右侧出现了 事实上 
如果我们尝试滑动 我们也能看到同样的效果 
太棒了 
我已经在我的app中检查了这些新的从右到左的变更 
看起来很不错 我准备好添加
翻译、
看看
过程是什么样子的 
那么我要选择我的项目 
在项目导航中 我要去到编辑器中 
这里 你可以看到一些与本地化相关的选项 
那么 我要添加本地化 
我来选择阿拉伯语 
XCode向我显示了一个对话框 开始工作了 
这样就会创建我需要翻译的
本地资源文件 
下一步需要从我的项目中导出
字符串 那么我们再回到编辑器菜单 
点击本地化导出 
XCode问我要导出到哪里 
我选择桌面 然后点击“保存” 
现在XCode从我的项目中取出了所有的字符串 
并且打包进了一个XLIFF文档 
这是软件翻译常见的文件格式 
并且把文件放到了桌面上 
我可以把这个文件发给一位翻译人员 
翻译人员会替我正确翻译完毕 
然后返回给我一个翻译好的XLIFF的文件 
非常棒 翻译人员搞定了翻译部分 
我准备好导入本地化了 
我回到编辑器中 导入本地化 
找到我的翻译好的XLIFF文件夹 这是我阿拉伯语、
里面有译文的XLIFF文件 点击“输入”
XCode开始运行 取走全部译文 并且把它们整合到我的项目中 
现在我们的UI和译文都准备就绪了 
最后一步 我要返回编辑结构菜单 
这次我要选择阿拉伯语 
而不是从右到左的伪语言 因为我写入了本地化 
阿拉伯语显示了出来 
关闭 再次运行app 
搞定了 
现在 我有了翻译过的字符串 
我的导航控件标题翻译过了 
我的标签栏项目也翻译成了阿拉伯语 
正如用户预期的那样 我可以给我
说阿拉伯语的客户提供一个完整的
从右到左的用户体验 
这里 还有一个额外的好处 
因为我是用日期组件格式化程序来
格式化我的准备时间和烹制时间 
实际上 我也得到了它们的本地化版本 
使用数字和日期格式化程序的无缝插件 
可以了 
把你现有的从左到右app转变成
从右到左的app 就是
这么简单 
我要请保罗上来 
请他再来讲讲 你应该如何转变
你的定制UI 
就像萨拉和阿尔坦向你们演示的 
如果你用的是库存UIKit控件 那么向你的应用程序中添加
一个从右到左的本地化 就会非常容易 
但是如果你的情况比较复杂 那该怎么办呢？
首先 在我们开始之前 我想回顾下我们进行的
一些API变更 这样 如果你正在定制化UI控件 
你就可以更加容易地支持从右到左的本地化 
如果你正在用UI文本框 那么左视图、右视图、
左视图模式、右视图模式就会自动为你镜像成
从右到左 这样 你就不需要做其它事情了 
你唯一需要注意的是矩形边界方法 
它们不会变 
当你在设置separatorInsets时 表格视图中 
左右测量会自动替你翻转过来 
不需要你自己做任何其它工作 
如果你正在用滑块 最小、最大值图像
会自动替你翻转过来 
这是因为 在从右到左的语境中 滑块的最小值位于右侧 
你唯一需要注意的是矩形边界方法 
当它们翻转时 
如果你正在X轴上定制偏移 
如果你在从右到左的语境中运行 
你就需要确保它们正确对从右到左做出解释 
最后 对于像你在演示中看到的导航栏来说 
我们会自动为你翻转左侧栏按钮项目和右侧栏按钮项目 
但是 如果你在这些API之外 
添加子视图 你就需要确保它们摆放正确 
不然 你就会出现重叠的内容 
我们再来谈谈一些你可能用在你的应用程序上的
定制UI 谈谈应该如何正确处理它们 
就像你之前看到的 标准单元类型会自动
替你翻转 不需要你做其它工作 
这就意味着 如果你有定制布局 
你就需要确保它们也翻转过来了 
以便它们和OS的其它部分、
和你的应用程序中可能的其它表格视图单元类型
保持一致 
当然 你可以通过在你的布局中简单映射帧
来实现这一点 但是我们建议你
使用前后约束自动布局
就可以了 因为这样就不需要你做任何
其它的事情 无论是从左到右还是
从右到左 你都可以有一模一样的界面、代码处理 
对于集合视图来说 情况也很类似 
就像我们在演示中看到的 
集合视图流布局自动支持从右到左 
只要对项目重排序 从右流到左即可 
这就意味着 如果你是在做定制集合视图布局 
你需要确保它在X轴上也正确翻转了 
一般来说 我们今天推荐你用子类集合视图流布局 
而不是从头开始
写你自己的布局代码 
实际上 明天下午就有个会议 
会讲讲如何很好地实现这一点 
会议上还会讲讲你可能想在Cocoa Touch中
进行的其它本地化 
那么 在这次演示中 我们已经
多次提到了自动布局 
但是你们可能不熟悉这项技术 
“自动布局”是一种通过使用一组约束 
而不是使用帧 向你的UI放置元素的一种方式 
自从iOS 6之后就可以用来 让你更方便地支持不同的
iPhone、iPad屏幕尺寸 支持不同的
尺寸等级 
新的split-view多任务处理 
让你的应用程序更容易
兼容这项新技术 
最后 即使在从右到左本地化之前 
“自动布局”也能让你
更容易支持附加的本地化 
这是因为 一旦你有了一组很好的约束 
添加一项新的本地化 就不过是
翻译字符串罢了 你不需要
写任何特殊代码来正确配置布局 
如果我在XCode中有什么约束 
在英语中看起来是一模一样的 这毫无疑问 
当我在俄语中运行时 它看起来可能是这样的 
如果我为一种长度是英语的两倍的语言
添加本地化 那么 
我并不需要做其它事情 
因为约束会替我处理
所有的UI定位 
现在 从右到左这样做 还有另外一个原因 
你的布局会自动翻转 
你不需要做任何其它事情 
现在 你可以在storyboards、
代码中使用自动布局 或者使用两者的组合 
这样 你的约束和storyboard就有了一个出口 
当由于某种原因 你需要改变你的UI时 
你就可以以编程方式来对它们进行处理 
我们刚才讲了前后 
同样地 你对它们可能也不熟悉 
其实就是 当你并排有两个标签 
并且它们之间有水平约束时 
你就可以把它们指定为从左到右 
或者指定为从前往后 
不同之处在于 从左到右是不会变的 
另一方面 从前往后在从左到右的本地化中
看起来像是从左到右 
但是实际上 在从右到左的本地化中 
它是映射了你的UI和布局 
当你在storyboards中创建约束时 
如果你创建的是默认的水平约束 
那么它们就已经是从前往后了 
你并不需要做任何其它事 
类似地 如果你在代码中创建约束 
并且你用的是可视化格式语言 
那么同样地 水平约束也会默认为从前往后 
但是 如果你明确地创建约束 
或者你是在iOS 9上使用新的布局定位器API 
那么当你创建约束时 你就需要确保
你选择了正确的属性 
你在这个演示中看到的动画 都会为全部库存控件翻转过来 
这就意味着 如果你在你的UI中有定制动画 
那么你就需要确保它们也正确翻转过来了 
当然了 如果你愿意的话 你可以使用帧 
但是我们建议你使用带有从前往后的约束的
自动布局来代替帧 
然后改变那些约束的定值即可 
这样就可以自动完成从左到右以及从右到左 
而不需要任何附加的代码 
这里有一个实例 你可以看看是怎样实现的 
假如说 我想改变某个约束的定值 
在这里 我有一个持续时间 
我要把偏移量改成一个不同的值 
开始动画之前 我要调用layoutIfNeeded 
确保帧的起始位置是正确的 
然后我会调用一个隐式动画块 
在动画块里面我可以改变约束的实际常数 
然后再次调用layoutIfNeeded 
这样就更新了帧 
因为它位于隐式动画块里面 
变更也就会被制成动画 
你可以在这里看到 这里并没有为从右到左
或者从左到右写特例 只有一组单一的代码 
代码在两种语境下都运行的十分完美 
现在 我们再来谈谈手势 
就像你已经看过的表格视图和导航 
我们把标准手势翻转过来了 
但是 手势识别器API自身却不会变 
原因在于 手势识别器
本身是很抽象的 
我们在框架层次是不可能知道你使用
手势识别器的目的 
作为一名开发者 这对你们意味着当你们使用
手势识别器时、当你们对手势事件做出响应时 
你们只需要注意使用手势识别器的
实际用途即可 
举例来说 如果你使用你的手势识别器
在屏幕上绘图 你就需要保留原样 
这是因为母语为从右到左的用户不会倒着画 
但是 还是举例来说 如果你的表格视图单元
有定制手势识别器 你就需要确保
你把它翻转过来 因为表格视图样式的
布局已经翻转过来了 
类似地 如果你用的是导航手势 
你也需要把它们翻转过来 就像我们之前看到的 
前后实际上颠倒了 
这里 要记住的最重要的事情是 
不论你在做什么 你都需要确保手势
能够正确追踪手势下方的UI 
当你从左划到右 但是UI却从右移到了左 
你肯定不希望出现这种情况 
因为这会让人晕头转向 
而如果你用“自动布局” 你的工作就可以大大简化 
我想把阿尔坦再请回来 请她对我们刚刚
谈到的事情 做一个演示 
<br/> 谢谢 保罗 
当保罗做演讲时 我又考虑了下我的app 
我决定
增加一些定制UI 
因此我就创建了一个很酷的定制表格视图单元子类 
是通过“自动布局”布置的 
相当直接 
这一行中有一些更多信息文本标签 
这里有一张漂亮的图片 这样用户就可以看到他们
将要烹饪的美食的图片 
左侧还有一个很酷的小收藏夹视图 
这样用户就可以通过划动单元 把它拖出来 
和我们现在在表格视图单元上有的
库存swipeToDelete手势很类似 
如果他们拖的足够远 那么图片顶部会出现一颗
小星星 告诉他们这张食谱
已经添加到了收藏夹了 
我们来看看在从左到右的
语境中、在英语中 它是什么样子的 
太好了 我的app现在看起来更有生机、
更有魅力了 这是一张照片 
这里有一些文本标签 实际上 如果我把单元
拖动的足够远 收藏夹视图就显示出来了 
如果我完成这个手势 小星星就显示出来了 
太好了 刚才保罗演讲时 我趁机
学习了阿拉伯语 
并且向我的app添加了阿拉伯语本地化 
那么在这个演示中 我们就要在阿拉伯语中运行app 
这就是我们的从右到左语言 
我要返回编辑结构菜单 
这次选择“阿拉伯语” 点击“回车” 运行app 
哇！这是因为我用了带前后约束的自动布局 
所有的事情都翻转过来了 
现在图片到了右侧 
文本标签都成了右对齐 
位置也都正确 
当然了 V形图案属于库存 它的位置没变 
格式化程序插件、持续时间和数字 
都为阿拉伯语正确进行了本地化 
不过我们还没有看定制手势 
我们来看看 
因为整个单元都是从右到左布置 
用户期望滑动收藏夹的方向也是
如此 当然更是因为整个系统的
划动删除手势也翻转过来了 
这样他们就知道 它是来自左侧 
不论你的定制手势是什么 用户都会期待
手势从右开始 
我们来朝着这个方向滑动下 看看对于这个例子中的
一个从右到左用户来说 会发生什么 
你可以看到 事情并未像预期的那样运行 
我划动了 但是视图没有显示 
表格单元视图以为我点的是它 
因此给我展示了详细视图 
这可不太说得通 
发生这种事情的原因是 
我的代码中有一个隐含假定 
超出了那个划动的定向性 
我期望划动是从左到右 
或者换句话说 是沿着正的X方向 
事实上 如果我朝着那个方向划动 
那个视图确实可以显示出来 
但是 它显示的方向和我手指拖动的方向
是相反的 
这对用户来说 可不太说得通 
你肯定想避免出现此类情况 
那就让我们回到表格视图单元子类 
看看我们能不能找到问题所在 
这里你可以看到 我有两项手势识别器
相关的方法 
第一个是手势识别器应该开始的方法 
我采用这种方法的原因是 
就像我之前说过的那样 我想要对定制手势以及
库存表格视图手势都提供支持 
那么在这里 如果用户滑动的方向
和我的手势方向一致 我就让我的手势识别器启动 
如果用户朝着swipeToDelete的方向滑动 
那么我就什么也不做 让表格视图自行处理 
那么在这里你可以看到 我有手势识别器的X翻译 
如果翻译大于零值 或者大于从左到右 
那么我就会启动我的手势识别器 
那么我们在这里需要做的 就是校验我们是否运行在
从右到左的语境中 如果是的话 
我们就需要查找相反方向的翻译 
要知道我是否允许在从右到左的
本地化中 我要使用我们加到iOS上
的新API 保罗很快会讲到这一点 
不过因为我们现在正好需要 那我就先用了 
我先声明一个叫做
isLeftToRightLayout的新常数 
我要为语义内容属性使用一个新的
用户界面布局方向 我要在我的
视图语义内容属性中解析我们加到 iOS 9的API 
这会返回一个解算过的布局方向 对这个视图来说
是从左到右还是从右到左 如果返回的方向是
从左到右 那么我就知道 我是在
从左到右的本地化中运行 
校验翻译之前 下一步要做的是 
我要查看下我的isLeftToRight变量 
如果是从左到右 那么我们像往常一样继续即可 
如果是从右到左 那么我们就要寻找小于零或者位于
导航X中的翻译 
这里的第二个方法 
是这个updateFavoriteButtonPosition方法 
那么在这里 我们实际上就对约束的常数
进行了处理 并且在屏幕上显示了那个视图 
在这里你还可以看到 我应该允许拖动
收藏夹按钮常数 
这样就可以告诉下面的代码 是否应该开始显示
那个视图了 同样地 我们会校正的X翻译 
解决方法也很类似 我们把这个校验拿过来 
放到这里 
然后校验从左到右布局 
校验相反方向的翻译 
并且校验从右到左 
这里的最后一位是这个distancePulled变量 
因此 distancePulled变量 或者常量 
会告诉下面的代码 用户在单元上指头拖动了多远 
现在我们就可以接受一个负的翻译了 
distancePulled变量也成为负的 这样
没有什么意义 因为它表达了一个绝对值的
分类 要纠正这一点 
我们就也要获取翻译的绝对值 
这样就可以替我们解决问题 
做了这些变更后 我们再来运行下app 
看看情况怎样 
好了 这里的一切看起来都不错 
现在如果我把我的手指
拖过去 那么事情就会像从右到左的用户期望的那样了 
就是这样 你就是只需要确保
留意你的代码中的此类
假设 这就是从右到左的关键所在 
有时候 事情
就是这么简单 
把你的定制手势和UI
转变为从右到左 就只需要做这些 
我们请回保罗 请他再讲一些异常
以及最佳做法 
<br/> 好的 谢谢 阿尔坦 
我们来讲一些异常 讲讲我们引入iOS 9的
一些新API 
其中一个就是我们在
阿尔坦的演示中看到的语义内容属性API 
那么在我们开始之前 我们先来谈谈
什么是语义内容属性 
语义内容属性是UI视图的一项新属性 
用途是确保所有的UI在从右到左和从左到右的
语境中都能正确显示 因为有时候并不是所有的
UI都会翻转 我们就需要确保我们
可以对此进行指定 
那么 默认语义内容属性是未指明的 
在从右到左本地化中会翻转 
而在从左到右的本地化中则保持不变 
但是我们还有一些你可以设置的附加属性类型 
可以阻止翻转发生 不管是出于历史原因还是
出于其它原因 
可以管理从右到左的用户的异常 
最后一点 前后约束的
分辨率 实际上是基于
语义内容属性的 
要记住这一点 
首先是回放 
这里的想法是 如果你有某种回放控件 
你就用它来取代那个控件的语义内容属性 
或者取代那一组控件 来进行回放 
然它们保持从左到右 
就像你在这个新的 音乐app中看到的一样 
我们的进度条以及回放控件 
它们都保持了从左到右 并不会翻转 
下一个是空间 
是为了注释控制 对应某种直接UI操纵的
注释控制 你的游戏中可能有一个
游戏手柄 按上方向键就向上移动 
按左方向键就往左移动 或者是文本对齐的类似操作 
因此我们在页面app这里 有一个分段控件 
你就可以设置文本上的对齐方式 
即使运行在从右到左的本地化中 左对齐文本
也会停留在左侧 
我们不要动它了 
最后 对于你们那些想更明确的人 
我们还有这些forceLeftToRight
和RightToLeftand从右到左属性类型 
你从它们的名字就可以知道它们的功能 
forceRighToLeft会对从左到右的本地化中的布局产生影响 
其它则只有当你在从右到左的语境中运行app时才会产生影响 
对于这些我最后要说的是 如果你想用它们 
请到实验室和我们谈谈 
或者在开发者论坛发帖 
以便我们确认你没有做错什么事情、
确认现有的API不能很好地满足你的需求 
也许我们漏了添加一种API 
你就可以告诉我们 
我想再谈谈当你支持从右到左时的
UI和文本的最佳做法 
你要确保自己时刻在做的一件事是 
就像我们在演示中看到的那样 使用格式化程序 
对于阿拉伯语来说 这尤其重要 
因为不同的说阿拉伯语的国家 对于一年中的
月份 使用的是不同的单词 
你需要确保正确向你的全部用户
显示这些 不论他们是在哪个地区、
哪个国家用 
事实上 明天有场
“国际化中有什么新料”演讲 
就在一大早、上午九点 他们会讲一下所有现有的
格式化程序 以及iOS 9上可用的一些
新格式化程序API 
但是 你还是需要确保 如果对于手势识别器 
你有某种布局或者逻辑分支 就像我们看到的
那样 那么你绝不应该用NSLocale、
NSbundle或者NSFormatter来进行确认 
你可能看到过这样的代码 
你想要知道自己是否运行在从右到左的本地化中 
你查找下首选语言 选择最上面的那种语言 
看看它的书写方向是不是从右到左 然后就搞定了！
你绝对不应该这样做 
这样很容易搞砸 
你不会想这样做的 
如果你想知道自己的app是否运行在从右到左的语境中 
你应该使用我们在这个演示中看到的这个新API 
语义内容属性用户界面布局方向 
进入你感兴趣的视图的语义内容属性 
看看它是怎样布局的 
这样你就知道了UI布局的方向是从左到右 
还是从右到左 
当然了 与此相反的是 你不能把它用于
区域设置、格式设置 
这里有一个实例 在某种程度上和上一个
幻灯片的意图一样 不过这个实例是正确的 
我们得到了视图的语义属性 
我们请求布局方向 如果正好是从右到左 
也许 我们就可以采用定制逻辑 
处理文本时 大多数情况下 
你需要让对齐和定向性保持
它们的默认值 
这是iOS 9上的新变动 现在默认就是自然对齐 
因此你不需要动从左到右的语言中的
左对齐文本 不需要动从右到左的语言中的
右对齐文本 
类似地 你绝不应该去动基本
书写方向 除非你是在文本编辑器中进行书写 
自从iOS 7后 默认就是这样了 
可能对99%的应用程序来说 你都绝不应该
去碰这个值、改变默认值 
此外 你也不应该把这些用于布局代码分支 
而应该用我们在上一个幻灯片中看到的API 
最后 我要谈谈图像 对于从右到左的布局方向
来说 我们有了新API和UI图像 叫做imageflipped 
它的功能是：当你处于从右到左的语境时 
它会自动为你水平翻转图片 因此图片在
从右到左布局方向中会翻转 在从左到右的布局中则不变 
然后在从右到左布局方向中翻转过来 
这是基于包含图片的图片视图的
语义内容属性 
一般来说 你只有在定向图片或者
表达某种UI上才会用它 
这样说从右到左的语言的用户 
才不会看到自己的照片成了镜中的照片 
如果你在自己的应用程序中看到错误或者V形图案 
举例来说 就像我们在Safari工具栏看到的
后退按钮、前进按钮 你需要确保它们会翻转过来 
因为所有的
定向性概念都已经从右翻转到了左 
类似地 如果你有某种代表UI的图标 
举例来说 一个列表 在新的地图app的
通行功能中 我们有这个图标 
让你可以看到操作步骤 因为它在某种程度上
代表了表格视图 在表格视图中 
图标位于右侧 
你可以看到 图标已经翻转过来了 
更微妙的是 我们也把方向指南中的
人物翻转过来了 因为如果我们不这么做 
那么人物看起来就像是在脱离屏幕边缘 
那么就和其它的布局不怎么相符了 
我想再把阿尔坦请回来 请她给你们
快速做个演示 
<br/> 最后一个演示了 我保证 
好的 
很棒 
我刚刚学到了很多关于我们添加的这个新的、
很酷的新API的知识 我决定把我的定制表格视图
单元中的定制推向新高度 
添加一个定制V形图案 实际上 它是一个披萨片 
这个披萨片将会引导我们的用户到
下个画面 
既然我们现在都已经熟悉了从右到左 
那么我们就直接在阿拉伯语中运行我们的app 
就不再向你们展示它在英语中是什么样了 
因为我们已经过了那个阶段 
太好了 因为我用了自动布局和前后限制 
把披萨片放到了那个图片视图 
它的位置就是正确的了 
它位于单元左侧上方 和从右到左的用户
期待的一模一样 
然后 很明显你可以看到 披萨片指的方向是错误的 
保罗之前谈到的 正是这种
定向图片 
我们就可以使用图片翻转API
来进行纠正 
让我们回到那个图表视图单元子类 
这里你可以看到 我的所有的[不知所云]方法 
这些所有的出口 我的所有出口都会加载
并且准备就绪 那么我要做的第一件事 
给我的定制V形图案图片获取一个基准 
customChevronImageView.image 
既然我已经有了 我要把它放回到
图片视图 但是做了一个小的变更 
我要在UI图片上 为从右到左的布局
方向方法调用
图片翻转 
这会让你的图片在从左到右的本地化中
不受影响 
但是在从右到左的本地化中会水平翻转 
在这里 重点要记住的是 
因为这种方法已经替你弄好了 
你就不需要担心对它进行集成了 它是从左到右 
还是从右到左？校验下 就像我之前那样 
在任何本地化中 你都可以信心十足地
调用这种方法 然后你可以确信 
它是不会出错的 
就这样 需要我们做的就这些 
做完了这个变更 我们再来运行一次app 
完美的比萨饼 
我们的V形图案翻转过来了
谢谢 
我们的V形图案翻转过来了 我们的app看上去也很棒 
我们有了翻译 定制手势看上去也很漂亮 
我们就准备就绪了 
把你的app本地化为从右到左就是这么简单 
萨拉该你了 给大家讲完这次会议 
谢谢你萨拉 演示很棒 
我们很快会把萨拉今天给我们做的演示
更新到网上 
如果你漏掉了会议的某些内容 你可以
下载这个简单的代码 然后看看它 
会议结束之前 我来总结一下 
当你为从右到左的语言设计你的app时 
这些语言的母语用户期待UI也是从右到左 
有了我们添加到iOS 9上的新原生UIKit支持 
这就是一个绝佳的机遇 
对你来说 就是添加这个本地化的好机会 
不费吹灰之力 我们还添加了新API 
对于不说母语的开发者以及说母语的开发者来说 
都会非常简单 
你也可以借此接触到数以百万计的
新用户、新市场 
要获取更多信息 请访问我们的资料网站 
网址是developer.Apple.com 我们有国际化资料 
还有本地化资料 
如果你有问题 你可以把它们贴到开发者论坛 
我们也建议你们参加那些相关的会议 
我强烈推荐明天上午9 00的“国际化中有什么新料” 
再次谢谢你们 
谢谢你们来参会 祝你们下午过得愉快！
谢谢！